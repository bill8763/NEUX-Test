!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jwt-decode"),require("@angular/router"),require("@angular/common"),require("@angular/forms"),require("@angular/common/http"),require("rxjs/operators"),require("uuid"),require("date-fns"),require("stacktrace-js"),require("@angular/core"),require("lodash"),require("rxjs")):"function"==typeof define&&define.amd?define("@allianzSND/core",["exports","jwt-decode","@angular/router","@angular/common","@angular/forms","@angular/common/http","rxjs/operators","uuid","date-fns","stacktrace-js","@angular/core","lodash","rxjs"],t):t((e.allianzSND=e.allianzSND||{},e.allianzSND.core={}),e._jwt_decode,e.ng.router,e.ng.common,e.ng.forms,e.ng.common.http,e.rxjs.operators,e.uuid,e.dateFns,e.stacktrace,e.ng.core,e._,e.rxjs)}(this,function(e,t,r,n,o,i,a,Q,K,s,u,T,L){"use strict";var c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function l(e,t){function n(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function I(t,a,s,c){return new(s||(s=Promise))(function(e,n){function o(e){try{i(c.next(e))}catch(t){n(t)}}function r(e){try{i(c["throw"](e))}catch(t){n(t)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(o,r)}i((c=c.apply(t,a||[])).next())})}function z(o,r){var i,a,s,e,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function n(e){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(s=2&e[0]?a["return"]:e[0]?a["throw"]||((s=a["return"])&&s.call(a),0):a.next)&&!(s=s.call(a,e[1])).done)return s;switch(a=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,a=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){c.label=e[1];break}if(6===e[0]&&c.label<s[1]){c.label=s[1],s=e;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(e);break}s[2]&&c.ops.pop(),c.trys.pop();continue}e=r.call(o,c)}catch(t){e=[6,t],a=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}function $(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function g(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i["return"])&&n.call(i)}finally{if(r)throw r.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}var h=function(){function e(e,t,n){this._languageID=e,this._name=t,this._isDefault=n}return Object.defineProperty(e.prototype,"getLanguageID",{get:function(){return this._languageID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getName",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getIsDefault",{get:function(){return this._isDefault},enumerable:!0,configurable:!0}),e}(),D=function(o){function e(e,t){var n=o.call(this,t)||this;return n.name="",n.message="",n.code="",n.message="CODE "+e+" - "+t,n.name="APPError",n.code=e,n}return l(e,o),e}(Error),p=function(){function e(e){this.errorHandler=e,this.apiMap=new Map}return e.prototype.registerAPI=function(e){this.apiMap.set(e.getAPIName(),e)},e.prototype.unRegisterAPI=function(e){this.apiMap["delete"](e.getAPIName())},e.prototype.getAPI=function(e){var t=this.apiMap.get(e);if(t){console.group("get API:"),console.log("target:",t);var n=Object.create(Object.getPrototypeOf(t));return n.constructor.apply(n),n=Object.assign(n,t),console.log("new instance:",n),console.groupEnd(),n}return console.log("API "+e+" not found!"),this.errorHandler.handleError(new D("F00013","Cannot find API "+e+".")),null},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.ErrorHandler}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.ErrorHandler))},token:e,providedIn:"root"}),e}(),f={MOCK:0,SQLite:1,Restful:2,ONOFFSwitch:3,Device:4};f[f.MOCK]="MOCK",f[f.SQLite]="SQLite",f[f.Restful]="Restful",f[f.ONOFFSwitch]="ONOFFSwitch",f[f.Device]="Device";var d=function(){function e(e,t){this.httpService=e,this.errorHandler=t}return e.prototype.access=function(e){var t=this;return this.httpService.get(e.getMockPath()).pipe(a.catchError(function(e){return t.errorHandler.handleError(new D("F00016",e.message)),L.throwError(e)}))},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:i.HttpClient},{type:u.ErrorHandler}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(i.HttpClient),u.inject(u.ErrorHandler))},token:e,providedIn:"root"}),e}(),_=new u.InjectionToken("APP_CONFIG"),y=new u.InjectionToken(""),S=new u.InjectionToken("configTask"),v=new u.InjectionToken("registerAPITask"),P=new u.InjectionToken("dataSyncTask"),A=new u.InjectionToken("customTaskToken"),C=new u.InjectionToken("fetchLanguageFinish"),b=new u.InjectionToken("fetchSettingFInish"),E=new u.InjectionToken("fetchConfigFinish"),N=new u.InjectionToken("registerDataSyncFunc"),O=new u.InjectionToken("checkTimeout"),F=new u.InjectionToken("timeoutAction"),w=new u.InjectionToken("checkPermission"),M=new u.InjectionToken("authAction"),R=new u.InjectionToken("authRoute"),j=new u.InjectionToken("AfterLogin"),k=new u.InjectionToken("LoadingApp"),V=new u.InjectionToken("LoginMgr"),H=new u.InjectionToken("PushIDMgrToken"),G=new u.InjectionToken("CheckForRoot"),x=new u.InjectionToken("RestHeader"),W=new u.InjectionToken("LanguageAccess"),B=new u.InjectionToken("LanguageUpdate"),U=new u.InjectionToken("NetworkChange"),Y=new u.InjectionToken("FontSizeAccess"),q=new u.InjectionToken("changeFontSize"),X=new u.InjectionToken("showRule"),J=new u.InjectionToken("initialFinish"),Z=new u.InjectionToken("NotificationProvider"),ee=new u.InjectionToken("GoalSettingNotStartMessageAction"),te=new u.InjectionToken("GoalSettingNotStartMessageAction"),ne=new u.InjectionToken("NeedGoalSettingMessage"),oe=new u.InjectionToken("GoalPromoSettingMessageAction"),re=new u.InjectionToken("GoalAutoApproveMessageAction"),ie=new u.InjectionToken("GoalAutoApproveLeaderMessageAction"),ae=new u.InjectionToken("ApproveGoalIsRejectMessageAction"),se=new u.InjectionToken("ApproveGoalIsApproveMessageAction"),ce=new u.InjectionToken("PendingReviewMessageAction"),ue=new u.InjectionToken("SupervisorHaveChangeAgentMessageAction"),le=new u.InjectionToken("SupervisorHaveChangeOldMessageAction"),he=new u.InjectionToken("SupervisorHaveChangeNewMessageAction"),pe=new u.InjectionToken("GoalAutoRejectMessageAction"),fe=new u.InjectionToken("GoalAutoRejectLeaderMessageAction"),ge=new u.InjectionToken("ActivityArriveTenPointMessageAction"),de=new u.InjectionToken("ActivityArriveTwentyPointMessageAction"),_e=new u.InjectionToken("ActivityNotArriveTwentyPointMessageAction"),ye=new u.InjectionToken("ReminderEventsMessageAction"),Te=new u.InjectionToken("DataPrivacyProtectionMessageAction"),me=new u.InjectionToken("OvertimeMessageAction"),De=new u.InjectionToken("AutoDeleteMessageAction"),Ie=new u.InjectionToken("OfflineMessageAction"),Se=new u.InjectionToken("VersionCheckMessageAction"),ve=new u.InjectionToken("TimoutMessageAction"),Pe=new u.InjectionToken("DataCollectionMessageAction"),Ae=new u.InjectionToken("ContactPermissionAction"),Ce=new u.InjectionToken("ExtensionFactory"),be=new u.InjectionToken("ExtensionFactory"),Ee=new u.InjectionToken("ExtensionFactory"),Le=new u.InjectionToken("IActionDirectiveTask"),Ne=function(){function e(){this.tokenMap=new Map}return e.prototype.registerToken=function(e,t){this.tokenMap.set(e,t)},e.prototype.getToken=function(e){return this.tokenMap.get(e)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),Oe=function(){function e(){}return e.isNotEmpty=function(e){return""!==e&&null!==e&&e!==undefined&&"null"!==e&&"NULL"!==e},e.trim=function(e){return this.isEmpty(e)?"":e.trim()},e.isEmpty=function(e){return!this.isNotEmpty(e)},e.convertEmptyVal=function(e){return this.isNotEmpty(e)?e:""},e.byteLength=function(e){var t=0;if(e&&e.length)for(var n=0;n<e.length;n++)0!=(65280&e.charCodeAt(n))&&t++,t++;return t},e.isHasEnglish=function(e){return!!e&&null!==e.match(this.matchEnglishRegExp)},e.isAllEnglish=function(e){var t=e&&e.match(this.matchEnglishRegExp);return!!t&&t[0].length===e.length},e.isHasChinese=function(e){return!!e&&null!==e.match(this.matchChineseRegExp)},e.isAllChinese=function(e){var t=e&&e.match(this.matchChineseRegExp);return!!t&&t[0].length===e.length},e.getEnglishCharCount=function(e){var t=e&&e.match(this.matchEnglishRegExp);return t?t[0].length:0},e.getChineseCharCount=function(e){var t=e&&e.match(this.matchChineseRegExp);return t?t[0].length:0},e.getNumberCharCount=function(e){var t=e&&e.match(this.matchNumberRegExp);return t?t[0].length:0},e.isHasThai=function(e){e||(e="");var t=0;return e.split("").forEach(function(e){3584<e.charCodeAt(0)&&e.charCodeAt(0)<3711&&t++}),0<t},e.matchEnglishRegExp="[a-zA-Z]+",e.matchChineseRegExp="[\\u4e00-\\u9fa5]+|['ㄧ']+",e.matchNumberRegExp="[0-9]+",e}(),Fe=function(){function e(e){this.datePipe=e}return e.prototype.toDateString=function(e,t){if(e!=undefined)return this.datePipe.transform(e,t)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.DatePipe}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(n.DatePipe))},token:e,providedIn:"root"}),e}(),we=function(){function e(){this._pageSize=10,this._page=1}return e.prototype.resetPage=function(){this._page=1},Object.defineProperty(e.prototype,"pageSize",{get:function(){return this._pageSize},set:function(e){this._pageSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalRec",{get:function(){return this._totalRec},set:function(e){this._totalRec=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalPage",{get:function(){return this._totalPage},set:function(e){this._totalPage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this._page},enumerable:!0,configurable:!0}),e.prototype.nextPage=function(){this._page++},e}(),Me=function(){function e(){this.errorMap=new Map}return e.prototype.setErrorMap=function(e,t){this.errorMap.set(e,t)},e.prototype.deleteError=function(e){this.errorMap["delete"](e)},e.prototype.isTrue=function(){return 0==this.errorMap.size},e.prototype.isError=function(e){return this.errorMap.get(e)!=undefined},e.prototype.getErrorMsg=function(e){return this.errorMap.get(e)},e.prototype.clearErrorMap=function(){this.errorMap.clear()},e}(),Re=function(){function e(){}return e.isNumber=function(e){return!!Oe.isNotEmpty(e)&&!isNaN(Number(e))},e.isDecimal=function(e){var t=!1;return this.isNumber(e)&&-1!=e.toString().indexOf(".")&&(t=!0),t},e.isPositive=function(e){var t=!1;return console.log("this.isNumber(val)",this.isNumber(e)),this.isNumber(e)&&(0<Number(e)||0==Number(e))&&(console.log("val",e),t=!0),t},e.isPositiveInt=function(e){var t=!1;return this.isDecimal(e)||0<=Number(e)&&(t=!0),t},e.numberToFix=function(e,t){var n=Math.pow(10,t);return Math.round(this.strip(e)*n)/n},e.strip=function(e,t){return void 0===t&&(t=12),Number(e.toPrecision(t))},e}(),je=function(){function e(){}return e.fillTableColumn=function(e,t){var n,o,r=e.getColumns().map(function(e){return e.getName()}).filter(function(e){return"ClientID"!==e});if(t!=undefined&&0<r.length)try{for(var i=$(r),a=i.next();!a.done;a=i.next()){var s=a.value;t[s]!=undefined&&e.setValue(s,t[s])}}catch(c){n={error:c}}finally{try{a&&!a.done&&(o=i["return"])&&o.call(i)}finally{if(n)throw n.error}}return e},e}(),ke=function(){function e(e,t,n,o,r){this._type=e,this._city=t,this._area=n,this._code=o,this._address=r}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"city",{get:function(){return this._city},set:function(e){this._city=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this._area},set:function(e){this._area=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"code",{get:function(){return this._code},set:function(e){this._code=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"address",{get:function(){return this._address},set:function(e){this._address=e},enumerable:!0,configurable:!0}),e}(),Ve=function(){function e(e,t){this._type=e,this._number=t}return Object.defineProperty(e.prototype,"number",{get:function(){return this._number},set:function(e){this._number=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),e}(),He=function(){function e(e,t,n,o,r,i){this._isCheck=!1,this._isShow=!1,this._firstname=e,this._lastname=t,this._birthday=n,this._phones=o,this._emails=r,this._address=i,this._isShow=!0}return Object.defineProperty(e.prototype,"Birthday",{get:function(){return this._birthday},set:function(e){this._birthday=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCheck",{get:function(){return this._isCheck},set:function(e){this._isCheck=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShow",{get:function(){return this._isShow},set:function(e){this._isShow=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FirstName",{get:function(){return this._firstname},set:function(e){this._firstname=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LastName",{get:function(){return this._lastname},set:function(e){this._lastname=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tel",{get:function(){return this._phones},set:function(e){this._phones=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this._emails},set:function(e){this._emails=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"address",{get:function(){return this._address},set:function(e){this._address=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullname",{get:function(){return this.FirstName+" "+this.LastName},enumerable:!0,configurable:!0}),e}(),Ge=function(){function e(){}return e.prototype.searchcontactsByName=function(e){var d=this,t=navigator,n=[t.contacts.fieldType.displayName,t.contacts.fieldType.name],o=new ContactFindOptions;return o.filter=e,o.multiple=!0,o.desiredFields=[t.contacts.fieldType.name,t.contacts.fieldType.emails,t.contacts.fieldType.addresses,t.contacts.fieldType.phoneNumbers],L.Observable.create(function(g){t.contacts.find(n,function(e){var t,n;console.log("find contacts results:",e);var o={Body:[]};try{for(var r=$(e),i=r.next();!i.done;i=r.next()){var a=i.value,s=a.name.givenName||"",c=a.name.familyName||"",u=a.name.birthday||null,l=null==a.emails?[]:a.emails.map(function(e){return e.value}),h=null==a.phoneNumbers?[]:a.phoneNumbers.map(function(e){return new Ve(e.type,e.value.trim())}),p=null==a.addresses?[]:a.addresses.map(d.convertAddress);o.Body.push(new He(s,c,u,h,l,p))}}catch(f){t={error:f}}finally{try{i&&!i.done&&(n=r["return"])&&n.call(r)}finally{if(t)throw t.error}}g.next(o),g.complete()},function(e){console.log("contacts error:",e,o),g.error(e),g.complete()},o)})},e.prototype.convertAddress=function(e){var t=e.type||null,n=e.streetAddress||null,o=e.locality||null,r=e.reigon||null,i=e.postalCode||null;return new ke(t,r,o,i,n)},e.prototype.registerNotfiy=function(){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return this.checkNotifyPermission(),[4,this.getFirbaseToken()];case 1:t=e.sent(),e.label=2;case 2:return null!==t?[3,5]:[4,this.waitnseconds(2e3)];case 3:return e.sent(),[4,this.getFirbaseToken()];case 4:return t=e.sent(),[3,2];case 5:return[2,t]}})})},e.prototype.onNotifyTokenRefresh=function(t){return window.FirebasePlugin.onTokenRefresh(function(e){t(e)},function(e){console.warn("token refresh error:",e.message)})},e.prototype.onNotificationOpen=function(t){window.FirebasePlugin.onMessageReceived(function(e){t(e)},function(e){console.warn("notification open error:",e.message)})},e.prototype.subscribeSubject=function(e){window.FirebasePlugin.subscribe(e)},e.prototype.unsubscribeSubject=function(e){window.FirebasePlugin.unsubscribe(e)},e.prototype.checkNotifyPermission=function(){window.FirebasePlugin.hasPermission(function(e){e.isEnabled||window.FirebasePlugin.grantPermission()})},e.prototype.getFirbaseToken=function(){return new Promise(function(t,n){window.FirebasePlugin.getToken(function(e){console.log("firebase gettoken:",e),t(e)},function(e){console.warn("get token error:",e.message),n(e)})})},e.prototype.waitnseconds=function(n){return new Promise(function(e,t){setTimeout(function(){e()},n)})},e}(),xe=function(){function e(){this.daoMap=new Map,this.daoMap.set("cordova",new Ge)}return e.prototype.getDefaultDao=function(){return this.getDao("cordova")},e.prototype.getDao=function(e){return this.daoMap.get(e)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),We=function(){function e(e,t,n){var o=this;this.injector=e,this.deviceFactory=t,this.APP_CONFIG=n,this.SSL_fingerprints=[],this.deviceID=null,this.mock_deviceID=Q.v4();var r=this.APP_CONFIG.ENV;this.SSL_fingerprints=this.APP_CONFIG[r].SSL_FINGERPRINTS,"DEV_WebSQL"===r&&this.initDeviceID().then(function(e){o.deviceID=e})}return e.prototype.initDeviceAPI=function(){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return window.open=cordova.InAppBrowser.open,this._isPad=this.judgePad(),this.lockScreenOrient(),this.disableBackBtn(),[4,(t=this).initDeviceID()];case 1:return t.deviceID=e.sent(),[2]}})})},e.prototype.getDevicePlatform=function(){var e=null;try{e=device.platform}catch(t){console.log("cannot get platform, beacause maynot on device."),e="PC"}finally{return e}},e.prototype.getDeviceUUID=function(){if(this.deviceID)return this.deviceID},e.prototype._getDeviceUUID=function(){var e=null;try{e=device.uuid}catch(t){console.log("cannot get UUID, beacause maynot on device."),e=this.mock_deviceID}finally{return e}},e.prototype.initDeviceID=function(){return I(this,void 0,void 0,function(){var t,n;return z(this,function(e){switch(e.label){case 0:t=this._getDeviceUUID(),e.label=1;case 1:return e.trys.push([1,8,,9]),[4,this.getSecureStorage("deviceID").toPromise()];case 2:if(n=e.sent(),console.log("getDeviceID from KeyStore resp:",n),!n.includes("Device is not secure"))return[3,3];throw new Error(n);case 3:return n?[2,n]:[3,4];case 4:return[4,this.setSecureStorage("deviceID",t).toPromise()];case 5:return e.sent()?[4,this.getSecureStorage("deviceID").toPromise()]:[3,7];case 6:return[2,e.sent()];case 7:return[3,9];case 8:return e.sent(),console.log("getDeviceID error, use localStorage"),this.getLocalStorage("deviceID")?[2,this.getLocalStorage("deviceID")]:(this.setLocalStorage("deviceID",t),[2,t]);case 9:return[2]}})})},e.prototype.getDeviceManufacturer=function(){var e=null;try{e=device.manufacturer+" "+device.model}catch(t){console.log("cannot get Manufacturer, beacause maynot on device."),e="PC Browser"}finally{return e}},e.prototype.restartApp=function(){try{window.location.reload(!0),window.location.assign("index.html")}catch(e){console.log("restart error")}},e.prototype.getNetworkState=function(){if(navigator&&navigator.connection){var e=navigator.connection.type;return console.log("networkState:",e),"none"!=e}return!0},e.prototype.searchContactsByName=function(e){return I(this,void 0,void 0,function(){var n,o,r,i,a,s,c,u,l;return z(this,function(e){switch(e.label){case 0:r=this.deviceFactory.getDefaultDao(),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.searchcontactsByName("").toPromise()];case 2:i=e.sent(),console.log("search Contact result:",i),a=i.Body;try{for(s=$(a),c=s.next();!c.done;c=s.next())u=c.value,Oe.isEmpty(u.l)&&(u.isCheck=!1)}catch(t){n={error:t}}finally{try{c&&!c.done&&(o=s["return"])&&o.call(s)}finally{if(n)throw n.error}}return[2,a];case 3:return l=e.sent(),console.log("error:",l),[2,l];case 4:return[2]}})})},e.prototype.dialNumber=function(e){window.open("tel:"+e.replace(/\s/g,""),"_system")},e.prototype.checkIfRoot=function(){return new Promise(function(t,n){try{if(console.log("iroot:",IRoot),IRoot===undefined)throw new Error("iRoot plugin error.");IRoot.isRooted(function(e){t(e)},function(e){n(e)})}catch(e){t(!1)}})},e.prototype.exitApp=function(){cordova.plugins.exit()},e.prototype.getAppVersion=function(){try{return cordova.getAppVersion.getVersionNumber()}catch(e){return Promise.resolve("1.0.3")}},e.prototype.getIsFirstLaunch=function(){return"N"!==this.getLocalStorage("AppFirstLaunch")},e.prototype.setLocalStorage=function(e,t){window.localStorage.setItem(e,t)},e.prototype.getLocalStorage=function(e){return window.localStorage.getItem(e)},e.prototype.lockScreenOrient=function(){var e=this.isPad()?"landscape":"portrait-primary";window.screen.orientation.lock(e)},e.prototype.judgePad=function(){var e=window.innerWidth,t=window.innerHeight;return console.log("width:",e),console.log("height:",t),!(e<700||t<700)},e.prototype.isPad=function(){return this._isPad},e.prototype.setSecureStorage=function(n,o){return L.Observable.create(function(t){var e=new cordova.plugins.SecureStorage(function(){e.set(function(){t.next(!0),t.complete()},function(e){t.next(!1),t.complete()},n,o)},function(e){t.next(!1),t.complete()},"Allianz_SND")})},e.prototype.getSecureStorage=function(n){return L.Observable.create(function(t){var e=new cordova.plugins.SecureStorage(function(){e.get(function(e){t.next(e),t.complete()},function(){t.next(null),t.complete()},n)},function(e){t.next(e.message),t.complete()},"Allianz_SND")})},e.prototype.checkSSL=function(e){var o=this;return 0==this.SSL_fingerprints.length?Promise.resolve(!0):new Promise(function(t,n){window.plugins.sslCertificateChecker.check(function(e){"CONNECTION_SECURE"===e&&t(!0)},function(e){n(e)},e,o.SSL_fingerprints)})},e.prototype.takeScreenShot=function(){var n=this;navigator.screenshot.save(function(e,t){e?console.warn(e):(console.log("testScreenShot success",t.filePath),console.warn("getDevicePlatform",n.getDevicePlatform()),"iOS"==n.getDevicePlatform()&&cordova.plugins.imagesaver.saveImageToGallery(t.filePath,function(){console.log("success")},function(e){console.log(e)}))})},e.prototype.disableBackBtn=function(){document.addEventListener("backbutton",function(e){e.preventDefault()},!1)},e.prototype.checkContactPermission=function(){return new Promise(function(t,n){cordova.plugins.CheckPermission.checkContactPermission("contact",function(e){t(e)},function(e){n(e)})})},e.prototype.grantContactPermission=function(){cordova.plugins.CheckPermission.grantContactPermission()},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.Injector},{type:xe},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[_]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.INJECTOR),u.inject(xe),u.inject(_,8))},token:e,providedIn:"root"}),e}(),Be=function(){function e(){this.token="",this.tokenSubject=new L.BehaviorSubject(this.token)}return e.prototype.setToken=function(e){this.token=e,this.tokenSubject.next(this.token)},e.prototype.getToken=function(){return this.tokenSubject.asObservable()},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),Ue=function(){function e(e,t,n){var o=this;this.deviceService=e,this.tokenStore=t,this.customLoginMgr=n,this.token="",this.version="",this.customLoginMgr?this.customLoginMgr.getToken().subscribe(function(e){o.token=e}):this.tokenStore.getToken().subscribe(function(e){o.token=e}),this.deviceService.getAppVersion().then(function(e){o.version=e})}return e.prototype.getHeader=function(){return new i.HttpHeaders({"Content-Type":"application/json",Authorization:"Bearer "+this.token,"X-Date":(new Date).toUTCString(),"X-Request-ID":Date.now().toString(),"X-Organization":"1","X-Organization-Branch":"1","X-Organization-User":"1","X-API-Version":this.version})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:We},{type:Be},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[V]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(We),u.inject(Be),u.inject(V,8))},token:e,providedIn:"root"}),e}(),Ye={GoalSettingNotStartFirst:"GoalSettingNotStartFirst",GoalSettingNotStart:"GoalSettingNotStart",NeedGoalSetting:"NeedGoalSetting",GoalPromoSetting:"GoalPromoSetting",GoalAutoApprove:"GoalAutoApprove",GoalAutoApproveLeader:"GoalAutoApproveLeader",ApproveGoalIsReject:"ApproveGoalIsReject",ApproveGoalIsApprove:"ApproveGoalIsApprove",PendingReview:"PendingReview",SupervisorHaveChangeAgent:"SupervisorHaveChangeAgent",SupervisorHaveChangeOld:"SupervisorHaveChangeOld",SupervisorHaveChangeNew:"SupervisorHaveChangeNew",GoalAutoReject:"GoalAutoReject",GoalAutoRejectLeader:"GoalAutoRejectLeader",ActivityArriveTenPoint:"ActivityArriveTenPoint",ActivityArriveTwentyPoint:"ActivityArriveTwentyPoint",ActivityLessThanTwentyPoint:"ActivityLessThanTwentyPoint",ReminderEvent:"ReminderEvent",DataPrivacyProtection:"DataPrivacyProtection",Overtime:"Overtime",AutoDelete:"AutoDelete",Offline:"Offline",OnlineCheck:"OnlineCheck",NewVersion:"NewVersion",Timeout:"Timeout",DataCollection:"DataCollection",NewVersionLogin:"NewVersionLogin",HTTPError:"HTTPError",ContactPermissionError:"ContactPermissionError",ScreenShotAlert:"ScreenShotAlert",SubmitFail:"SubmitFail"},qe={GoalSetting:"GoalSetting",Progress:"Progress",Calendar:"Calendar",Customer:"Customer",System:"System"},Xe=function(){function e(){this.category="",this.type="",this.id=Q.v4(),this.data={},this.order=-1,this.action=null}return Object.defineProperty(e.prototype,"category",{get:function(){return this._category},set:function(e){this._category=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this._action},set:function(e){this._action=e},enumerable:!0,configurable:!0}),e}(),Je=function(){function e(e,t){this.injector=e,this.customNotificationProvider=t,this.actionMap=[{type:Ye.GoalSettingNotStartFirst,category:qe.GoalSetting,order:1,action:ee},{type:Ye.GoalSettingNotStart,category:qe.GoalSetting,order:1,action:te},{type:Ye.NeedGoalSetting,category:qe.GoalSetting,order:2,action:ne},{type:Ye.GoalPromoSetting,category:qe.GoalSetting,order:3,action:oe},{type:Ye.GoalAutoApprove,category:qe.GoalSetting,order:4,action:re},{type:Ye.GoalAutoApproveLeader,category:qe.GoalSetting,order:5,action:ie},{type:Ye.ApproveGoalIsReject,category:qe.GoalSetting,order:6,action:ae},{type:Ye.ApproveGoalIsApprove,category:qe.GoalSetting,order:7,action:se},{type:Ye.PendingReview,category:qe.GoalSetting,order:8,action:ce},{type:Ye.SupervisorHaveChangeAgent,category:qe.GoalSetting,order:9,action:ue},{type:Ye.SupervisorHaveChangeOld,category:qe.GoalSetting,order:10,action:le},{type:Ye.SupervisorHaveChangeNew,category:qe.GoalSetting,order:11,action:he},{type:Ye.GoalAutoReject,category:qe.GoalSetting,order:12,action:pe},{type:Ye.GoalAutoRejectLeader,category:qe.GoalSetting,order:13,action:fe},{type:Ye.ActivityArriveTenPoint,category:qe.Progress,order:14,action:ge},{type:Ye.ActivityArriveTwentyPoint,category:qe.Progress,order:15,action:de},{type:Ye.ActivityLessThanTwentyPoint,category:qe.Progress,order:16,action:_e},{type:Ye.ReminderEvent,category:qe.Calendar,order:17,action:ye},{type:Ye.DataPrivacyProtection,category:qe.Customer,order:18,action:Te},{type:Ye.Overtime,category:qe.Customer,order:19,action:me},{type:Ye.AutoDelete,category:qe.Customer,order:20,action:De},{type:Ye.Offline,category:qe.System,order:21,action:Ie},{type:Ye.OnlineCheck,category:qe.System,order:22,action:null},{type:Ye.NewVersion,category:qe.System,order:23,action:Se},{type:Ye.NewVersionLogin,category:qe.System,order:24,action:Se},{type:Ye.Timeout,category:qe.System,order:25,action:ve},{type:Ye.DataCollection,category:qe.System,order:26,action:Pe},{type:Ye.HTTPError,category:qe.System,order:27,action:null},{type:Ye.ContactPermissionError,category:qe.System,order:28,action:Ae},{type:Ye.ScreenShotAlert,category:qe.System,order:29,action:null},{type:Ye.SubmitFail,category:qe.System,order:30,action:null}]}return e.prototype.getNotificationObject=function(t,e,n){if(void 0===n&&(n=null),this.customNotificationProvider)return this.customNotificationProvider.getNotificationObject(t,e);var o=new Xe;n&&(o.id=n),o.data=e;var r=this.actionMap.filter(function(e){return e.type===t});return 0<r.length&&(o.order=r[0].order,o.category=r[0].category,o.type=r[0].type,o.action=this.getAction(r[0].action)),o},e.prototype.getAction=function(e){var t;if(e)try{t=this.injector.get(e)}catch(n){t=null}else t=null;return t},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.Injector},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[Z]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.INJECTOR),u.inject(Z,8))},token:e,providedIn:"root"}),e}(),Qe=function(){function e(e,t,n){this.injector=e,this.errorHandler=t,this.notificationProvider=n,this.DBMessage=[],this.notificationList=[],this.notificationSubject=new L.BehaviorSubject(this.notificationList)}return e.prototype.init=function(){return I(this,void 0,void 0,function(){return z(this,function(e){switch(e.label){case 0:return console.log("NotificationMgr init"),[4,this.fetchMessageData()];case 1:return e.sent(),[2]}})})},e.prototype.getNotificationList=function(){return console.log("NotificationMgr getNotificationList"),this.notificationSubject.asObservable()},e.prototype.pushNotification=function(e,t){var n=this.notificationProvider.getNotificationObject(e,t);if(console.log("NotificationMgr pushNotification:",n),n.action){var o=this.notificationList.filter(function(e){return e.category===n.category&&e.type===n.type}),r=n.action.onConflict(o,n);this.notificationList=m(r,this.notificationList.filter(function(e){return e.category!==n.category||e.type!==n.type}))}else this.notificationList.push(n);this.notificationList=this.notificationList.sort(function(e,t){return e.order-t.order}),this.notificationSubject.next(this.notificationList)},e.prototype.popNotification=function(t){console.log("NotificationMgr popNotification:",t);try{var e=0<this.notificationList.filter(function(e){return e.id===t.id}).length;console.log("popNotification:",e),e&&(this.notificationList=this.notificationList.filter(function(e){return e.id!==t.id}),this.notificationSubject.next(this.notificationList),console.log("after popped:",this.notificationList))}catch(n){this.errorHandler.handleError(new D("F00021",n.message))}},e.prototype.getUnreadMessageNumber=function(){return this.DBMessage.length},e.prototype.popAllNotification=function(){this.notificationList=[],this.notificationSubject.next(this.notificationList)},e.prototype.showCategoryMessage=function(t,n){void 0===t&&(t=null),void 0===n&&(n=null),console.log("NotificationMgr ShowCategoryMessage:",t,n);var e=this.DBMessage.filter(function(e){return!(e.category!==t&&t||e.type!==n&&n)}),o=e.map(function(e){return e.id});if(0<e.length){this.notificationList=m(this.notificationList,e),this.notificationSubject.next(this.notificationList),this.DBMessage=this.DBMessage.filter(function(e){return o.indexOf(e.id)<0});var r=this.getAPIFactory(),i=this.getAPIDispatch(),a=r.getAPI("updateDashboardMessageStatus");a.setClientIDList(o),a.setStatus("Reading"),i.dispatch(a).subscribe(function(e){console.log("NotificationMgr popNotification updateMessageStatusAPI resp:",e)})}},e.prototype.fetchMessageData=function(){return I(this,void 0,void 0,function(){var t,n,o,r,i,a,s,c=this;return z(this,function(e){switch(e.label){case 0:console.log("NotificationMgr fetchMessageData"),t=[],e.label=1;case 1:return e.trys.push([1,3,,4]),n=this.getAPIFactory(),o=this.getAPIDispatch(),(r=n.getAPI("getDashboardMessageList")).setKeyword("UnRead"),r.setIsPopup(!0),[4,o.dispatch(r).toPromise()];case 2:return i=e.sent(),a=i.Body,t=a.map(function(e){return c.notificationProvider.getNotificationObject(e.MessageType,Object.assign({Source:"DB",Title:e.Title,Description:e.Description},JSON.parse(e.Arguments)),e.ClientID)}),[3,4];case 3:return s=e.sent(),this.errorHandler.handleError(new D("F00020",s.message)),[3,4];case 4:return this.DBMessage=t,console.log("NotificationMgr fetchMessageData end",this.DBMessage),[2]}})})},e.prototype.getAPIFactory=function(){try{return this.injector.get(p)}catch(e){return null}},e.prototype.getAPIDispatch=function(){try{return this.injector.get(nt)}catch(e){return null}},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.Injector},{type:u.ErrorHandler},{type:Je}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.INJECTOR),u.inject(u.ErrorHandler),u.inject(Je))},token:e,providedIn:"root"}),e}(),Ke=function(){function e(e,t,n,o,r,i,a){this.httpService=e,this.APP_CONFIG=t,this.deviceService=n,this.errorHandler=o,this.defaultHeader=r,this.notificationMgr=i,this.customHeader=a}return e.prototype.access=function(e){var n=this,o=e.getRequestData();console.log("restful API requestData:",o);var r={headers:this.getHeader()};return this.isCustomHeaderAPI(e)&&(r.headers=e.getHeader()),""==o.url&&(o.url=this.APP_CONFIG[this.APP_CONFIG.ENV].API_URL[e.getAPIName()]),L.Observable.create(function(t){n.deviceService.checkSSL(o.url).then(function(){null!=o.params&&(r.params=o.params),"GET"==o.type?n.httpService.get(o.url,r).pipe(a.timeout(o.timeout)).subscribe(function(e){t.next(e),t.complete()},function(e){n.handleHTTPError(e),t.error(e.error),t.complete()}):"POST"==o.type?n.httpService.post(o.url,o.body,r).pipe(a.timeout(o.timeout)).subscribe(function(e){t.next(e),t.complete()},function(e){n.handleHTTPError(e),t.error(e.error),t.complete()}):"PUT"==o.type&&n.httpService.put(o.url,o.body,r).pipe(a.timeout(o.timeout)).subscribe(function(e){t.next(e),t.complete()},function(e){n.handleHTTPError(e),t.error(e.error),t.complete()})},function(e){console.log("check SSL fingerprint error:",e.message),n.errorHandler.handleError(new D("C00004",e.message)),t.error(e),t.complete()})})},e.prototype.handleHTTPError=function(e){console.log("handle HTTP error:",e),400==e.status?this.errorHandler.handleError(new D("C00001",e.message)):401==e.status?this.errorHandler.handleError(new D("C00003",e.message)):500==e.status?this.errorHandler.handleError(new D("C00002",e.message)):this.errorHandler.handleError(new D("C00005",e.message));var t=e.message;e.error&&e.error.code&&(t="Error Code:"+e.error.code+"\n Msg:"+e.error.message),this.notificationMgr.pushNotification(Ye.HTTPError,{code:e.status,message:"url:"+e.url+"\n"+t})},e.prototype.getHeader=function(){return this.customHeader?this.customHeader.getHeader():this.defaultHeader.getHeader()},e.prototype.isCustomHeaderAPI=function(e){return"getHeader"in e},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:i.HttpClient},{type:undefined,decorators:[{type:u.Inject,args:[_]}]},{type:We},{type:u.ErrorHandler},{type:Ue},{type:Qe},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[x]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(i.HttpClient),u.inject(_),u.inject(We),u.inject(u.ErrorHandler),u.inject(Ue),u.inject(Qe),u.inject(x,8))},token:e,providedIn:"root"}),e}(),ze=function(){function e(){}return e.prototype.access=function(e){return console.log("sqlite access"),e.executeSQL()},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),$e=function(){function e(){}return e.prototype.access=function(e){return e.runDeviceAPI()},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),Ze=function Qo(e,t){void 0===e&&(e={}),void 0===t&&(t=!0),this.payload=e,this.status=t,this.error=""},et={PERMISSION_DENIED:"Permission Denied",TIMEOUT:"Timeout",NOT_LOGIN:"Not Login",PENDING_ACTION:"Other Action Pending"},tt=function(){function e(e,t,n,o){this.APP_CONFIG=e,this.timeoutCheck=t,this.timeoutAction=n,this.zone=o,this.seconds=0,this.reaminingSubject=new L.BehaviorSubject(this.seconds),this._interval=null,this.reset_seconds=this.APP_CONFIG[this.APP_CONFIG.ENV].TIMEOUT,this.seconds=this.reset_seconds}return e.prototype.reset=function(){this.timeoutCheck?this.timeoutCheck.reset():this.seconds=this.reset_seconds},e.prototype.init=function(){var e=this;this.timeoutCheck?this.timeoutCheck.init():(null!=this._interval&&clearInterval(this._interval),this.zone.runOutsideAngular(function(){e._interval=setInterval(function(){e.seconds--,e.reaminingSubject.next(e.seconds),e.seconds<=0&&e.zone.run(function(){clearInterval(e._interval),e._interval=null,console.log("timeout!!"),e.timeoutAction&&e.timeoutAction.timeoutAction()})},1e3)}))},e.prototype.clear=function(){this.timeoutCheck?this.timeoutCheck.clear():null!=this._interval&&(clearInterval(this._interval),this._interval=null)},e.prototype.authRoute=function(e){return e.status&&(e.status=!this.isTimeout(),e.status||(e.error=et.TIMEOUT)),e},e.prototype.authAction=function(e){return e.status&&(e.status=!this.isTimeout(),e.status||(e.error=et.TIMEOUT)),e},e.prototype.getTimeoutRemainingSecond=function(){return this.reaminingSubject.asObservable()},e.prototype.isTimeout=function(){return this.timeoutCheck?this.timeoutCheck.checkTimeout():this.seconds<=0},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:u.Inject,args:[_]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[O]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[F]}]},{type:u.NgZone}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(_),u.inject(O,8),u.inject(F,8),u.inject(u.NgZone))},token:e,providedIn:"root"}),e}(),nt=function(){function e(e,t,n,o,r,i,a){this.mockAPIAccess=e,this.sqliteAPIAcces=t,this.restfulAPIAccess=n,this.deviceAPIAccess=o,this.timeoutService=r,this.errorHandler=i,this.APP_CONFIG=a}return e.prototype.dispatch=function(e){if(this.timeoutService.reset(),e!=undefined){var t=this.APP_CONFIG.ENV,n=this.APP_CONFIG[t].API_TYPE[e.getAPIName()],o=void 0;if(n==f.MOCK?o=this.mockAPIAccess:n==f.Restful?o=this.restfulAPIAccess:n==f.SQLite?o=this.sqliteAPIAcces:n==f.Device&&(o=this.deviceAPIAccess),o!=undefined)return o.access(e);this.errorHandler.handleError(new D("F00014","API "+e.getAPIName()+" doesn't assign access method."))}return this.errorHandler.handleError(new D("F00015","API object is null.")),L.of(null)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:d},{type:ze},{type:Ke},{type:$e},{type:tt},{type:u.ErrorHandler},{type:undefined,decorators:[{type:u.Inject,args:[_]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(d),u.inject(ze),u.inject(Ke),u.inject($e),u.inject(tt),u.inject(u.ErrorHandler),u.inject(_))},token:e,providedIn:"root"}),e}(),ot=function(){function e(e,t){this._header={},this._body=[],this._header=e,this._body=t}return Object.defineProperty(e.prototype,"Header",{get:function(){return this._header},set:function(e){this._header=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Body",{get:function(){return this._body},set:function(e){this._body=e},enumerable:!0,configurable:!0}),e}(),rt=function(){function e(e,t,n,o,r,i){this.httpService=e,this.dispatcher=t,this.APIFactory=n,this.deviceService=o,this.LanguageAccess=r,this.LanguageUpdate=i,this.language_map={},this.languageMap=new Map,this.current_language="",this.updateLanguageSubject=new L.BehaviorSubject(0)}return e.prototype.init=function(){return I(this,void 0,void 0,function(){return z(this,function(e){switch(e.label){case 0:return[4,this.loadJson()];case 1:return e.sent(),[4,this._fetchCurrentLanguage().toPromise()];case 2:return e.sent(),[2]}})})},e.prototype.loadJson=function(){var n=this;return console.debug("translate.service.loadjson"),new Promise(function(t,e){n.httpService.get("./assets/config/language.json").subscribe(function(e){console.debug("translate.service.loadjson success",e),n.language_map=e,t()})})},e.prototype.translate=function(e){if("MappingID"===this.current_language)return"${"+e+"}";var t=this.language_map[this.current_language][e];return null===t||t===undefined?e:t},e.prototype.translateWithVariable=function(e,t){var n=this.translate(e);return Object.keys(t).forEach(function(e){null!=t[e]&&t[e]!=undefined||(t[e]=""),n=n.replace(new RegExp("\\$\\{"+e+"\\}","g"),t[e].toString())}),n},e.prototype._fetchCurrentLanguage=function(){var n=this;return L.Observable.create(function(t){if(n.LanguageAccess)n.LanguageAccess.getCurrentLanguage().subscribe(function(e){n.current_language=e,t.next(e),t.complete()});else{console.log("Default _fetchCurrentLanguage");var e=n.deviceService.getLocalStorage("SNDLanguage")||"en";n.current_language=e,n.deviceService.setLocalStorage("SNDLanguage",e),t.next(n.current_language),t.complete()}})},e.prototype._fetchCodeData=function(){var a=this,e=this.APIFactory.getAPI("getCurrentLanguageList"),s=[];return console.debug("setting.service fetchCodeData",e),L.Observable.create(function(i){a.dispatcher.dispatch(e).subscribe(function(e){var t=e.Body;console.log("<--- Datas ---\x3e"),console.log(e);for(var n=0;n<t.length;n++){var o=t[n],r=new h(o.LanguageID,o.Name,o.IsDefault);s.push(r),a.languageMap.set("TW_LH_SD_Language",s)}console.debug("languageMap",a.languageMap),i.next(!0),i.complete()})})},e.prototype.getCodeArray=function(){if(0==this.languageMap.size)return new Array;var e=this.languageMap.get("TW_LH_SD_Language");return e==undefined&&(e=new Array),e},e.prototype.updateLanguage=function(e){var n=this;return L.Observable.create(function(t){n.LanguageUpdate?n.LanguageUpdate.UpdateLanguage(e).subscribe(function(e){t.next(e),t.complete()}):(n.deviceService.setLocalStorage("SNDLanguage",e),t.next(new ot({status:!0},[])),t.complete()),n._fetchCurrentLanguage().subscribe(function(e){n.current_language=e,n.updateLanguageSubject.next()})})},e.prototype.getCurrentLanguage=function(){return this.current_language},e.prototype.getUpdateSubject=function(){return this.updateLanguageSubject},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:i.HttpClient},{type:nt},{type:p},{type:We},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[W]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[B]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(i.HttpClient),u.inject(nt),u.inject(p),u.inject(We),u.inject(W,8),u.inject(B,8))},token:e,providedIn:"root"}),e}(),it=function(){function e(e){this.translate=e}return e.prototype.transform=function(e,t){return this.translate.translate(e)},e.decorators=[{type:u.Pipe,args:[{name:"translate",pure:!1}]}],e.ctorParameters=function(){return[{type:rt}]},e}(),at=function(){function e(){}return e.prototype.transform=function(e,t){void 0===t&&(t=-1);var n=Number(e);if(isNaN(n))return e;if(0<=t){var o=",",r="";try{return t=Math.abs(t),t=isNaN(t)?1:t,(n<0?"-":"")+((a=3<(i=parseInt(r=Math.abs(n||0).toFixed(t)).toString()).length?i.length%3:0)?i.substr(0,a)+o:"")+i.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+o)+(t?"."+Math.abs(Number(r)-parseInt(i)).toFixed(t).slice(2):"")}catch(s){console.log(s)}}else{o=",",r="";try{var i,a;return(n<0?"-":"")+((a=3<(i=Math.abs(n||0).toString()).length?i.length%3:0)?i.substr(0,a)+o:"")+i.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+o)}catch(s){console.log(s)}}},e.decorators=[{type:u.Pipe,args:[{name:"numberFormat",pure:!1}]}],e.ctorParameters=function(){return[]},e}(),st=function(){function e(e){console.log("LoginInfo custructor:",e),this._AgentId=e.AgentId||"",this._AgentName=e.AgentName||"",this._Gender=e.Gender||"",this._AppUseMode=[e.AppUseMode],this._exp=e.exp||null,this._GoalSigningSupervisor=e.GoalSigningSupervisor||null,this._CurrentJobSeniorityMonth=e.CurrentJobSeniorityMonth||null,this._JobGrade=e.JobGrade||null,this._CurrentJobOBMonth=e.CurrentJobOBMonth||null,this._OfficeName=e.OfficeName||null,this._ReferenceToken=e.ReferenceToken||null}return Object.defineProperty(e.prototype,"AgentId",{get:function(){return this._AgentId},set:function(e){this._AgentId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AppUseMode",{get:function(){return this._AppUseMode},set:function(e){this._AppUseMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AgentName",{get:function(){return this._AgentName},set:function(e){this._AgentName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Gender",{get:function(){return this._Gender},set:function(e){this._Gender=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exp",{get:function(){return this._exp},set:function(e){this._exp=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GoalSigningSupervisor",{get:function(){return this._GoalSigningSupervisor},set:function(e){this._GoalSigningSupervisor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentJobSeniorityMonth",{get:function(){return this._CurrentJobSeniorityMonth},set:function(e){this._CurrentJobSeniorityMonth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"JobGrade",{get:function(){return this._JobGrade},set:function(e){this._JobGrade=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentJobOBMonth",{get:function(){return this._CurrentJobOBMonth},set:function(e){this._CurrentJobOBMonth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OfficeName",{get:function(){return this._OfficeName},set:function(e){this._OfficeName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ReferenceToken",{get:function(){return this._ReferenceToken},set:function(e){this._ReferenceToken=e},enumerable:!0,configurable:!0}),e}(),ct=function Ko(e){this.isSuccess=e.isSuccess,this.errorMsg=e.errorMsg,this.type=e.type,this.token=e.token,this.failCount=e.failCount||-1},ut={ONLINE:0,OFFLINE:1};ut[ut.ONLINE]="ONLINE",ut[ut.OFFLINE]="OFFLINE";var lt=function(){function e(){}return e.convertJsonToRouterMap=function(n){var o={};return Object.keys(n).forEach(function(t){Object.keys(n[t]).forEach(function(e){n[t][e]=Object.assign(n[t][e],{Function:t}),o[e]=n[t][e]})}),o},e}(),ht=function(){function e(e,t,n,o){this.injector=e,this.APIFactory=t,this.dispatcher=n,this.routeReuseStrategy=o,this.routeMap={},this.currentMenuObject=null,this.previousUrl=null,this.currentUrl=null}return e.prototype.init=function(){var t=this,e=this.APIFactory.getAPI("getRouterMap");e&&this.dispatcher.dispatch(e).subscribe(function(e){console.log("routeMapAPI:",e),t.routeMap=lt.convertJsonToRouterMap(e),console.log("router map:",t.routeMap)}),this.listenRouterEvent()},e.prototype.navigate=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this.injector.get(r.Router);console.log("navigate:",o,e,this.routeMap[e].Path),o&&this.routeMap[e]&&(window.FirebasePlugin&&window.FirebasePlugin.setScreenName(this.routeMap[e].Function),t?o.navigate(m([this.routeMap[e].Path],t)):o.navigate([this.routeMap[e].Path]))},e.prototype.getUrl=function(e){return this.routeMap[e]?this.routeMap[e].Path:""},e.prototype.getCurrentFunction=function(){var t=this,n=this.injector.get(r.Router),e=Object.keys(this.routeMap).filter(function(e){return n.isActive(t.routeMap[e].Path,!1)}).map(function(e){return t.routeMap[e].Function});return 0<e.length?e[0]:"Not Found"},e.prototype.getRouteMap=function(){return this.routeMap},e.prototype.back=function(e){(void 0===e&&(e=!0),console.log("router back to:",this.previousUrl),this.previousUrl)&&(e&&this.routeReuseStrategy.deleteRouteSnapshot&&this.routeReuseStrategy.deleteRouteSnapshot(),this.injector.get(r.Router).navigate([this.previousUrl]))},e.prototype.getCurrentMenuObject=function(){return this.currentMenuObject},e.prototype.setCurrentMenuObject=function(e){this.currentMenuObject=e},e.prototype.listenRouterEvent=function(){var t=this;this.injector.get(r.Router).events.subscribe(function(e){e instanceof r.NavigationEnd&&(t.previousUrl=t.currentUrl,t.currentUrl=e.url)})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.Injector},{type:p},{type:nt},{type:r.RouteReuseStrategy}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.INJECTOR),u.inject(p),u.inject(nt),u.inject(r.RouteReuseStrategy))},token:e,providedIn:"root"}),e}(),pt={Standalone:0,Integration:1};pt[pt.Standalone]="Standalone",pt[pt.Integration]="Integration";var ft=t,gt=function(){function e(e,t,n,o,r,i,a,s,c){var u=this;this.deviceService=e,this.APIFactory=t,this.dispatcher=n,this.injector=o,this.tokenStore=r,this.router=i,this.APP_CONFIG=a,this.customLoginMgr=s,this.pushIDMgr=c,this.appMode=null,this.token="",this.loginInfo=null,this.infoSubject=new L.BehaviorSubject(this.loginInfo),this.logoutSubject=new L.Subject,this.customLoginMgr?this.customLoginMgr.getToken().subscribe(function(e){u.token=e}):this.tokenStore.getToken().subscribe(function(e){u.token=e}),this.appMode=this.APP_CONFIG.APP_MODE,this.checkLogin()}return e.prototype.getLoginInfo=function(){return console.log("loginMgr getLoginInfo"),this.customLoginMgr?this.customLoginMgr.getLoginInfo():this.infoSubject.asObservable()},e.prototype.getToken=function(){return this.customLoginMgr?this.customLoginMgr.getToken():this.tokenStore.getToken()},e.prototype.checkLogin=function(){if(this.customLoginMgr)return this.customLoginMgr.checkLogin();if(this.appMode===pt.Integration){var e=this.deviceService.getLocalStorage("SNDToken");e&&(this.token=e,this.updateToken(e))}return!!this.token},e.prototype.subscribeLogout=function(){return this.logoutSubject.asObservable()},e.prototype.login=function(e){if(this.customLoginMgr)return this.customLoginMgr.login(e);var t={PushId:this.pushIDMgr.getPushID(),Username:e.username,Password:e.password,DeviceSystem:this.deviceService.getDevicePlatform(),DeviceId:this.deviceService.getDeviceUUID(),DeviceModel:this.deviceService.getDeviceManufacturer(),DeviceType:this.deviceService.isPad()?"Pad":"Phone"},n=this.getAPIFactory(),o=(this.getAPIDispatch(),n.getAPI("onlineLogin"));return o.body=t,L.from(this._login(o))},e.prototype._login=function(i){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.getAPIDispatch().dispatch(i).toPromise()];case 1:return(t=e.sent()).success?(n=ft(t.token),console.log("decoded:",n),this.updateToken(t.token),[2,new ct({isSuccess:!0,type:ut.ONLINE,errorMsg:"",token:t.token})]):[2,new ct({isSuccess:!1,type:ut.ONLINE,errorMsg:"some error happen on login",token:""})];case 2:return o=e.sent(),console.log("login error handler:",o),r=o.message?o.message:"System_Maintenance",[2,new ct({isSuccess:!1,type:ut.ONLINE,errorMsg:r,token:""})];case 3:return[2]}})})},e.prototype.logout=function(){if(this.logoutSubject.next(),this.customLoginMgr)return this.customLoginMgr.logout();this.appMode===pt.Integration?window.location.assign(this.APP_CONFIG.INTEGRATION_BACK_URL):(this.updateToken(null),this.router.navigate("Login"))},e.prototype.updateToken=function(e){if(console.log("updateToken:",e),this.token=e,this.tokenStore.setToken(e),e){var t=new st(ft(e));this.loginInfo=t}else this.loginInfo=null;this.infoSubject.next(this.loginInfo)},e.prototype.getAPIFactory=function(){return this.APIFactory?this.APIFactory:this.injector.get(p)},e.prototype.getAPIDispatch=function(){return this.dispatcher?this.dispatcher:this.injector.get(nt)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:We},{type:p},{type:nt},{type:u.Injector},{type:Be},{type:ht},{type:undefined,decorators:[{type:u.Inject,args:[_]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[V]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[H]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(We),u.inject(p),u.inject(nt),u.inject(u.INJECTOR),u.inject(Be),u.inject(ht),u.inject(_),u.inject(V,8),u.inject(H,8))},token:e,providedIn:"root"}),e}(),dt=function(){function e(e,t,n){this.injector=e,this.loginMgr=t,this.permissionCheck=n,this.permissionMap={},this.userRole=[]}return e.prototype.init=function(){var t=this;console.log("init check permission service"),this.permissionCheck?this.permissionCheck.init():(this.loadJson(),this.loginMgr.getLoginInfo().subscribe(function(e){console.log("check permission subscribe:",e),e&&(t.userRole=e.AppUseMode)}))},e.prototype.loadJson=function(){var t=this,e=this.injector.get(p),n=this.injector.get(nt);if(e&&n){var o=e.getAPI("getRouterMap");o&&n.dispatch(o).subscribe(function(e){t.permissionMap=lt.convertJsonToRouterMap(e),console.log("page permission map:",t.permissionMap)})}else console.log("Check-permission init error: apiFactory or Dispatcher not found.")},e.prototype.authRoute=function(e){if(!e.status)return e;var t=e.payload.func;return console.log(this.permissionMap),t in Object.keys(this.permissionMap)&&(e.status=this.checkPagePermission(t),e.status||(e.error=et.PERMISSION_DENIED)),e},e.prototype.authMenu=function(e){var t=this;return this.permissionCheck?this.permissionCheck.checkMenuPermission(e,this.userRole):(console.log("check menu permission:",e,this.permissionMap),e.filter(function(e){return!Object.keys(t.permissionMap).includes(e)||t.checkPagePermission(e)}))},e.prototype.checkPagePermission=function(t){var n=this;return this.permissionCheck?this.permissionCheck.checkPagePermission(t,this.userRole):this.userRole.map(function(e){return!n.permissionMap[t].Role||-1<n.permissionMap[t].Role.indexOf(e)}).reduce(function(e,t){return e||t},!1)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.Injector},{type:gt},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[w]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.INJECTOR),u.inject(gt),u.inject(w,8))},token:e,providedIn:"root"}),e}(),_t={AVAILABLE:0,PENDING:1};_t[_t.AVAILABLE]="AVAILABLE",_t[_t.PENDING]="PENDING";var yt=function zo(){},Tt=function(){function e(e){this.APP_CONFIG=e,this.currentAction=null,this.actionIntervalSec=800,this.status=_t.AVAILABLE,this.statusSubject=new L.BehaviorSubject(this.status),this.actionSuscribe=new L.Subject,this.actionIntervalSec=this.APP_CONFIG.ACTION_INTERVAL}return e.prototype.authAction=function(e){var t=this;return this.status===_t.AVAILABLE?(this.status=_t.PENDING,this.statusSubject.next(this.status),setTimeout(function(){t.status=_t.AVAILABLE,t.statusSubject.next(t.status)},this.actionIntervalSec)):(e.status=!1,e.error=et.PENDING_ACTION),e},e.prototype.getCurrentAction=function(){return this.currentAction},e.prototype.getActionStatus=function(){return this.statusSubject.asObservable()},e.prototype.onActionClick=function(){return this.actionSuscribe.asObservable()},e.prototype.actionClick=function(e){this.actionSuscribe.next(e)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:u.Inject,args:[_]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(_))},token:e,providedIn:"root"}),e}(),mt=function(){function e(e,t,n,o){this.checkPermissionService=e,this.actionService=t,this.customAuthAction=n,this.customAuthRoute=o}return e.prototype.authRoute=function(o){return I(this,void 0,void 0,function(){var t,n=this;return z(this,function(e){return t=L.of(new Ze(o)).pipe(a.map(function(e){return n.checkPermissionService.authRoute(e)})),this.customAuthRoute&&t.pipe(a.map(function(e){return n.customAuthRoute.authRoute(e)})),[2,t.pipe(a.map(function(e){return{status:e.status,error:e.error}})).toPromise()]})})},e.prototype.authAction=function(o){return I(this,void 0,void 0,function(){var t,n=this;return z(this,function(e){return t=L.of(new Ze(o)).pipe(a.map(function(e){return n.actionService.authAction(e)})),this.customAuthAction&&t.pipe(a.map(function(e){return n.customAuthAction.authAction(e)})),[2,t.pipe(a.map(function(e){return{status:e.status,error:e.error}})).toPromise()]})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:dt},{type:Tt},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[M]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[R]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(dt),u.inject(Tt),u.inject(M,8),u.inject(R,8))},token:e,providedIn:"root"}),e}(),Dt=function(){function e(e,t,n,o,r,i,a,s){var c=this;this.authService=e,this.APIFactory=t,this.dispatcher=n,this.deviceService=o,this.actionService=r,this.appRouter=i,this.elRef=a,this.actionDirectiveTask=s,this.actionClick=new u.EventEmitter,this.isDisabled=!1,this.actionService.getActionStatus().subscribe(function(e){c.isDisabled=e===_t.PENDING})}return e.prototype.ngAfterViewInit=function(){},e.prototype.onclick=function(i){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return console.log("action click:",this.action,i),i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),console.log("actionClick after output: ",i),(t=new yt).action=this.action,t.event=i,this.actionService.actionClick(t),[4,this.authService.authAction({action:this.action})];case 1:return(n=e.sent()).status?(this.actionClick.emit(i),console.log("actionClick output: ",i),this.actionDirectiveTask?[4,this.actionDirectiveTask.doTask(this.action)]:[3,3]):[3,4];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:console.log("action: "+this.action+" auth failed."),e.label=5;case 5:return(o=this.APIFactory.getAPI("LogAction")).action=this.action,o.time=new Date,o.valid=n.status,o.message=n.error,o.Function=this.appRouter.getCurrentFunction(),o.DeviceModel=this.deviceService.getDeviceManufacturer(),o.DeviceSystem=this.deviceService.getDevicePlatform(),[4,this.dispatcher.dispatch(o).toPromise()];case 6:return r=e.sent(),console.log("log Action resp:",r),[2]}})})},e.decorators=[{type:u.Directive,args:[{selector:"[Action]"}]}],e.ctorParameters=function(){return[{type:mt},{type:p},{type:nt},{type:We},{type:Tt},{type:ht},{type:u.ElementRef},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[Le]}]}]},e.propDecorators={action:[{type:u.Input}],actionClick:[{type:u.Output}],isDisabled:[{type:u.HostBinding,args:["class.disabled"]}],onclick:[{type:u.HostListener,args:["onClick",["$event"]]},{type:u.HostListener,args:["onClickLink",["$event"]]},{type:u.HostListener,args:["onTabChildClick",["$event"]]},{type:u.HostListener,args:["ClickBtn",["$event"]]},{type:u.HostListener,args:["click",["$event"]]}]},e}(),It=function(){function e(e,t){this.dbName=e,this.key=t}return e.prototype.getName=function(){return this.dbName},e.prototype.getKey=function(){return this.key},e.prototype.setName=function(e){this.dbName=e},e.prototype.setkey=function(e){this.key=e},e}(),St=function(){function e(e,t,n,o,r){this.colName=e,this.colValue=t,this.isPrimaryKey=o,this.isAutoincrement=r,this.type=n}return e.prototype.getName=function(){return this.colName},e.prototype.getValue=function(){return this.colValue},e.prototype.getType=function(){return this.type},e.prototype.setValue=function(e){"text"==this.type?this.colValue=e.toString():"integer"==this.type?this.colValue=parseInt(e):"real"==this.type?this.colValue=parseFloat(e):this.colValue=e},e.prototype.getIsPrimaryKey=function(){return this.isPrimaryKey},e.prototype.getIsAutoincrement=function(){return this.isAutoincrement},e}(),vt=function(){function c(e,t){this.tableName=e,this.columns=t,this.restrictions=[]}return c.prototype.setValue=function(t,n){this.columns.filter(function(e){return e.getName()==t}).forEach(function(e){e.setValue(n)})},c.prototype.getValue=function(t){var e=this.columns.filter(function(e){return e.getName()==t});return 0<t.length?e[0].getValue():null},c.prototype.hasColumn=function(t){return 0<this.columns.filter(function(e){return e.getName()==t}).length},c.prototype.getTableName=function(){return this.tableName},c.prototype.getColumns=function(){return this.columns},c.prototype.addRestriction=function(e){this.restrictions.push(e)},c.prototype.getRestrictions=function(){return this.restrictions},c.prototype.cloneTable=function(){var e,t,n=[];try{for(var o=$(this.columns),r=o.next();!r.done;r=o.next()){var i=r.value,a=Object.create(St.prototype);a=Object.assign(a,i),n.push(a)}}catch(s){e={error:s}}finally{try{r&&!r.done&&(t=o["return"])&&t.call(o)}finally{if(e)throw e.error}}return new c(this.tableName,n)},c.prototype.isSetted=function(){return 0<this.getColumns().map(function(e){return e.getValue()!==undefined}).length},c}(),Pt=function(){function e(e){void 0===e&&(e=[]),this.values=e}return e.prototype.sqlString=function(){return"LIMIT "+this.values[0].toString()+" "},e.prototype.getValues=function(){return this.values},e}(),At=function(){function e(e){void 0===e&&(e=[]),this.values=e}return e.prototype.sqlString=function(){return"OFFSET "+this.values[0]+" "},e.prototype.getValues=function(){return this.values},e}(),Ct=function(){function e(e,t){this.params=new Array,this.sql=e,this.params=t}return e.prototype.setSql=function(e){this.sql=e},e.prototype.setParam=function(e){this.params.push(e)},e.prototype.getSql=function(){return this.sql},e.prototype.getParams=function(){return this.params},e}(),bt=function(){function e(e){void 0===e&&(e=[]),this.values=e}return e.prototype.sqlString=function(){return"ORDER BY "+this.values.map(function(e){return e.column+" "+e.order}).reduce(function(e,t){return e+","+t})+" "},e.prototype.getValues=function(){return this.values},e}(),Et=function(){function e(e){this.transactionArr=[],this.config=e}return e.prototype.openDataBase=function(){var o=this,e=this.config;return new Promise(function(t,n){window.sqlitePlugin.openDatabase({name:e.getName()+".db",location:"default",key:e.getKey(),androidDatabaseImplementation:"system"},function(e){o.connection=e,t(e)},function(){var e=new Error("Sqlite DB open error.");n(e)})})},e.prototype.queryByTable=function(e){var t=e.getRestrictions(),n=t.filter(function(e){return!(e instanceof Pt||e instanceof At||e instanceof bt)}).map(function(e){return"AND "+e.sqlString()}).join(""),o=t.filter(function(e){return!(e instanceof Pt||e instanceof At||e instanceof bt)}).map(function(e){return e.getValues()}).reduce(function(e,t){return m(e,t)},[]),r=t.filter(function(e){return e instanceof bt}).map(function(e){return e.sqlString()}).join(""),i=t.filter(function(e){return e instanceof Pt}).map(function(e){return e.sqlString()}).join(""),a=t.filter(function(e){return e instanceof At}).map(function(e){return e.sqlString()}).join(""),s="SELECT count(*) FROM "+e.getTableName()+" WHERE 1=1 "+n,c="SELECT * FROM "+e.getTableName()+" WHERE 1=1 "+n+r+i+a,u=new Ct(c,o),l=new Ct(s,o);return console.group("run select sql command"),console.log(c),console.log("params",o),console.groupEnd(),this.runQuerySqlcommand(u,l)},e.prototype.insertByTable=function(e){var t=this,n=this.transformInsert(e);return console.group("run insert sql command"),console.log(n.getSql()),console.log("params",n.getParams()),console.groupEnd(),L.Observable.create(function(e){t.runSqlCommand(e,n)})},e.prototype.updateByTable=function(e){var t=this,n=this.transformUpdate(e);return console.group("run update sql command"),console.log(n.getSql()),console.log("params",n.getParams()),console.groupEnd(),L.Observable.create(function(e){t.runSqlCommand(e,n)})},e.prototype.deleteByTable=function(e){var t=this,n=this.transformDelete(e);return console.group("run delete sql command"),console.log(n.getSql()),console.log("params",n.getParams()),console.groupEnd(),L.Observable.create(function(e){t.runSqlCommand(e,n)})},e.prototype.transactionInsert=function(e){this.addTransactionCommand(this.transformInsert(e))},e.prototype.transactionUpdate=function(e){this.addTransactionCommand(this.transformUpdate(e))},e.prototype.transactionDelete=function(e){this.addTransactionCommand(this.transformDelete(e))},e.prototype.transactionSqlCommand=function(e){this.addTransactionCommand(e)},e.prototype.excuteSqlCommand=function(s){var e=this;return console.log("excuteSqlCommand:",s),L.Observable.create(function(t){e.connection.transaction(function(e){var t,n;try{for(var o=$(s),r=o.next();!r.done;r=o.next()){var i=r.value;e.executeSql(i.getSql(),i.getParams(),function(){},function(e,t){console.log("execute sql error:",t)})}}catch(a){t={error:a}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(t)throw t.error}}},function(e){throw t.next(new ot({status:!1,msg:e.message},[])),t.complete(),new D("F00017",e.message)},function(){t.next(new ot({status:!0},[])),t.complete()})})},e.prototype.getSchema=function(){var i=this,a=new Map;return L.Observable.create(function(n){i.connection.transaction(function(e){e.executeSql('SELECT name,sql FROM sqlite_master WHERE type="table" OR type="view"',[],function(e,t){for(var n=0;n<t.rows.length;n++){var o=t.rows.item(n).name,r=t.rows.item(n).sql;i.getColumns(e,a,o,r)}},function(e,t){console.log("select table name error:",t.message)})},function(e,t){throw n.next(new ot({status:!1,msg:t.message},[])),n.complete(),new D("F00017",t.message)},function(){n.next(a),n.complete()})})},e.prototype.runTransaction=function(){var n=this;return L.Observable.create(function(t){var e=n.transactionArr.map(function(e){return[e.getSql(),e.getParams()]});console.group("run transaction SQL:"),console.log("command:",e),console.groupEnd(),n.connection.sqlBatch(e,function(){t.next(new ot({status:!0},[])),t.complete()},function(e){throw t.next(new ot({status:!1,msg:e.message},[])),t.complete(),new D("F00018",e.message)})})},e.prototype.clearTransaction=function(){this.transactionArr=[]},e.prototype.getColumns=function(e,c,u,l){var h=[];console.log("getColumns:",u,l),e.executeSql("PRAGMA table_info("+u+")",[],function(e,t){for(var n=0;n<t.rows.length;n++){var o=!!t.rows.item(n).pk,r=t.rows.item(n).name,i=o&&-1<l.toUpperCase().indexOf("AUTOINCREMENT"),a=t.rows.item(n).type;h.push(new St(r,undefined,a,o,i))}var s=new vt(u,h);c.set(u,s)},function(e,t){throw console.log("Get table column list error:",t.message),new D("F00019",t.message)})},e.prototype.runSqlCommand=function(n,t){this.connection.transaction(function(e){e.executeSql(t.getSql(),t.getParams(),function(e,t){n.next(new ot({status:!0},[])),n.complete()},function(e,t){throw n.next(new ot({status:!1,msg:t.message},[])),n.complete(),new D("F00017",t.message)})})},e.prototype.runQuerySqlcommand=function(t,n){var e=this;return console.log("runQuerySqlcommand",t),L.Observable.create(function(i){e.connection.transaction(function(e){e.executeSql(t.getSql(),t.getParams(),function(e,r){e.executeSql(n.getSql(),n.getParams(),function(e,t){for(var n=[],o=0;o<r.rows.length;o++)n.push(r.rows.item(o));console.log("run query sql finish!",n),i.next(new ot({record_length:t.rows.item(0)["count(*)"],status:!0},n)),i.complete()},function(e,t){throw console.log(t.message),i.next(new ot({status:!1,message:t.message},[])),i.complete(),new D("F00017",t.message)})},function(e,t){throw console.log(t.message),i.next(new ot({status:!1,message:t.message},[])),i.complete(),new D("F00017",t.message)})})})},e.prototype.transformInsert=function(e){var t=e.getColumns().filter(function(e){return e.getValue()!==undefined}),n=t.map(function(e){return e.getValue()}),o="INSERT INTO "+e.getTableName()+" ("+t.map(function(e){return e.getName()}).join(",")+") VALUES ("+t.map(function(e){return"?"}).join(",")+")";return new Ct(o,n)},e.prototype.transformUpdate=function(e){var t=e.getColumns().filter(function(e){return e.getValue()!==undefined}),n=t.map(function(e){return e.getValue()}),o=t.map(function(e){return" "+e.getName()+"=?"}).join(","),r=e.getRestrictions(),i=r.filter(function(e){return!(e instanceof Pt||e instanceof At)}).map(function(e){return"AND "+e.sqlString()}).join(""),a=r.filter(function(e){return!(e instanceof Pt||e instanceof At)}).map(function(e){return e.getValues()}).reduce(function(e,t){return m(e,t)},[]),s="UPDATE "+e.getTableName()+" SET "+o+" WHERE 1=1 "+i;return new Ct(s,m(n,a))},e.prototype.transformDelete=function(e){var t=e.getRestrictions(),n=t.filter(function(e){return!(e instanceof Pt||e instanceof At)}).map(function(e){return"AND "+e.sqlString()}).join(""),o=t.filter(function(e){return!(e instanceof Pt||e instanceof At)}).map(function(e){return e.getValues()}).reduce(function(e,t){return m(e,t)},[]),r="DELETE FROM "+e.getTableName()+" WHERE 1=1 "+n;return new Ct(r,o)},e.prototype.addTransactionCommand=function(e){this.transactionArr.push(e)},e}(),Lt=function(t){function e(e){return t.call(this,e)||this}return l(e,t),e.prototype.openDataBase=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return this.connection=window.openDatabase(this.config.getName(),"1.0",this.config.getName(),2097152),console.log("OpenDataBase:",this.connection),[2,this.connection]})})},e.prototype.getColumns=function(e,t,n,o){var r=[];if(-1<o.indexOf("CREATE VIEW")){var i=o.split(" ").indexOf("LEFT")-1,a=i+3,s=o.split(" ")[i],c=o.split(" ")[a],u=t.get(s),l=t.get(c);r=(r=m(u.getColumns(),l.getColumns())).reduce(function(e,t){return e.some(function(e){return e.getName()===t.getName()})||e.push(t),e},[])}else r=o.split("(")[1].split(",").map(function(e){var t=-1<e.toUpperCase().indexOf("PRIMARY KEY"),n=e.trim().split(" ")[0],o=t&&-1<e.toUpperCase().indexOf("AUTOINCREMENT"),r=-1<e.toUpperCase().indexOf("INTEGER")?"Integer":"Text";return new St(n,undefined,r,t,o)});var h=new vt(n,r);t.set(n,h)},e.prototype.runTransaction=function(){var n=this;return L.Observable.create(function(t){var e=n.transactionArr.map(function(e){return[e.getSql(),e.getParams()]});console.group("run transaction SQL:"),console.log("command:",e),console.groupEnd(),n.connection.transaction(function(t){n.transactionArr.forEach(function(e){t.executeSql(e.getSql(),e.getParams())})},function(e){throw t.next(new ot({status:!1,msg:e.message},[])),t.complete(),new D("F00018",e.message)},function(){t.next(new ot({status:!0},[])),t.complete()})})},e.prototype.clearTransaction=function(){this.transactionArr=[]},e}(Et),Nt=function(){function e(e,t,n){this.deviceService=e,this.errorHandler=t,this.APP_CONFIG=n,this.tableMapping=new Map,this.dbMapping=new Map}return e.prototype.getTable=function(e,t){return this.tableMapping.has(e)&&this.tableMapping.get(e).has(t)?this.tableMapping.get(e).get(t).cloneTable():(this.errorHandler.handleError(new D("F00012","Cannot Find table "+t+" in DB "+e+".")),undefined)},e.prototype.getDefaultTable=function(e){return this.getTable("Main",e)},e.prototype.getDao=function(e){return console.log("get Dao:",e),this.dbMapping.has(e)?(this.dbMapping.get(e).clearTransaction(),this.dbMapping.get(e)):(this.errorHandler.handleError(new D("F00011","Cannot Find Sqlite DB "+e+" Dao.")),undefined)},e.prototype.getDefaultDao=function(){return this.getDao("Main")},e.prototype.init=function(){return I(this,void 0,void 0,function(){return z(this,function(e){switch(e.label){case 0:return"DEV"!=this.APP_CONFIG.ENV?[3,1]:[2];case 1:return[4,this.mappingDB()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},e.prototype.refreshTableSchema=function(){return I(this,void 0,void 0,function(){var t,n,o,r,i,a,s,c,u=this;return z(this,function(e){switch(e.label){case 0:o=this.APP_CONFIG[this.APP_CONFIG.ENV].DATABASE,r=Object.keys(o),e.label=1;case 1:e.trys.push([1,6,7,8]),i=$(r),a=i.next(),e.label=2;case 2:return a.done?[3,5]:(s=a.value,[4,this.getTableSchema(s,o)]);case 3:e.sent(),e.label=4;case 4:return a=i.next(),[3,2];case 5:return[3,8];case 6:return c=e.sent(),t={error:c},[3,8];case 7:try{a&&!a.done&&(n=i["return"])&&n.call(i)}finally{if(t)throw t.error}return[7];case 8:return setTimeout(function(){console.group("refreshTableSchema"),console.log(u.dbMapping),console.log(u.tableMapping),console.groupEnd()},5e3),[2]}})})},e.prototype.mappingDB=function(){return I(this,void 0,void 0,function(){var t,n,o,r,i,a,s,c,u=this;return z(this,function(e){switch(e.label){case 0:o=this.APP_CONFIG[this.APP_CONFIG.ENV].DATABASE,r=Object.keys(o),e.label=1;case 1:e.trys.push([1,6,7,8]),i=$(r),a=i.next(),e.label=2;case 2:return a.done?[3,5]:(s=a.value,console.log("getSchema:",s),[4,this.getSchema(s,o)]);case 3:e.sent(),e.label=4;case 4:return a=i.next(),[3,2];case 5:return[3,8];case 6:return c=e.sent(),t={error:c},[3,8];case 7:try{a&&!a.done&&(n=i["return"])&&n.call(i)}finally{if(t)throw t.error}return[7];case 8:return setTimeout(function(){console.group("mappingDB"),console.log(u.dbMapping),console.log(u.tableMapping),console.groupEnd()},5e3),[2]}})})},e.prototype.getSchema=function(r,i){return I(this,void 0,void 0,function(){var t,n,o;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,this.getDatabaseKey(r,i)];case 1:return t=e.sent(),[4,this.openDatabase(r,i,t)];case 2:return e.sent(),[3,4];case 3:return n=e.sent(),console.warn("getSchema error:",n.message),o=new D("F00010","Sqlite DB open error."),this.errorHandler.handleError(o),[3,4];case 4:return[2]}})})},e.prototype.getDatabaseKey=function(o,r){return I(this,void 0,void 0,function(){var t,n;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,7,,8]),[4,this.deviceService.getSecureStorage(r[o].name).toPromise()];case 1:if(t=e.sent(),console.log("getDatabaseKey resp:",t),!t.includes("Device is not secure"))return[3,2];throw new Error(t);case 2:return t?[2,t]:[3,3];case 3:return[4,this.deviceService.setSecureStorage(r[o].name,Q.v4()).toPromise()];case 4:return e.sent()?[4,this.deviceService.getSecureStorage(r[o].name).toPromise()]:[3,6];case 5:return[2,n=e.sent()];case 6:return[3,8];case 7:return e.sent(),console.log("getDatabaseKey error, use localStorage"),this.deviceService.getLocalStorage(r[o].name)?[2,this.deviceService.getLocalStorage(r[o].name)]:(n=Q.v4(),this.deviceService.setLocalStorage(r[o].name,n),[2,n]);case 8:return[2]}})})},e.prototype.openDatabase=function(r,i,a){return I(this,void 0,void 0,function(){var t,n,o;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=new It(i[r].name,a),[4,this.createDao(t)];case 1:return n=e.sent(),this.dbMapping.set(i[r].name,n),[3,3];case 2:return o=e.sent(),this.errorHandler.handleError(new D("F00010",o.message)),[3,3];case 3:return[2]}})})},e.prototype.createDao=function(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return[4,(t="DEV_WebSQL"===this.APP_CONFIG.ENV?new Lt(n):new Et(n)).openDataBase()];case 1:return e.sent(),[2,t]}})})},e.prototype.getTableSchema=function(n,o){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return[4,this.dbMapping.get(o[n].name).getSchema().toPromise()];case 1:return t=e.sent(),this.tableMapping.set(o[n].name,t),[2]}})})},e.prototype.clearDatabaseData=function(r){return I(this,void 0,void 0,function(){var n,t,o;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),(n=this.dbMapping.get(r))?(this.tableMapping.get(r).forEach(function(e,t){-1!==t.indexOf("TW_LH_SD")&&-1==t.indexOf("TW_LH_SD_VW")&&n.transactionDelete(e)}),[4,n.runTransaction().toPromise()]):[3,2];case 1:return t=e.sent(),console.log("clearDatabaseData resp:",t),[3,3];case 2:throw new Error("Cannot find dao "+r+".");case 3:return[3,5];case 4:throw o=e.sent(),new D("F00022","Clear database error, "+o.message);case 5:return[2]}})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:We},{type:u.ErrorHandler},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[_]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(We),u.inject(u.ErrorHandler),u.inject(_,8))},token:e,providedIn:"root"}),e}(),Ot=function(){function e(e,t){void 0===t&&(t=[]),this.column=e,this.values=t}return e.prototype.sqlString=function(){return this.column+" <> ? "},e.prototype.getValues=function(){return this.values},e}(),Ft=function(){function e(e){this.baseDao=e}return e.prototype.openDataBase=function(){return this.baseDao.openDataBase()},e.prototype.queryByTable=function(e){return e.hasColumn("IsDelete")&&e.addRestriction(new Ot("IsDelete",["Y"])),this.baseDao.queryByTable(e)},e.prototype.insertByTable=function(e){var n=this,o=Q.v4();return""!=e.getValue("ClientID")&&e.getValue("ClientID")!=undefined||e.setValue("ClientID",o),e.setValue("ClientTime",(new Date).getTime()),e.setValue("DataSource","APP"),e.setValue("IsDelete","N"),L.Observable.create(function(t){n.baseDao.insertByTable(e).subscribe(function(e){e.Header.clientID=o,t.next(e),t.complete()})})},e.prototype.updateByTable=function(e){return e.setValue("ClientTime",(new Date).getTime()),this.baseDao.updateByTable(e)},e.prototype.deleteByTable=function(e){return e.setValue("IsDelete","Y"),e.setValue("ClientTime",(new Date).getTime()),this.baseDao.updateByTable(e)},e.prototype.excuteSqlCommand=function(e){return this.baseDao.excuteSqlCommand(e)},e.prototype.getSchema=function(){return this.baseDao.getSchema()},e.prototype.transactionInsert=function(e){""!=e.getValue("ClientID")&&e.getValue("ClientID")!=undefined||e.setValue("ClientID",Q.v4()),e.setValue("ClientTime",(new Date).getTime()),e.setValue("DataSource","APP"),e.setValue("IsDelete","N"),this.baseDao.transactionInsert(e)},e.prototype.transactionUpdate=function(e){e.setValue("ClientTime",(new Date).getTime()),this.baseDao.transactionUpdate(e)},e.prototype.transactionDelete=function(e){e.setValue("IsDelete","Y"),e.setValue("ClientTime",(new Date).getTime()),this.baseDao.transactionUpdate(e)},e.prototype.transactionSqlCommand=function(e){this.baseDao.transactionSqlCommand(e)},e.prototype.runTransaction=function(){return this.baseDao.runTransaction()},e.prototype.clearTransaction=function(){return this.baseDao.clearTransaction()},e}(),wt=function(){function e(e,t){this.daoFactory=e,this._location=t,this.isHasData=!1,this.recordLength=0}return e.prototype.ngOnInit=function(){var e=[];for(var t in Mt)isNaN(Number(t))&&(console.log("value:",t,"  name:",Mt[t]),e.push(new Rt(t,Mt[t])));this.selectTablesOptionList=e,this.selectTableChange(this.selectTablesOptionList[0].getValue())},e.prototype.goToLastPage=function(){this._location.back()},e.prototype.refresh=function(){this.queryBytable(this.currentDbName,this.currentTable)},e.prototype.selectTableChange=function(e){console.log("selectTableKey: ",e),this.selectTable=e,this.currentTable=Mt[e],console.log("selectTable: ",this.selectTable),"Profile"==e.substring(0,7)?this.currentDbName="Profile":this.currentDbName="Main",this.queryBytable(this.currentDbName,this.currentTable)},e.prototype.queryBytable=function(e,t){var n,o,r=this;console.log("dbName: ",e," tableName: ",t),n=this.daoFactory.getDao(e),n=new Ft(n),o=this.daoFactory.getTable(e,t),this.tableColumns=o.getColumns().map(function(e){return e.getName()}),console.log("dao: ",n),console.log("tableObj: ",o),n.queryByTable(o).subscribe(function(e){console.log("response data: ",e),e.Header.status?(r.recordLength=e.Header.record_length,r.responseBody=e.Body,console.log("responseBody: ",r.responseBody),r.responseBody.forEach(function(e){console.log("element: ",e),e.values=Object.values(e)}),r.isHasData=!0):(r.isHasData=!1,alert("fail")),console.log("Sqlite data: ",e)})},e.decorators=[{type:u.Component,args:[{selector:"snd-sqlite-executor",template:'<div class="layout-full-page">\n  <input type="button" value="back" (click)="goToLastPage()">\n  <select form="carform" [ngModel]="selectTable" (ngModelChange)="selectTableChange($event)">\n    <ng-container *ngFor="let tableOption of selectTablesOptionList">\n        <option [value]="tableOption.getValue()">{{tableOption.getName()}}</option>\n    </ng-container>\n  </select>\n  <input type="button" value="refresh" (click)="refresh()">\n  <ng-container *ngIf="isHasData">\n    <span> length: {{recordLength}}</span>\n    <table border="1">\n      <thead>\n        <tr>\n          <th>N</th>\n          <ng-container *ngFor="let column of tableColumns">\n          <th>{{column}}</th>\n          </ng-container>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor="let element of responseBody; let i = index">\n          <th>{{i+1}}</th>\n          <ng-container *ngFor="let value of element.values">\n            <th>{{value}}</th>\n          </ng-container>\n        </tr>\n      </tbody>\n    </table>\n  </ng-container>\n  \n</div>\n',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.layout-full-page{box-sizing:border-box;overflow-y:auto;height:100vh;display:inline-block;width:100vw;background-color:#fff;overflow-x:auto;padding:10px}.layout-full-page table{max-width:100vw;width:100%;height:100vh;overflow-y:auto;overflow-x:auto;background-color:#fff}@media (max-width:767px){.layout-full-page{padding-top:30px;padding-left:5px;padding-right:5px}}"]}]}],e.ctorParameters=function(){return[{type:Nt},{type:n.Location,decorators:[{type:u.Optional}]}]},e}(),Mt={Profile_TW_LH_SD_Code:"TW_LH_SD_Code",Profile_TW_LH_SD_DeviceInfo:"TW_LH_SD_DeviceInfo",Profile_TW_LH_SD_DataSync_Time:"TW_LH_SD_DataSync_Time",Profile_TW_LH_SD_VW_FuncSync_Time:"TW_LH_SD_VW_FuncSync_Time",Profile_TW_LH_SD_Language:"TW_LH_SD_Language",Profile_TW_LH_SD_Error_Log:"TW_LH_SD_Error_Log",Profile_TW_LH_SD_Action_Log:"TW_LH_SD_Action_Log",TW_LH_SD_Calendar_Extension:"TW_LH_SD_Calendar_Extension",TW_LH_SD_Calendar:"TW_LH_SD_Calendar",TW_LH_SD_Customer_Address_Extension:"TW_LH_SD_Customer_Address_Extension",TW_LH_SD_Customer_Email_Extension:"TW_LH_SD_Customer_Email_Extension",TW_LH_SD_Customer_Tel_Extension:"TW_LH_SD_Customer_Tel_Extension",TW_LH_SD_Customer_Contact_Extension:"TW_LH_SD_Customer_Contact_Extension",TW_LH_SD_Customer_Extension:"TW_LH_SD_Customer_Extension",TW_LH_SD_Customer_Address:"TW_LH_SD_Customer_Address",TW_LH_SD_Customer_Email:"TW_LH_SD_Customer_Email",TW_LH_SD_Customer_Tel:"TW_LH_SD_Customer_Tel",TW_LH_SD_Customer_Contact:"TW_LH_SD_Customer_Contact",TW_LH_SD_Customer:"TW_LH_SD_Customer",TW_LH_SD_Personal_Setting:"TW_LH_SD_Personal_Setting",TW_LH_SD_VW_Customer:"TW_LH_SD_VW_Customer",TW_LH_SD_Message:"TW_LH_SD_Message",TW_LH_SD_Year_Config:"TW_LH_SD_Year_Config",TW_LH_SD_Goal_Setting:"TW_LH_SD_Goal_Setting",TW_LH_SD_Goal_Setting_Value:"TW_LH_SD_Goal_Setting_Value",TW_LH_SD_Goal_Setting_Plan_Value:"TW_LH_SD_Goal_Setting_Plan_Value",TW_LH_SD_Goal_Setting_Expected:"TW_LH_SD_Goal_Setting_Expected",TW_LH_SD_Actual_Value:"TW_LH_SD_Actual_Value",TW_LH_SD_Agency_Plan_Main:"TW_LH_SD_Agency_Plan_Main",TW_LH_SD_Agency_Detail_Data:"TW_LH_SD_Agency_Detail_Data",TW_LH_SD_Personal_Progress:"TW_LH_SD_Personal_Progress",TW_LH_SD_Team_Progress_Main:"TW_LH_SD_Team_Progress_Main",TW_LH_SD_Team_Progress_Detail:"TW_LH_SD_Team_Progress_Detail",TW_LH_SD_Other_Parameter:"TW_LH_SD_Other_Parameter"},Rt=function(){function e(e,t){this._value=e,this._name=t}return e.prototype.getName=function(){return this._name},e.prototype.getValue=function(){return this._value},e}(),jt=function(){function e(e){var t=this;this.loginMgr=e,this._role="",this._million=1e6,this.loginMgr.getLoginInfo().subscribe(function(e){e.AppUseMode&&0<e.AppUseMode.length&&(t._role=e.AppUseMode[e.AppUseMode.length-1])})}return e.prototype.translatePrice=function(e){var t="Manager"==this._role||"Supervisor"==this._role;return!isNaN(Number(e))&&t?this._numberToFix(e/this._million,1):e},e.prototype._numberToFix=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:gt}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(gt))},token:e,providedIn:"root"}),e}(),kt=function(){function e(e){this.translatePriceService=e,this.role="",this.million=1e6}return e.prototype.transform=function(e,t){return this.translatePriceService.translatePrice(e)},e.decorators=[{type:u.Pipe,args:[{name:"translatePrice",pure:!1}]}],e.ctorParameters=function(){return[{type:jt}]},e}(),Vt=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{imports:[i.HttpClientModule,n.CommonModule,o.FormsModule],declarations:[it,kt,at,Dt,wt],exports:[it,kt,at,Dt,i.HttpClientModule]}]}],e}(),Ht=function $o(){this.performance="Performance",this.team="Team",this.personal="Personal",this.activitiesPoints="Activities_Points",this.monthlyProgress="Monthly_Progress",this.yearlyProgress="Yearly_Progress",this.message="Message",this.progress="Progress",this.goalSettingMsgType="Goal_Setting",this.all="All",this.unread="Unread",this.noMessage="No_Message",this.schedule="Schedule",this.noBirthday="No_Birthday",this.customerType="Customer_Type",this.customerSource="Customer_Source",this.birthday="Birthday",this.ageRange="Age_range",this.gender="Gender",this.source="Source",this.marriage="Marriage",this.children="Children",this.familiarity="Familiarity",this.recentStatus="Recent_status",this.customerStatus="Customer_Status",this.contactFrequencyMonth="Contact_Frequency_Month",this.possibility="Possibility",this.completeness="Completeness",this.contactFrequency="Contact_Frequency",this.timePerYear="Time_Per_Year",this.appointment="Appointment",this.contact="Contact",this.edit="Edit",this["delete"]="Delete",this.home="Home",this.homepage="Homepage",this.work="Work",this.mobile="Mobile",this.detail="Detail",this.occupation="Occupation",this.company="Company",this.annualIncome="Annual_Income",this.contactNote="Contact_Note",this.add="Add",this.noRecord="No_Record",this.customerList="Customer_List",this.importPhone="Import_Phone",this.people="People",this.lastName="Last_name",this.firstName="First_name",this.phone="Phone",this.email="Email",this.address="Address",this.country="Country",this.city="City",this.area="Area",this.code="Code",this.age="Age",this.select="Select",this.contactFrequencyYear="Contact_Frequency_Year",this.save="Save",this.lastNamePlaceholder="Last_Name_Placeholder",this.firstNamePlaceholder="First_Name_Placeholder",this.wrongLastName="Wrong_Lastname",this.wrongEmail="Wrong_Email",this.wrongBirthday="Wrong_Birthday",this.annualIncomeYearNTD="Annual_Income(Year/NTD)",this.preset="Preset",this.day="Day",this.week="Week",this.month="Month",this.year="Year",this.today="Today",this.filter="Filter",this.appointmentDetail="Appointment_Details",this.saved="Saved",this.loading="Loading",this.title="Title",this.location="Location",this.activity="Activity",this.date="Date",this.allDay="All_Day",this.from="From",this.to="To",this.alert="Alert",this.remark="Remark",this.yes="Yes",this.no="No",this.deleteAppointment="Delete_Appointment",this.wrongTitle="wrong_Title",this.wrongAlert="Wrong_Alert",this.alertPlaceholder="Alert_Placeholder",this.wrongTitleRequired="Wrong_Title_Require",this.wrongActivityRequired="Wrong_Activity_Required",this.wrongDate="Wrong_Date",this.wrongTime="Wrong_Time",this.wrongStartTime="Wrong_Start_Time",this.wrongEndTime="Wrong_End_Time",this.wrongAlertRequired="Wrong_Alert_Require",this.noSchedule="No_Schedule",this.customerInformation="Customer_Information",this.click="Click",this.noEdit="No_Edit",this.noSearch="No_Search",this.noFilter="No_Filter",this["import"]="Import",this.customerFilter="Customer_Filter",this.clear="CLEAR",this.selectNumber="Select_Number",this.cancel="Cancel",this.protectionTitle="Protection_Title",this.deleteMessage="Delete_Message",this.customer="Customer",this.deleteProtectionTitle="Delete_Protection_Title",this.updateProtectionTitle="Update_Protection_Title",this.commentRemindTitle="Comment_Remind_Title",this.confirm="Confirm",this.completed="Completed",this.searchPlaceholder="Search_Placeholder",this.notePlaceholder="Note_Placeholder",this.logOut="Log_Out",this.noClick="No_Click",this.noInformation="No_Information",this.moreOption="More_Option",this.empty="Empty",this.calendarMore="Calendar_More",this.mainMenu="Main_Menu",this.have="Have",this.appointments="Appointments",this.anAppointment="An_Appointment",this.notification="Notification",this.language="Language",this.version="Version",this.contactMessage="Contact_Message",this.welcome="Welcome",this.accountPassword="Account_Password",this.nationalID="National_ID",this.password="Password",this.forgotPassword="Forgot_Password",this.login="Login",this.pleaseWait="Please_Wait",this.changeLanguage="Change_Language",this.fontSize="Font_Size",this.changeFontSize="Change_Font_Size",this.updateTime="Update_Time",this.seeDetails="See_Details",this.fileDownload="File_Download",this.signIn="Sign_In",this.loadingMessage="Landing_Message",this.load="Load",this.agencyPlanSubtitle="Agency_Plan_Subtitle",this.agencyPlanOverviewTitle="Agency_Plan_Overview_Title",this.FYFCForecast="FYFC_Forecast",this.FYFCActual="FYFC_Actual",this.FYFCMonthPlan="FYFC_Month_Plan",this.ANPForecast="ANP_Forecast",this.ANPActual="ANP_Actual",this.ANPMonthPlan="ANP_Month_Plan",this.manpowerPlan="Manpower_Plan",this.recruitmentPlan="Recruitment_Plan",this.manpower="Manpower",this.recruitment="Recruitment",this.FYFCGoal="FYFC_Goal",this.directUnit="Direct_Unit",this.agencyPlanInformationTitle="Agency_Plan_Information_Title",this.yellow="Yellow",this.agencyPlanInformation="Agency_Plan_Information",this.agencyPlanExpected="Agency_Plan_Expected",this.teamGoal="Team_Goal",this.Q1="Q1",this.Q2="Q2",this.Q3="Q3",this.Q4="Q4",this.recruitmentTotal="Recruitment_Total",this.indirectUnit="Indirect_Unit",this.ANPGoal="ANP_Goal",this.saveFile="Save_File",this.agencyPlan="Agency_Plan",this.FYFC="FYFC",this.ANP="ANP",this.recruitmentCommitment="Recruitment_Commitment",this.caseCount="Case_Count",this.averageFYFCPerCase="Average_FYFC_Per_Case",this.averageANPPerCase="Average_ANP_Per_Case",this.manpowerGoal="Manpower_Goal",this.reset="Reset",this.thisYearTitle="This_Year_Title",this.variableYearTitle="Variable_Year_Title",this.yourAgencyGoal="Your_Agency_Goal",this.annualConvention="Annual_Convention",this.promotionPlan="Promotion_Plan",this.MDRT="MDRT",this.goalEffectiveMonth="Goal_Effective_Month",this.allYearGoal="All_Year_Goal",this.monthGoal="Month_Goal",this.allianzStarClub="Allianz_Star_Club",this.summitTrip="Summit_Trip",this.longTermIncentiveTripProgram="Long_Term_Incentive_Trip_Program",this.COT="COT",this.TOT="TOT",this.SP="SP",this.AM="AM",this.SM="SM",this.dashDash="Dash_Dash",this.personalMonthlyPlanFYFC="Personal_Monthly_Plan_FYFC",this.plan="Plan",this.actual="Actual",this.overviewStep3Title="Overview_Step3_Title",this.find="Find",this.meet="Meet",this.submit="Submit",this.inforce="Inforce",this.daily="Daily",this.weekly="Weekly",this.monthly="Monthly",this.approvalStatus="Approval_Status",this.goalBeenApproval="Goal_Been_Approval",this.adjustYourGoal="Adjust_Your_Goal",this.proceedToProgress="Proceed_To_Progress",this.teamMonthlyPlanFYFCTitle="Team_Monthly_Plan_FYFC_Title",this.completionRate="Completion_Rate",this.editPersonalPlanFYFCTitle="Edit_Personal_Plan_FYFC_Title",this.goalBeenReject="Goal_Been_Reject",this.goalBeenPend="Goal_Been_Pend",this.needToBeRecommentTitle="Need_To_Be_Recomment_Title",this.needToBeRecommentContent="Need_To_Be_Recomment_Content",this.workingExperience="Working_Experience",this.goalSettingStep1Title="Goal_Setting_Step1_Title",this.goalSettingStep2Title="Goal_Setting_Step2_Title",this.goalSettingStep3Title="Goal_Setting_Step3_Title",this.goalSettingStep4Title="Goal_Setting_Step4_Title",this.goalSettingStep5Title="Goal_Setting_Step5_Title",this.statusBarStep1="Status_Bar_Step1",this.statusBarStep2="Status_Bar_Step2",this.statusBarStep3="Status_Bar_Step3",this.statusBarStep4="Status_Bar_Step4",this.statusBarStep5="Status_Bar_Step5",this.FYFCAllYear="FYFC_All_Year",this.FYFCNowToYearEnd="FYFC_Now_To_Year_End",this.NowToYearEnd="Now_To_Year_End",this.yourGoal="Your_Goal",this.comment="Comment",this.findSubtitle="Find_Subtitle",this.scheduleSubtitle="Schedule_Subtitle",this.meetSubtitle="Meet_Subtitle",this.submitSubtitle="Submit_Subtitle",this.inforceSubtitle="Inforce_Subtitle",this.reject="Reject",this.approve="Approve",this.commitmentTeamGoalTitle="Commitment_Team_Goal_Title",this.CommitmentPlaceholder="Commitment_Placeholder",this.progressCongratulationsMessage="Progress_Congratulations_Message",this.month1="Month_1",this.month2="Month_2",this.month3="Month_3",this.month4="Month_4",this.month5="Month_5",this.month6="Month_6",this.month7="Month_7",this.month8="Month_8",this.month9="Month_9",this.month10="Month_10",this.month11="Month_11",this.month12="Month_12",this.times="Times",this.hi="Hi",this.go="Go",this.goalSettingExcel="Goal_Setting_Excel",this.setGoalThisYear="Set_Goal_This_Year",this.next="Next",this["case"]="Case",this.ok="Ok",this.skip="Skip",this.goalSettingCreateCustomer="Goal_Setting_Create_Customer",this.goalSettingCustomerJournal="Goal_Setting_Customer_Journal",this.goalSettingActivityType="Goal_Setting_Activity_Type",this.goalSettingFastQuotation="Goal_Setting_Fast_Quotation",this.submission="Submission",this.goalSettingInforcePolicy="Goal_Setting_Inforce_Policy",this.FYFCShortfall="FYFC_Shortfall",this.ANPActualVariable="ANP_Actual_Variable",this.ANPAllYear="ANP_All_Year",this.ANPNowToYearEnd="ANP_Now_To_Year_End",this.pendingApproval="Pending_Approval",this.dashboardMonth7="Dashboard_Month_7",this.points="Points",this.congratulationsMsg="Progress_Congratulations_Message",this.almostMadeItMsg="Progress_Almost_Made_It_Message",this.wellDoneMsg="Progress_Well_Done_Message",this.greatJobMsg="Progress_Great_Job_Message",this.quarter="Quarter",this.backToProgressBtnText="Back_To_Progress",this.goal="Goal",this.forecast="Forecast",this.shortfall="Shortfall",this.activitiesText="Activities",this.achieveText="Achieve",this.actualGoal="Actual_Goal",this.actualPlan="Actual_Plan",this.meetPresentText="Meet_Present",this.monthlyPlanFYFCTitleText="Monthly_Plan_FYFC_Title",this.totalForecastTitle="Total_Forecast",this.totalYTDActualTitle="Total_YTD_Actual",this.directUnitTitle="Direct_Unit_Title",this.indirectUnitTitle="Indirect_Unit_Title",this.agencyTitle="Agency_Title",this.allZoneTitle="All_Zone_Title",this.informationDescriptionText="Info_Information_Description",this.infoTitle="Info_Title",this.infoMonthDetailText="Info_Month_Detail",this.infoQuarterDetailText="Info_Quarter_Detail",this.infoYearDetailText="Info_Year_Detail",this.infoForecastRecruitmentDetailText="Info_Forecast_Recruitment_Detail",this.infoHowToReadThisTitle="Info_How_To_Read_This",this.infoConversionRateText="Info_Conversion_Rate",this.infoConversionRateDetailText="Info_Conversion_Rate_Detail",this.infoActivityLabelText="Info_Activity_Label",this.infoRedMeanText="Info_Red_Mean",this.infoGreyMeanText="Info_Grey_Mean",this.infoIfAnActivity1Text="Info_If_An_Activity_1",this.infoIfAnActivity2Text="Info_If_An_Activity_2",this.infoToFindText="Info_To_Find",this.infoTryTo1Text="Info_Try_To_1",this.infoTryTo2Text="Info_Try_To_2",this.infoTryTo3Text="Info_Try_To_3",this.infoMoreActive1Text="Info_More_Active_1",this.infoMoreActive2Text="Info_More_Active_2",this.infoMoreActive3Text="Info_More_Active_3",this.infoMoreActive4Text="Info_More_Active_4",this.infoTryHard1Text="Info_Try_Hard_1",this.infoTryHard2Text="Info_Try_Hard_2",this.infoTryHard3Text="Info_Try_Hard_3",this.infoHighQuality1Text="Info_High_Quality_1",this.infoHighQuality2Text="Info_High_Quality_2",this.infoAllAmountCountsByMillion="Info_All_Amount_Counts_By_Million",this.waitingApproval="Waiting_Approval",this.complete="Complete",this.needToGoalSettingTitle="Need_To_Goal_Setting_Title",this.goalAutoApproveMessageTitle="Goal_Auto_Approve_Message_Title",this.goalAutoApproveMessageDesc="Goal_Auto_Approve_Message_Desc",this.goalAutoApproveLeaderMessageTitle="Goal_Auto_Approve_Leader_Message_Title",this.goalAutoApproveLeaderMessageDesc="Goal_Auto_Approve_Leader_Message_Desc",this.approveGoalIsRejectTitle="Approve_Goal_Is_Reject_Title",this.approveGoalIsRejectBody="Approve_Goal_Is_Reject_Body",this.approveGoalIsApprovedTitle="Approve_Goal_Is_Approved_Title",this.approveGoalIsApprovedBody="Approve_Goal_Is_Approved_Body",this.pendingReviewTitle="Pending_Review_Title",this.supervisorHaveChangeAgentTitle="Supervisor_Have_Change_Agent_Title",this.supervisorHaveChangeAgentBody="Supervisor_Have_Change_Agent_Body",this.supervisorHaveChangeOldTitle="Supervisor_Have_Change_Old_Title",this.supervisorHaveChangeOldBody="Supervisor_Have_Change_Old_Body",this.supervisorHaveChangeNewTitle="Supervisor_Have_Change_New_Title",this.supervisorHaveChangeNewBody="Supervisor_Have_Change_New_Body",this.goalAutoRejectMessageTitle="Goal_Auto_Reject_Message_Title",this.goalAutoRejectMessageDescription="Goal_Auto_Reject_Message_Description",this.goalAutoRejectLeaderMessageTitle="Goal_Auto_Reject_Leader_Message_Title",this.goalAutoRejectLeaderMessageDescription="Goal_Auto_Reject_Leader_Message_Description",this.activityTenPointTitle="Activity_Ten_Point_Title",this.activityTenPointBody="Activity_Ten_Point_Body",this.activityTwentyPointTitle="Activity_Twenty_Point_Title",this.activityTwentyPointBody="Activity_Twenty_Point_Body",this.activityMiniPointTitle="Activity_Mini_Point_Title",this.activityMiniPointBody="Activity_Mini_Point_Body",this.customerOvertimeTitle="Customer_Overtime_Title",this.customerAutoDeleteTitle="Customer_Auto_Delete_Title",this.goalPeriodNotStartTitle="Goal_Period_Not_Start_Title",this.goalPeriodNotStartBody="Goal_Period_Not_Start_Body",this.adjustGoal="Adjust_Goal",this.seeProgress="See_Progress",this.IGotIt="I_Got_It",this.dataPrivacyProtectionTitle="Data_Privacy_Protection_Title",this.dataPrivacyProtectionBody="Data_Privacy_Protection_Body",this.pleaseReconnectInternet="Please_Reconnect_Internet",this.dataCollectionProcessAndUsageTitle="Data_Collection_Process_And_Usage_Title",this.dataCollectionProcessAndUsageBody="Data_Collection_Process_And_Usage_Body",this.versionMessage="Version_Message",this.timeOut="Time_Out",this.versionUpdate="Version_Update",this.later="Later",this.noWifiConnected="No_Wifi_Connected",this.pleaseConnectInternet="Please_Connect_Internet",this.deleteDataTitle="Delete_Data_Title",this.deleteDataBody="Delete_Data_Body",this.notShowMessage="Not_Show_Message",this.languageConversionTitle="Language_Conversion_Title",this.languageConversionBody="Language_Conversion_Body",this.customersUnit="Customers_Unit",this.casesUnit="Cases_Unit",this.todayScheduleBirthday="Today_Schedule_Birthday",this.yearUnit="Year_Unit",this.vertical="Vertical",this.horizonal="Horizonal",this.addProtection="Add_Protection",this.more="More",this.submitDeal="Submit_Deal",this.progressGoToCalendar="Progress_Go_To_Calendar",this.homeHi="Home_Hi",this.homeAppointmentDetails="Home_Appointment_Details",this.homeEdit="Home_Edit",this.homeDelete="Home_Delete",this.homeAppointment="Home_Appointment",this.homeSave="Home_Save",this.homeFYFC="Home_FYFC",this.homeANP="Home_ANP",this.homeConfirm="Home_Confirm",this.homePersonal="Home_Personal",this.homeTeam="Home_Team",this.homeDetails="Home_Details",this.homeToday="Home_Today",this.homeSchedule="Home_Schedule",this.homeBirthday="Home_Birthday",this.customerClear="Customer_Clear",this.customerAppointment="Customer_Appointment",this.customerContact="Customer_Contact",this.customerEdit="Customer_Edit",this.customerDelete="Customer_Delete",this.customerAdd="Customer_Add",this.addProfile="Add_Profile",this.customerSave="Customer_Save",this.customerConfirm="Customer_Confirm",this.customerDetail="Customer_Detail",this.unbindDevice="Unbind_Device",this.unbind="Unbind",this.settingSeeDetails="Setting_See_Details",this.goalSettingReset="Goal_Setting_Reset",this.goalSettingNext="Goal_Setting_Next",this.goalSettingSubmit="Goal_Setting_Submit",this.goalSettingFind="Goal_Setting_Find",this.goalSettingFindSubtitle="Goal_Setting_Find_Subtitle",this.goalSettingSchedule="Goal_Setting_Schedule",this.goalSettingScheduleSubtitle="Goal_Setting_Schedule_Subtitle",this.goalSettingMeetPresent="Goal_Setting_Meet_Present",this.goalSettingMeetPresentSubtitle="Goal_Setting_Meet_Present_Subtitle",this.goalSettingSubmitDeal="Goal_Setting_Submit_Deal",this.goalSettingSubmitDealSubtitle="Goal_Setting_Submit_Deal_Subtitle",this.goalSettingInforce="Goal_Setting_Inforce",this.goalSettingInforceSubtitle="Goal_Setting_Inforce_Subtitle",this.goalSettingDaily="Goal_Setting_Daily",this.goalSettingWeekly="Goal_Setting_Weekly",this.goalSettingMonthly="Goal_Setting_Monthly",this.goalSettingDay="Goal_Setting_Day",this.goalSettingWeek="Goal_Setting_Week",this.goalSettingMonth="Goal_Setting_Month",this.goalSettingActual="Goal_Setting_Actual",this.goalSettingFYFC="Goal_Setting_FYFC",this.goalSettingANP="Goal_Setting_ANP",this.goalSettingManpower="Goal_Setting_Manpower",this.goalSettingRecruitment="Goal_Setting_Recruitment",this.goalSettingPersonal="Goal_Setting_Personal",this.goalSettingTeam="Goal_Setting_Team",this.goalSettingClear="Goal_Setting_Clear",this.goalSettingSave="Goal_Setting_Save",this.goalSettingPlan="Goal_Setting_Plan",this.goalSettingSeeDetails="Goal_Setting_See_Details",this.goalSettingLandingHi="Goal_Setting_Landing_Hi",this.goalSettingCalendarJournal="Goal_Setting_Calendar_Journal",this.calendarFilter="Calendar_Filter",this.calendarActivity="Calendar_Activity",this.calendarCustomerName="Calendar_Customer_Name",this.calendarAppointmentDetails="Calendar_Appointment_Details",this.calendarEdit="Calendar_Edit",this.calendarDelete="Calendar_Delete",this.calendarAppointment="Calendar_Appointment",this.calendarSave="Calendar_Save",this.calendarDay="Calendar_Day",this.calendarWeek="Calendar_Week",this.calendarMonth="Calendar_Month",this.calendarYear="Calendar_Year",this.calendarToday="Calendar_Today",this.progressWeek="Progress_Week",this.progressToday="Progress_Today",this.progressPersonal="Progress_Personal",this.progressTeam="Progress_Team",this.progressMonth="Progress_Month",this.progressQuarter="Progress_Quarter",this.progressYear="Progress_Year",this.progressFYFC="Progress_FYFC",this.progressANP="Progress_ANP",this.progressFind="Progress_Find",this.progressFindSubtitle="Progress_Find_Subtitle",this.progressSchedule="Progress_Schedule",this.progressScheduleSubtitle="Progress_Schedule_Subtitle",this.progressMeetPresent="Progress_Meet_Present",this.progressMeetPresentSubtitle="Progress_Meet_Present_Subtitle",this.progressSubmitDeal="Progress_Submit_Deal",this.progressSubmitDealSubtitle="Progress_Submit_Deal_Subtitle",this.progressInforce="Progress_Inforce",this.progressInforceSubtitle="Progress_Inforce_Subtitle",this.progressPlan="Progress_Plan",this.progressActual="Progress_Actual",this.progressGoal="Progress_Goal",this.progressForecast="Progress_Forecast",this.progressShortfall="Progress_Shortfall",this.progressManpower="Progress_Manpower",this.progressRecruitment="Progress_Recruitment",this.progressCurrentMonth="Progress_Current_Month",this.progressCurrentQuarter="Progress_Current_Quarter",this.progressCurrentYear="Progress_Current_Year",this.progressForecastRecruitment="Progress_Forecast_Recruitment",this.progressClose="Progress_Close",this.progressSeeDetails="Progress_See_Details",this.progressDetail="Progress_Detail",this.settingYes="Setting_Yes",this.settingNo="Setting_No",this.detectScreenshotTitle="Detect_Screenshot_Title",this.detectScreenshotContent="Detect_Screenshot_Content",this.noContactPermissionTitle="No_Contact_Permission_Title",this.noContactPermissionContent="No_Contact_Permission_Content",this.submitFailTitle="Submit_Fail_Title",this.submitFailContent="Submit_Fail_Content",this.notificationSeeProgress="Notification_See_Progress",this.notificationSaveFeedback="Notification_Save_Feedback",this.notificationDeleteFeedback="Notification_Delete_Feedback",this.notificationCompleteFeedback="Notification_Complete_Feedback",this.goalPeriodNotStartOk="Goal_Period_Not_Start_Ok",this.goalPeriodIsBeginOk="Goal_Period_Is_Begin_Ok",this.needToGoalSettingAdjustGoal="Need_To_Goal_Setting_Adjust_Goal",this.goalAutoApproveAdjustGoal="Goal_Auto_Approve_Adjust_Goal",this.goalAutoApproveLeaderOk="Goal_Auto_Approve_Leader_Ok",this.approveGoalIsRejectAdjustGoal="Approve_Goal_Is_Reject_Adjust_Goal",this.approveGoalIsApprovedOk="Approve_Goal_Is_Approved_Ok",this.pendingReviewAgencyPlan="Pending_Review_Agency_Plan",this.supervisorHaveChangeAgentOk="Supervisor_Have_Change_Agent_Ok",this.supervisorHaveChangeOldOk="Supervisor_Have_Change_Old_Ok",this.supervisorHaveChangeNewAgencyPlan="Supervisor_Have_Change_New_Agency_Plan",this.goalAutoRejectAdjustGoal="Goal_Auto_Reject_Adjust_Goal",this.goalAutoRejectLeaderOk="Goal_Auto_Reject_Leader_Ok",this.dataPrivacyProtectionConfirm="Data_Privacy_Protection_Confirm",this.customerOvertimeConfirm="Customer_Overtime_Confirm",this.customerAutoDeleteConfirm="Customer_Auto_Delete_Confirm",this.noWifiConnectedOk="No_Wifi_Connected_Ok",this.versionUpdateYes="Version_Update_Yes",this.versionUpdateLater="Version_Update_Later",this.timeOutOk="Time_Out_Ok",this.dataCollectionProcessAndUsageReject="Data_Collection_Process_And_Usage_Reject",this.dataCollectionProcessAndUsageConfirm="Data_Collection_Process_And_Usage_Confirm",this.detectScreenshotOk="Detect_Screenshot_Ok",this.submitFailOk="Submit_Fail_Ok",this.noContactPermissionOk="No_Contact_Permission_Ok",this.httpErrorOk="HTTP_Error_Ok"},Gt=function(){function e(e,t,n){this.errorHandler=e,this.DaoFactory=t,this.registerDataSyncFunc=n}return e.prototype.doTask=function(){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.createTable()];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.warn("cannot run datasync!"),this.errorHandler.handleError(t),[3,3];case 3:return[2]}})})},e.prototype.refreshSchema=function(){return I(this,void 0,void 0,function(){return z(this,function(e){switch(e.label){case 0:return[4,this.DaoFactory.refreshTableSchema()];case 1:return e.sent(),[2]}})})},e.prototype.createTable=function(){return I(this,void 0,void 0,function(){var t,n,o;return z(this,function(e){switch(e.label){case 0:return console.log("create table task"),[4,(t=this.DaoFactory).init()];case 1:return e.sent(),console.log("factory init finish!"),n=t.getDao("Profile"),o=t.getDefaultDao(),n&&o?[4,Promise.all([this.runSql(n,this.createProfileTableCommand()),this.runSql(o,this.createMainTableCommand())])]:[3,4];case 2:return e.sent(),[4,t.refreshTableSchema()];case 3:e.sent(),e.label=4;case 4:return[2]}})})},e.prototype.runSql=function(n,e){var t,o,r=[];try{for(var i=$(e),a=i.next();!a.done;a=i.next()){var s=a.value;r.push(new Ct(s,[]))}}catch(c){t={error:c}}finally{try{a&&!a.done&&(o=i["return"])&&o.call(i)}finally{if(t)throw t.error}}return new Promise(function(t,e){n.excuteSqlCommand(r).subscribe(function(e){console.log("create table res:",e),t()})})},e.prototype.createProfileTableCommand=function(){var e=[];return e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Code (TypeID TEXT,Code TEXT,MappingID TEXT,Orders INT NOT NULL,Arguments TEXT,ValidityPeriod INT NOT NULL,PRIMARY KEY (TypeID, Code, MappingID));"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_DeviceInfo (Category TEXT PRIMARY KEY,CategoryVal TEXT NOT NULL,UpdateTime NUMBER NOT NULL);"),e.push("INSERT OR IGNORE INTO TW_LH_SD_DeviceInfo VALUES ('OfflineLoginFailCount','{\"count\":0}',1553855173876);"),e.push("INSERT OR IGNORE INTO TW_LH_SD_DeviceInfo VALUES ('OfflineValidationToken','{\"token\":\"\"}',1553855173876);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_DataSync_Time (FuncID TEXT PRIMARY KEY,BackendTime INT,FrontendTime INT,LastUpdate INT);"),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('MESSAGE',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('YEAR_CONFIG',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('AGENCY_PLAN',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('GOAL',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('ACTUAL',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('CUSTOMER',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('CUSTOMER_CONTACT',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('CALENDAR',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('PROGRESS',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('GOAL_EXPECTED',0,0,1); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Time VALUES ('PROFILE_CODE',0,0,1); "),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_DataSync_Function (FuncID TEXT PRIMARY KEY,MainFunc TEXT NOT NULL);"),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('MESSAGE','Homepage'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('GOAL','Goal_Setting'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('YEAR_CONFIG','Goal_Setting'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('AGENCY_PLAN','Goal_Setting'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('ACTUAL','Goal_Setting'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('GOAL_EXPECTED','Goal_Setting'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('CUSTOMER','Customer'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('CUSTOMER_CONTACT','Customer'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('CALENDAR','Calendar'); "),e.push("INSERT OR IGNORE INTO TW_LH_SD_DataSync_Function VALUES ('PROGRESS','Progress'); "),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_FuncSync_Time AS SELECT * FROM TW_LH_SD_DataSync_Function LEFT JOIN TW_LH_SD_DataSync_Time ON TW_LH_SD_DataSync_Function.FuncID = TW_LH_SD_DataSync_Time.FuncID GROUP BY TW_LH_SD_DataSync_Function.MainFunc;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Language (LanguageID TEXT PRIMARY KEY,Name TEXT,IsDefault TEXT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Error_Log (ErrorID TEXT PRIMARY KEY, Message TEXT, Time NUMBER, Stack TEXT, DeviceModel TEXT, DeviceSystem TEXT, IsSend TEXT)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Action_Log (ActionID TEXT PRIMARY KEY, Action TEXT, Function TEXT, Time NUMBER, Valid TEXT, Message TEXT, DeviceModel TEXT, DeviceSystem TEXT, IsSend TEXT)"),e},e.prototype.createMainTableCommand=function(){var e=[];return e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Calendar_Extension (ClientID TEXT PRIMARY KEY,CalendarID INT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Calendar (ClientID TEXT PRIMARY KEY,CalendarID INT,CustomerClientID TEXT,Title TEXT NOT NULL,Location TEXT,CalendarType TEXT NOT NULL,IsAllDay TEXT NOT NULL,StartTime INT NOT NULL,EndTime INT NOT NULL,IsAlert TEXT NOT NULL,Alert1 TEXT,Alert2 TEXT,Alert3 TEXT,Remark TEXT,DataSource TEXT NOT NULL,ClientTime INT NOT NULL,IsDelete TEXT NOT NULL,DataTime INT DEFAULT NULL);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Address_Extension (ClientID TEXT PRIMARY KEY,CustomerClientID INT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Email_Extension (ClientID TEXT PRIMARY KEY,CustomerClientID INT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Tel_Extension (ClientID TEXT PRIMARY KEY,CustomerClientID INT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Contact_Extension (ClientID TEXT PRIMARY KEY,CustomerClientID INT,ContactID INT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Extension (ClientID TEXT PRIMARY KEY,CustomerID INT,RecentStatus TEXT,MANPA TEXT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Address (ClientID TEXT PRIMARY KEY,CustomerClientID TEXT NOT NULL,AddressType TEXT,Country TEXT , City TEXT,Area TEXT,Zipcode TEXT,Address TEXT,DataSource TEXT NOT NULL);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Email (ClientID TEXT PRIMARY KEY,CustomerClientID TEXT NOT NULL,EmailType TEXT,Email TEXT,DataSource TEXT NOT NULL);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Tel (ClientID TEXT PRIMARY KEY,CustomerClientID TEXT NOT NULL,TelType TEXT,Tel TEXT,DataSource TEXT NOT NULL);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer_Contact (ClientID TEXT PRIMARY KEY,CustomerClientID TEXT NOT NULL,ContactID INT,Note TEXT NOT NULL,NoteTime INT NOT NULL,DataTime INT,ClientTime INT NOT NULL,IsDelete TEXT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Customer (ClientID TEXT PRIMARY KEY,CustomerID INT,FirstName TEXT,LastName TEXT,Occupation TEXT,Company TEXT,BirthdayYear TEXT,BirthdayMonth TEXT,BirthdayDate TEXT,Age INT,AgeRange TEXT,Gender TEXT,Income TEXT,Source TEXT,Marriage TEXT,Children TEXT,Familiarity TEXT,ContactFrequancy TEXT,Possibility TEXT,IsFollow TEXT NOT NULL,DataTime INT,DataTimeBackend INT,DataSource TEXT,ClientTime INT NOT NULL,PartId INT,IsDelete TEXT,Completeness INT NOT NULL,IsOverTimeAlert TEXT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Personal_Setting (SettingID TEXT PRIMARY KEY,SettingName TEXT NOT NULL , SettingVal Text NOT NULL);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Customer AS SELECT * FROM TW_LH_SD_Customer LEFT JOIN TW_LH_SD_Customer_Extension ON TW_LH_SD_Customer.ClientID = TW_LH_SD_Customer_Extension.ClientID;"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Calendar AS SELECT * FROM TW_LH_SD_Calendar LEFT JOIN TW_LH_SD_Calendar_Extension ON TW_LH_SD_Calendar.ClientID = TW_LH_SD_Calendar_Extension.ClientID;"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Customer_Contact AS SELECT * FROM TW_LH_SD_Customer_Contact LEFT JOIN TW_LH_SD_Customer_Contact_Extension ON TW_LH_SD_Customer_Contact.ClientID = TW_LH_SD_Customer_Contact_Extension.ClientID;"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Customer_Address AS SELECT * FROM TW_LH_SD_Customer_Address LEFT JOIN TW_LH_SD_Customer_Address_Extension ON TW_LH_SD_Customer_Address.ClientID = TW_LH_SD_Customer_Address_Extension.ClientID;"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Customer_Tel AS SELECT * FROM TW_LH_SD_Customer_Tel LEFT JOIN TW_LH_SD_Customer_Tel_Extension ON TW_LH_SD_Customer_Tel.ClientID = TW_LH_SD_Customer_Tel_Extension.ClientID;"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Customer_Email AS SELECT * FROM TW_LH_SD_Customer_Email LEFT JOIN TW_LH_SD_Customer_Email_Extension ON TW_LH_SD_Customer_Email.ClientID = TW_LH_SD_Customer_Email_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Message (ClientID TEXT NOT NULL PRIMARY KEY, MessageID INT NOT NULL , MessageCategory TEXT NOT NULL, MessageType TEXT NOT NULL, Title TEXT NOT NULL, Description TEXT, Arguments TEXT, Status TEXT NOT NULL, IsClick TEXT NOT NULL, IsPopup TEXT NOT NULL, IsShow TEXT NOT NULL, LinkStatus TEXT NOT NULL, MessageTime INT NOT NULL, Extensions TEXT, IsDelete TEXT NOT NULL, ClientTime INT NOT NULL, DataTime INT);"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Message_Extension (ClientID TEXT NOT NULL PRIMARY KEY, MessageID INT NOT NULL);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Message AS SELECT * FROM TW_LH_SD_Message LEFT JOIN TW_LH_SD_Message_Extension ON TW_LH_SD_Message.ClientID = TW_LH_SD_Message_Extension.ClientID;"),e.push("INSERT OR IGNORE INTO TW_LH_SD_Personal_Setting (SettingID ,SettingName,SettingVal) VALUES ('CustomerFilterSetting','客戶Filter預設條件','{}')"),e.push("INSERT OR IGNORE INTO TW_LH_SD_Personal_Setting (SettingID ,SettingName,SettingVal) VALUES ('CalendarFilterSetting','日曆Filter預設條件','{}')"),e.push("INSERT OR IGNORE INTO TW_LH_SD_Personal_Setting (SettingID ,SettingName,SettingVal) VALUES ('FontSizeSetting','字體大小預設條件','{}')"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Year_Config (ClientID TEXT PRIMARY KEY, DataYear INTEGER, IsCurrent TEXT, PerformanceSettlementMonth INTEGER, WorkingQuarter INTEGER, WorkingMonth INTEGER, QuarterStartMonth INTEGER, QuarterEndMonth INTEGER, InitialPreCaseFyfc INTEGER, FyfcCovertAnpRate REAL, InforceConvertFindRate REAL, InforceConvertScheduleRate REAL, InforceConvertMeetRate REAL, InforceConvertSubmitRate REAL, ProgressDayPointsLimit INTEGER, InforceConvertPointBase REAL, FindConvertPointBase REAL, ScheduleConvertPointBase REAL, MeetConvertPointBase REAL, SubmitConvertPointBase REAL, GoalSettingActivityProcMode TEXT, ProgressBarControlMode TEXT, GoalAndPlanDifferenceLimit REAL, NowToYearEndDays INTEGER, MonthQuantityOfYear INTEGER)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Year_Config_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Year_Config AS SELECT * FROM TW_LH_SD_Year_Config LEFT JOIN TW_LH_SD_Year_Config_Extension ON TW_LH_SD_Year_Config.ClientID = TW_LH_SD_Year_Config_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Goal_Setting (ClientID TEXT PRIMARY KEY, DataYear INTEGER, IsNeedSetting TEXT, IsFirstTime TEXT, ApproveStatus TEXT, Remainingdays INTEGER, GoalSetMonth INTEGER, PersonnelGoalApplicableYM INTEGER, TeamGoalApplicableYM INTEGER, SupervisorComment TEXT)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Goal_Setting_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Goal_Setting AS SELECT * FROM TW_LH_SD_Goal_Setting LEFT JOIN TW_LH_SD_Goal_Setting_Extension ON TW_LH_SD_Goal_Setting.ClientID = TW_LH_SD_Goal_Setting_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Goal_Setting_Value (ClientID TEXT PRIMARY KEY, DataYear INTEGER, DataType TEXT, Value TEXT)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Goal_Setting_Plan_Value (ClientID TEXT PRIMARY KEY, DataYear INTEGER, PerformanceType TEXT, Month INTEGER, Value INTEGER)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Goal_Setting_Plan_Value_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Goal_Setting_Plan_Value AS SELECT * FROM TW_LH_SD_Goal_Setting_Plan_Value LEFT JOIN TW_LH_SD_Goal_Setting_Plan_Value_Extension ON TW_LH_SD_Goal_Setting_Plan_Value.ClientID = TW_LH_SD_Goal_Setting_Plan_Value_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Goal_Setting_Expected (ClientID TEXT PRIMARY KEY, DataYear INTEGER, Q1 INTEGER, Q2 INTEGER, Q3 INTEGER, Q4 INTEGER, FYFC INTEGER, ANP INTEGER, ClientTime INTEGER, DataTime INTEGER)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Goal_Setting_Expected_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Goal_Setting_Expected AS SELECT * FROM TW_LH_SD_Goal_Setting_Expected LEFT JOIN TW_LH_SD_Goal_Setting_Expected_Extension ON TW_LH_SD_Goal_Setting_Expected.ClientID = TW_LH_SD_Goal_Setting_Expected_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Actual_Value (ClientID TEXT PRIMARY KEY, DataYear INTEGER, PerformanceType TEXT, DataType TEXT, Month INTEGER, Value REAL)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Actual_Value_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Actual_Value AS SELECT * FROM TW_LH_SD_Actual_Value LEFT JOIN TW_LH_SD_Actual_Value_Extension ON TW_LH_SD_Actual_Value.ClientID = TW_LH_SD_Actual_Value_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Agency_Plan_Main (ClientID TEXT PRIMARY KEY, DataYear INTEGER , DataType TEXT, Forecast INTEGER, Actual INTEGER, MonthPlan INTEGER)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Agency_Plan_Main_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Agency_Plan_Main AS SELECT * FROM TW_LH_SD_Agency_Plan_Main LEFT JOIN TW_LH_SD_Agency_Plan_Main_Extension ON TW_LH_SD_Agency_Plan_Main.ClientID = TW_LH_SD_Agency_Plan_Main_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Agency_Detail_Data (ClientID TEXT PRIMARY KEY, DataYear INTEGER, DirectUnitType TEXT, DataType TEXT, AgentID TEXT, AgentName TEXT, JobGrade TEXT, IsApprove TEXT, Drilldown TEXT, AppUseMode TEXT,Goal INTEGER, Forecast INTEGER, Actual REAL, MonthPlan INTEGER, Manpower INTEGER, Recruitment INTEGER, CaseCount INTEGER, PerCase INTEGER, Orders INTEGER)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Agency_Detail_Data_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Agency_Detail_Data AS SELECT * FROM TW_LH_SD_Agency_Detail_Data LEFT JOIN TW_LH_SD_Agency_Detail_Data_Extension ON TW_LH_SD_Agency_Detail_Data.ClientID = TW_LH_SD_Agency_Detail_Data_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Personal_Progress (ClientID TEXT PRIMARY KEY, DataYear INTEGER, TimeBase TEXT, DataType TEXT, Find INTEGER, Schedule INTEGER, Meet INTEGER, Submit INTEGER, Inforce INTEGER, FYFC INTEGER)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Personal_Progress_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Personal_Progress AS SELECT * FROM TW_LH_SD_Personal_Progress LEFT JOIN TW_LH_SD_Personal_Progress_Extension ON TW_LH_SD_Personal_Progress.ClientID = TW_LH_SD_Personal_Progress_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Team_Progress_Main (ClientID TEXT PRIMARY KEY, DataYear INTEGER, TimeBase TEXT, DataType TEXT, Goal INTEGER, Forecast INTEGER, Actual INTEGER, Shortfall INTEGER)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Team_Progress_Main_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Team_Progress_Main AS SELECT * FROM TW_LH_SD_Team_Progress_Main LEFT JOIN TW_LH_SD_Team_Progress_Main_Extension ON TW_LH_SD_Team_Progress_Main.ClientID = TW_LH_SD_Team_Progress_Main_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Team_Progress_Detail (ClientID TEXT PRIMARY KEY, DataYear INTEGER, TimeBase TEXT, DirectUnitType TEXT, AgentID TEXT, AgentName TEXT, JobGrade TEXT, TeamName TEXT, Drilldown TEXT, AppUseMode TEXT, DataType TEXT, Activities TEXT, Goal INTEGER, Forecast INTEGER, Actual INTEGER, Shortfall INTEGER, Orders INTEGER)"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Team_Progress_Detail_Extension (ClientID TEXT PRIMARY KEY);"),e.push("CREATE VIEW IF NOT EXISTS TW_LH_SD_VW_Team_Progress_Detail AS SELECT * FROM TW_LH_SD_Team_Progress_Detail LEFT JOIN TW_LH_SD_Team_Progress_Detail_Extension ON TW_LH_SD_Team_Progress_Detail.ClientID = TW_LH_SD_Team_Progress_Detail_Extension.ClientID;"),e.push("CREATE TABLE IF NOT EXISTS TW_LH_SD_Other_Parameter (ClientID TEXT PRIMARY KEY, DataYear INTEGER , MappingID TEXT, SetValue TEXT)"),e},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.ErrorHandler},{type:Nt},{type:undefined,decorators:[{type:u.Inject,args:[N]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.ErrorHandler),u.inject(Nt),u.inject(N))},token:e,providedIn:"root"}),e}(),xt=function(){function e(e,t,n){this._settingID=e,this._settingName=t,this._settingVal=n}return Object.defineProperty(e.prototype,"SettingID",{get:function(){return this._settingID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SettingName",{get:function(){return this._settingName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SettingVal",{get:function(){return this._settingVal},enumerable:!0,configurable:!0}),e}(),Wt=function(){function e(e){this.restrictions=e}return e.prototype.sqlString=function(){var n="";return this.restrictions.forEach(function(e,t){0!=t&&(n+=" AND "),n+=""+e.sqlString()}),"("+n+")"},e.prototype.getValues=function(){var o=new Array;return this.restrictions.forEach(function(e,t){var n=e.getValues();o=o.concat(n)}),o},e}(),Bt=function(){function e(e,t){void 0===t&&(t=[]),this.column=e,this.values=t}return e.prototype.sqlString=function(){return this.column+" = ? "},e.prototype.getValues=function(){return this.values},e}(),Ut=function(){function e(e,t){void 0===t&&(t=[]),this.column=e,this.values=t}return e.prototype.sqlString=function(){return this.column+" >= ? "},e.prototype.getValues=function(){return this.values},e}(),Yt=function(){function e(e,t){void 0===t&&(t=[]),this.column=e,this.values=t}return e.prototype.sqlString=function(){return this.column+" > ? "},e.prototype.getValues=function(){return this.values},e}(),qt=function(){function e(e,t){void 0===t&&(t=[]),this.column=e,this.values=t}return e.prototype.sqlString=function(){var e=Array(this.values.length).fill("?").join(",");return this.column+" IN ("+e+") "},e.prototype.getValues=function(){return this.values},e}(),Xt=function(){function e(e,t){void 0===t&&(t=[]),this.column=e,this.values=t}return e.prototype.sqlString=function(){return this.column+" <= ? "},e.prototype.getValues=function(){return this.values},e}(),Jt=function(){function e(e,t){void 0===t&&(t=[]),this.column=e;var n=[];t.forEach(function(e){n.push("%"+e+"%")}),this.values=n}return e.prototype.sqlString=function(){return this.column+" LIKE ? "},e.prototype.getValues=function(){return this.values},e}(),Qt=function(){function e(e,t){void 0===t&&(t=[]),this.column=e,this.values=t}return e.prototype.sqlString=function(){return this.column+" IS NOT NULL "},e.prototype.getValues=function(){return this.values},e}(),Kt=function(){function e(e,t){void 0===t&&(t=[]),this.column=e,this.values=t}return e.prototype.sqlString=function(){return this.column+" IS NULL "},e.prototype.getValues=function(){return this.values},e}(),zt=function(){function e(e){this.restrictions=e}return e.prototype.sqlString=function(){var n="";return this.restrictions.forEach(function(e,t){0!=t&&(n+=" OR "),n+=""+e.sqlString()}),"("+n+")"},e.prototype.getValues=function(){var o=new Array;return this.restrictions.forEach(function(e,t){var n=e.getValues();o=o.concat(n)}),o},e}(),$t=function(){function a(e){this.injector=e,this._debugMode=!1,this._debugSubject=new L.BehaviorSubject(this._debugMode)}return a.prototype._fetchCodeData=function(){var e=this.getAPIFactory(),t=this.getAPIDispatch(),n=e.getAPI("getSetting");return console.debug("setting.service fetchCodeData",n),L.Observable.create(function(i){t.dispatch(n).subscribe(function(e){var t=e.Body;console.log("<--- Datas ---\x3e"),console.log(e);for(var n=0;n<t.length;n++){var o=t[n],r=new xt(o.SettingID,o.SettingName,o.SettingVal);a.settingMap.set(r.SettingID,r)}console.debug("profileCodeMap",a.settingMap),i.next(!0),i.complete()})})},a.prototype.getSetting=function(e){return a.settingMap.get(e)},a.prototype.updateSetting=function(e){var o=this,t=this.getAPIFactory().getAPI("updateSetting");return t.setSettingObject(e),L.Observable.create(function(n){o.getAPIDispatch().dispatch(t).subscribe(function(t){o._fetchCodeData().subscribe(function(e){console.warn("_fetchCodeData",e),n.next(t.Header),n.complete()})})})},a.prototype.setDebugMode=function(e){this._debugMode=e,this._debugSubject.next(e)},a.prototype.getDebugMode=function(){return this._debugSubject.asObservable()},a.prototype.getAPIFactory=function(){return this.injector.get(p)},a.prototype.getAPIDispatch=function(){return this.injector.get(nt)},a.prototype.getDeviceService=function(){return this.injector.get(We)},a.prototype.deviceChange=function(i){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return console.log("device change firebase token:",i),t=this.getAPIFactory().getAPI("UpdatePushID"),n=this.getDeviceService(),t?(o={PushId:i,DeviceSystem:n.getDevicePlatform(),DeviceId:n.getDeviceUUID(),DeviceModel:n.getDeviceManufacturer(),DeviceType:n.isPad()?"Pad":"Phone"},t.body=o,[4,this.getAPIDispatch().dispatch(t).toPromise()]):[3,2];case 1:r=e.sent(),console.log("Update PushID resp:",r),e.label=2;case 2:return[2]}})})},a.settingMap=new Map,a.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],a.ctorParameters=function(){return[{type:u.Injector}]},a.ngInjectableDef=u.defineInjectable({factory:function(){return new a(u.inject(u.INJECTOR))},token:a,providedIn:"root"}),a}(),Zt=function(){function e(e){var t=e.date,n=e.action;this._viewDate=t,this._action=n}return Object.defineProperty(e.prototype,"viewDate",{get:function(){return this._viewDate},set:function(e){this._viewDate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this._action},set:function(e){this._action=e},enumerable:!0,configurable:!0}),e}(),en={CLICK:0,SWIPE:1};en[en.CLICK]="CLICK",en[en.SWIPE]="SWIPE";var tn=function(){function e(e,t,n,o){this.isCheck=!1,this.TypeID=e,this.Code=t,this.MappingID=n,this.Arguments=o}return e.prototype.setDisplayText=function(e){this.displayText=e},e.prototype.getCode=function(){return this.Code},e.prototype.getTypeId=function(){return this.TypeID},e.prototype.getMappingID=function(){return this.MappingID},e.prototype.getArguments=function(){return this.Arguments},e}(),nn=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t=""),this._path=e,this._version=t}return Object.defineProperty(e.prototype,"path",{get:function(){return this._path},set:function(e){this._path=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},set:function(e){this._version=e},enumerable:!0,configurable:!0}),e}(),on=function(){function e(e,t){this.value=e,this.name=t}return e.prototype.setIsDefault=function(e){return this.isDefault=e,this},e.prototype.getName=function(){return this.name},e.prototype.getValue=function(){return this.value},e.prototype.setName=function(e){this.name=e},e.prototype.setValue=function(e){this.value=e},e}(),rn=function(){function e(e){this._isSuccess=e}return Object.defineProperty(e.prototype,"isSuccess",{get:function(){return this._isSuccess},set:function(e){this._isSuccess=e},enumerable:!0,configurable:!0}),e}(),an=function(){function e(e,t){this._Key=e,this._Value=t}return Object.defineProperty(e.prototype,"Value",{get:function(){return this._Value},set:function(e){this._Value=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Key",{get:function(){return this._Key},set:function(e){this._Key=e},enumerable:!0,configurable:!0}),e}(),sn=function Zo(e,t,n){this.Extensions=[],this.SubmitInfo=e,this.GoalValue=t,this.GoalPlan=n},cn=function er(){this.Values=[]},un=function tr(e,t,n,o){this.Extensions=[],this.PerformanceType=e,this.Month=t,this.Value=n,this.Extensions=o},ln=function nr(e,t,n){this.Extensions=[],this.DataType=e,this.Value=t,this.Extensions=n},hn=function or(){this.Extensions=[]},pn=function(){function e(e,t,n,o,r,i,a,s,c,u){this.translateService=e,this.deviceService=t,this.settingService=n,this.appRouter=o,this.notificationMgr=r,this.APP_CONFIG=i,this.fetchSettingFinish=a,this.changeFontSize=s,this.fontSizeAccess=c,this.checkPermissionService=u}return e.prototype.doTask=function(){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return console.log("do task"),t=this,document.addEventListener("deviceready",function(){t.deviceService.initDeviceAPI(),cordova.plugins.AndroidFontSize&&cordova.plugins.AndroidFontSize.removeSystemFontSize(),"Android"==t.deviceService.getDevicePlatform()?document.addEventListener("screenshotDetect",function(){alert("Screenshot")},!1):"iOS"==t.deviceService.getDevicePlatform()&&document.addEventListener("screenshot",function(){t.notificationMgr.pushNotification(Ye.ScreenShotAlert,{})},!1)},!1),this.integrationCheck(),this.checkPermissionService.init(),this.appRouter.init(),[4,Promise.all([this.fetchLanguage(),this.fetchLanguageList(),this.fetchSetting(),this.loadLanguageFile()])];case 1:return e.sent(),[2]}})})},e.prototype.fetchLanguage=function(){var n=this;return console.log("fetch language func"),new Promise(function(t,e){n.translateService._fetchCurrentLanguage().subscribe(function(e){console.log("_fetchCurrentLanguage resp:",e),t(e)})})},e.prototype.fetchLanguageList=function(){var n=this;return console.log("fetch language List"),new Promise(function(t,e){n.translateService._fetchCodeData().subscribe(function(e){t(e)})})},e.prototype.integrationCheck=function(){var t=this;try{if(this.APP_CONFIG.APP_MODE===pt.Integration){var e=["SNDToken","SNDLanguage"].filter(function(e){return!t.deviceService.getLocalStorage(e)}).map(function(e){return"Integration mode failed: "+e+" not found in localstorage. Please set "+e+" into localstorage before switch to S&D."});if(0<e.length)throw new Error(e[0])}}catch(n){throw alert("Integration failed. Please check console for more details."),new D("F00704",n.message)}},e.prototype.fetchSetting=function(){var n=this;return console.debug("fetch setting"),new Promise(function(t,e){n.settingService._fetchCodeData().subscribe(function(e){n.changeFontSize&&n.fontSizeAccess&&n.fontSizeAccess.getFontSize().subscribe(function(e){n.changeFontSize.updateFontSize(e)}),n.fetchSettingFinish&&n.fetchSettingFinish.fetchSettingFinish(e),t(e)})})},e.prototype.loadLanguageFile=function(){return I(this,void 0,void 0,function(){return z(this,function(e){switch(e.label){case 0:return[4,this.translateService.init()];case 1:return e.sent(),[2]}})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:rt},{type:We},{type:$t},{type:ht},{type:Qe},{type:undefined,decorators:[{type:u.Inject,args:[_]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[b]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[q]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[Y]}]},{type:dt}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(rt),u.inject(We),u.inject($t),u.inject(ht),u.inject(Qe),u.inject(_),u.inject(b,8),u.inject(q,8),u.inject(Y,8),u.inject(dt))},token:e,providedIn:"root"}),e}(),fn=function(){function e(e,t,n,o){this.deviceService=e,this.errorHandler=t,this.customCheckRoot=n,this.networkChange=o}return e.prototype.doTask=function(){var o=this;return console.log("do device task"),new Promise(function(t,e){console.log("has inject custom root:",o.customCheckRoot);try{o.customCheckRoot?o.customCheckRoot.checkRoot().then(function(e){e&&o.customCheckRoot.rootedAction(),t()}):o.deviceService.checkIfRoot().then(function(e){console.log("check root resp:",e),e&&(alert("device has rooted!"),o.deviceService.exitApp()),t()},function(e){console.warn(e)}),L.fromEvent(document,"online").pipe().subscribe(function(){o.networkChange.change("online",!0)}),L.fromEvent(document,"offline").pipe().subscribe(function(){o.networkChange.change("offline",!0)})}catch(n){console.warn("cannot detect rooted device."),o.errorHandler.handleError(n),t()}})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:We},{type:u.ErrorHandler},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[G]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[U]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(We),u.inject(u.ErrorHandler),u.inject(G,8),u.inject(U,8))},token:e,providedIn:"root"}),e}(),gn=function(){function e(e){this._DaoFactory=e}return e.prototype.getAPIName=function(){return"getProfileCode"},e.prototype.getMockPath=function(){return"./assets/mock/getCode.json"},e.prototype.executeSQL=function(){var o=this;return L.Observable.create(function(t){var e=o._DaoFactory.getTable("Profile","TW_LH_SD_Code"),n=o._DaoFactory.getDao("Profile");e!=undefined?(e.addRestriction(new Ut("ValidityPeriod",[Date.now()])),n.queryByTable(e).subscribe(function(e){t.next(e),t.complete()})):(t.next(!1),t.complete())})},e}(),dn=function(){function e(e){this._DaoFactory=e}return e.prototype.getAPIName=function(){return"getSetting"},e.prototype.getMockPath=function(){return"./assets/mock/getPersonalSetting.json"},e.prototype.executeSQL=function(){var o=this;return L.Observable.create(function(t){var e=o._DaoFactory.getDefaultTable("TW_LH_SD_Personal_Setting"),n=o._DaoFactory.getDefaultDao();e!=undefined&&n!=undefined?(e=e,(n=new Ft(n)).queryByTable(e).subscribe(function(e){t.next(e),t.complete()})):(t.next(!1),t.complete())})},e}(),_n=function(){function e(){}return e.prototype.getAPIName=function(){return"getExtensionConfig"},e.prototype.getMockPath=function(){return"./assets/config/extension-config.json"},e}(),yn=function(){function e(e,t){this.daoFactory=e,this.APP_CONFIG=t,this.token="",this.failTry=null}return e.prototype.getAPIName=function(){return"offlineAuth"},e.prototype.executeSQL=function(){return L.from(this._offlineAuth())},e.prototype._offlineAuth=function(){return I(this,void 0,void 0,function(){var t,n,o,r,i,a,s,c,u,l,h,p;return z(this,function(e){switch(e.label){case 0:return t=this.APP_CONFIG.ENV,this.failTry=this.APP_CONFIG[t].OFFLINE_LOGIN_MAX_TIMES||999,n=null,o=this.daoFactory.getTable("Profile","TW_LH_SD_DeviceInfo"),[4,(r=this.daoFactory.getDao("Profile")).queryByTable(o).toPromise()];case 1:return i=e.sent(),console.log("query device info resp:",i),a=i.Body,s=parseInt(a.filter(function(e){return"OfflineLoginFailCount"==e.Category}).map(function(e){return JSON.parse(e.CategoryVal).count})[0]),c=a.filter(function(e){return"OfflineValidationToken"==e.Category}).map(function(e){return JSON.parse(e.CategoryVal).token})[0],u=a.filter(function(e){return"OfflineValidationToken"==e.Category}).map(function(e){return JSON.parse(e.CategoryVal).infoToken})[0],l=a.filter(function(e){return"OfflineValidationToken"==e.Category}).map(function(e){return e.UpdateTime})[0],console.group("offline auth:"),console.log("failCount:",s),console.log("offline_token:",c),console.log("this.token:",this.token),console.log("lastLoginTime:",l),console.groupEnd(),""==c||864e5<=Date.now()-l?(n={isSuccess:!1,message:"First_Login_Must_Online"},[3,7]):[3,2];case 2:return s>=this.failTry?(n={isSuccess:!1,message:"Wrong_Counts_Over_Max",failCount:-1},[3,7]):[3,3];case 3:return console.log("offline fail count:",s),this.token!==c?[3,5]:(o.setValue("CategoryVal",'{"count":0}'),o.addRestriction(new Bt("Category",["OfflineLoginFailCount"])),[4,r.updateByTable(o).toPromise()]);case 4:return p=e.sent(),console.log("set count to zero resp:",p),n={isSuccess:!0,token:u},[3,7];case 5:return h=s+1,o.setValue("CategoryVal",'{"count":'+h+"}"),o.addRestriction(new Bt("Category",["OfflineLoginFailCount"])),[4,r.updateByTable(o).toPromise()];case 6:p=e.sent(),console.log("plus one count:",p),n={isSuccess:!1,message:"Offline_Login_Locked",failCount:h},e.label=7;case 7:return[2,n]}})})},e}(),Tn=function(){function e(e){this.daoFactory=e,this._encryptedAuth="",this._infoToken=""}return Object.defineProperty(e.prototype,"infoToken",{get:function(){return this._infoToken},set:function(e){this._infoToken=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"encryptedAuth",{get:function(){return this._encryptedAuth},set:function(e){this._encryptedAuth=e},enumerable:!0,configurable:!0}),e.prototype.getAPIName=function(){return"saveLoginToken"},e.prototype.executeSQL=function(){var o=this,e=this.daoFactory.getTable("Profile","TW_LH_SD_DeviceInfo");console.log("infoObj:",e);var r=this.daoFactory.getDao("Profile"),t=JSON.stringify({token:this.encryptedAuth,infoToken:this._infoToken});return e!=undefined?L.Observable.create(function(n){e.setValue("CategoryVal",t),e.setValue("UpdateTime",Date.now()),e.addRestriction(new Bt("Category",["OfflineValidationToken"])),r.updateByTable(e).subscribe(function(e){console.log("save token resp:",e);var t=o.daoFactory.getTable("Profile","TW_LH_SD_DeviceInfo");t.setValue("CategoryVal",'{"count":0}'),t.addRestriction(new Bt("Category",["OfflineLoginFailCount"])),r.updateByTable(t).subscribe(function(e){n.next(e),n.complete()})})}):L.of(!1)},e.prototype.getMockPath=function(){return"./assets/mock/saveLoginToken.json"},e}(),mn=function(){function e(){this._body={},this._type="GET",this._url="",this._params=null,this._timeout=1e4}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},set:function(e){this._params=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(e){this._url=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},set:function(e){this._body=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeout",{get:function(){return this._timeout},set:function(e){this._timeout=e},enumerable:!0,configurable:!0}),e}(),Dn=function(){function e(){this.version="",this.DeviceSystem=""}return e.prototype.getAPIName=function(){return"CheckVersion"},e.prototype.getRequestData=function(){var e=new i.HttpParams;e=(e=e.set("version",this.version)).set("DeviceSystem",this.DeviceSystem);var t=new mn;return t.type="GET",t.params=e,t},e.prototype.getMockPath=function(){return"./assets/mock/CheckVersionAPI.json"},e}(),In=function(){function e(){}return e.prototype.getAPIName=function(){return"getMenu"},e.prototype.getMockPath=function(){return"./assets/config/menu.json"},e}(),Sn=function(){function e(e){this.DaoFactory=e}return e.prototype.setSettingObject=function(e){this._settingObject=e},e.prototype.getAPIName=function(){return"updateSetting"},e.prototype.getMockPath=function(){return"./assets/mock/getPersonalSetting.json"},e.prototype.executeSQL=function(){var o=this;return L.Observable.create(function(t){var e=o.DaoFactory.getDefaultTable("TW_LH_SD_Personal_Setting"),n=o.DaoFactory.getDefaultDao();e!=undefined&&n!=undefined?(e=e,n=new Ft(n),e.addRestriction(new Bt("SettingID",[o._settingObject.SettingID])),e.setValue("SettingVal",o._settingObject.SettingVal),n.updateByTable(e).subscribe(function(e){t.next(e),t.complete()})):(t.next(!1),t.complete())})},e}(),vn=function(){function e(e){this.deviceFactory=e}return e.prototype.getAPIName=function(){return"contactsSearch"},e.prototype.getMockPath=function(){return"./assets/mock/getImportContact.json"},e.prototype.runDeviceAPI=function(){return this.deviceFactory.getDefaultDao().searchcontactsByName("")},e}(),Pn=function(){function e(){this.url="",this.body={},this.async=!1}return e.prototype.getAPIName=function(){return"SyncPush"},e.prototype.getRequestData=function(){var e=new mn;return e.url=this.url,e.body=this.body,e.type="PUT",e},e}(),An=function(){function e(){this.url="",this.body={},this.lastUpdateTime=""}return e.prototype.getAPIName=function(){return"SyncPull"},e.prototype.getRequestData=function(){var e=new mn;return e.url=this.url,e.body=this.body,e.type="GET",e.params=(new i.HttpParams).set("lastUpdateTime",this.lastUpdateTime),e},e}(),Cn=function(){function e(e){this._DaoFactory=e}return e.prototype.getAPIName=function(){return"getCurrentLanguageList"},e.prototype.getMockPath=function(){return"./assets/mock/getCurrentLanguage.json"},e.prototype.executeSQL=function(){var o=this;return L.Observable.create(function(t){var e=o._DaoFactory.getTable("Profile","TW_LH_SD_Language"),n=o._DaoFactory.getDao("Profile");e!=undefined&&n!=undefined?(e=e,(n=new Ft(n)).queryByTable(e).subscribe(function(e){t.next(e),t.complete()})):(t.next(!1),t.complete())})},e}(),bn=function(){function e(e){this.account="",this._DaoFactory=e}return e.prototype.getAPIName=function(){return"BindingAccount"},e.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},e.prototype.executeSQL=function(){var e=this._DaoFactory.getTable("Profile","TW_LH_SD_DeviceInfo"),t=this._DaoFactory.getTable("Profile","TW_LH_SD_DeviceInfo"),n=this._DaoFactory.getDao("Profile");return e!=undefined&&t!=undefined&&n!=undefined?(e.addRestriction(new Bt("Category",["BindingAccount"])),n.transactionDelete(e),t.setValue("Category","BindingAccount"),t.setValue("CategoryVal",JSON.stringify({account:this.account})),t.setValue("UpdateTime",Date.now()),n.transactionInsert(t),n.runTransaction()):L.of(!1)},e}(),En=function(){function e(e){this._DaoFactory=e}return e.prototype.getAPIName=function(){return"getDeviceAccount"},e.prototype.getMockPath=function(){return"./assets/mock/getDeviceAccount.json"},e.prototype.executeSQL=function(){var o=this;return L.Observable.create(function(t){var e=o._DaoFactory.getTable("Profile","TW_LH_SD_DeviceInfo"),n=o._DaoFactory.getDao("Profile");e!=undefined&&n!=undefined?(n=new Ft(n),e.addRestriction(new Bt("Category",["BindingAccount"])),n.queryByTable(e).subscribe(function(e){console.log("getDeviceAccount API resp:",e),t.next(e),t.complete()})):(t.next(!1),t.complete())})},e}(),Ln=function(){function e(){this.body={}}return e.prototype.getAPIName=function(){return"UpdatePushID"},e.prototype.getMockPath=function(){return"./assets/mock/logout.json"},e.prototype.getRequestData=function(){var e=new mn;return e.body=this.body,e.type="POST",e},e}(),Nn=function(){function e(){this.num=0,this.type=""}return e.prototype.getAPIName=function(){return"getSyncSequenceID"},e.prototype.getRequestData=function(){var e=new mn,t=new i.HttpParams;return t=(t=t.set("category",this.type)).set("idNums",this.num.toString()),e.params=t,e.type="GET",e},e}(),On=function(){function e(e){this.daoFactory=e,this.stack=[],this.message="",this.time=new Date,this.DeviceModel="",this.DeviceSystem=""}return e.prototype.getAPIName=function(){return"LogError"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){var e=this.daoFactory.getTable("Profile","TW_LH_SD_Error_Log"),t=this.daoFactory.getDao("Profile");return e?(e.setValue("ErrorID",Q.v4()),e.setValue("Message",this.message),e.setValue("Time",this.time.getTime()),e.setValue("Stack",JSON.stringify(this.stack)),e.setValue("DeviceModel",this.DeviceModel),e.setValue("DeviceSystem",this.DeviceSystem),e.setValue("IsSend","N"),t.insertByTable(e)):L.of(!1)},e}(),Fn=function(){function e(e){this.daoFactory=e,this.action="",this.Function="",this.message="",this.time=new Date,this.valid=!0,this.DeviceModel="",this.DeviceSystem=""}return e.prototype.getAPIName=function(){return"LogAction"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){var e=this.daoFactory.getTable("Profile","TW_LH_SD_Action_Log"),t=this.daoFactory.getDao("Profile");return e?(e.setValue("ActionID",Q.v4()),e.setValue("Function",this.Function),e.setValue("Message",this.message),e.setValue("Time",this.time.getTime()),e.setValue("Action",this.action),e.setValue("Valid",this.valid?"Y":"N"),e.setValue("IsSend","N"),e.setValue("DeviceModel",this.DeviceModel),e.setValue("DeviceSystem",this.DeviceSystem),t.insertByTable(e)):L.of(!1)},e}(),wn=function(){function e(){this.url="",this.errorList=[]}return e.prototype.getAPIName=function(){return"PushErrorLog"},e.prototype.getRequestData=function(){var e=new mn;return e.url=this.url,e.body=this.errorList.map(function(e){return{Message:e.Message,Stack:e.Stack,Time:new Date(e.Time).toISOString(),DeviceModel:e.DeviceModel,DeviceSystem:e.DeviceSystem}}),e.type="POST",e},e.prototype.getMockPath=function(){return"./assets/mock/logout.json"},e}(),Mn=function(){function e(){this.url="",this.actionList=[]}return e.prototype.getAPIName=function(){return"PushActionLog"},e.prototype.getRequestData=function(){var e=new mn;return e.url=this.url,e.body=this.actionList.map(function(e){return{ActionID:e.ActionID,FunctionID:e.Function,Message:e.Message,Time:new Date(e.Time).toISOString(),Action:e.Action,Valid:e.Valid,DeviceModel:e.DeviceModel,DeviceSystem:e.DeviceSystem}}),e.type="POST",e},e.prototype.getMockPath=function(){return"./assets/mock/logout.json"},e}(),Rn=function(){function e(){}return e.prototype.getAPIName=function(){return"getRouterMap"},e.prototype.getMockPath=function(){return"./assets/config/router-map.json"},e}(),jn=function(){function e(e){this.APP_CONFIG=e,this.agentID="",this.url="",this.lastUpdateTime="2019-01-01 00:00:00"}return e.prototype.setAgentID=function(e){this.agentID=e},e.prototype.getMockPath=function(){return"./assets/mock/yearConfig.json"},e.prototype.getAPIName=function(){return"getYearConfig"},e.prototype.getRequestData=function(){var e=new mn,t=this.APP_CONFIG.ENV;return""!=this.agentID&&this.agentID!=undefined&&null!=this.agentID?(this.url=this.APP_CONFIG[t].API_URL.getYearConfig,e.url=this.url+"/"+this.agentID):e.url=this.url,e.type="GET",e.params=(new i.HttpParams).set("lastUpdateTime",this.lastUpdateTime),e},e}(),kn=function(){function e(e){this.daoFactory=e,this.yearConfigs=[]}return e.prototype.getAPIName=function(){return"saveYearConfig"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){var n=this;return this.yearConfig=this.daoFactory.getDefaultTable("TW_LH_SD_Year_Config"),this.yearConfig_ext=this.daoFactory.getDefaultTable("TW_LH_SD_Year_Config_Extension"),this.deviceInfo=this.daoFactory.getTable("Profile","TW_LH_SD_DeviceInfo"),this.dao=this.daoFactory.getDefaultDao(),this.profile_dao=this.daoFactory.getDao("Profile"),console.log("yearConfig",this.yearConfig),console.log("deviceInfo",this.deviceInfo),this.yearConfig&&this.deviceInfo?L.of(this.saveConfig().then(function(e){var t=e.Header.status;return console.log("saveYearConfigAPI resp:",e),t?(n.dao.transactionDelete(n.yearConfig),n.dao.transactionDelete(n.yearConfig_ext),Promise.all(n.yearConfigs.map(function(e){return n._getDate(e)})).then(function(){return n.dao.runTransaction().toPromise()})):e})):L.of(!1)},e.prototype._getDate=function(o){return I(this,void 0,void 0,function(){var t,n=this;return z(this,function(e){return console.log("yearcfg",o),t=Q.v4(),this.yearConfig.setValue("ClientID",t),this.yearConfig.setValue("DataYear",o.DataYear),this.yearConfig.setValue("IsCurrent",o.IsCurrent?"Y":"N"),this.yearConfig.setValue("PerformanceSettlementMonth",o.PerformanceSettlementMonth),this.yearConfig.setValue("WorkingMonth",o.WorkingMonth),this.yearConfig.setValue("WorkingQuarter",o.WorkingQuarter),this.yearConfig.setValue("QuarterStartMonth",o.QuarterStartMonth),this.yearConfig.setValue("QuarterEndMonth",o.QuarterEndMonth),this.yearConfig.setValue("InitialPreCaseFyfc",o.InitialPreCaseFyfc),this.yearConfig.setValue("FyfcCovertAnpRate",o.FyfcCovertAnpRate),this.yearConfig.setValue("InforceConvertFindRate",o.InforceConvertFindRate),this.yearConfig.setValue("InforceConvertScheduleRate",o.InforceConvertScheduleRate),this.yearConfig.setValue("InforceConvertMeetRate",o.InforceConvertMeetRate),this.yearConfig.setValue("InforceConvertSubmitRate",o.InforceConvertSubmitRate),this.yearConfig.setValue("ProgressDayPointsLimit",o.ProgressDayPointsLimit),this.yearConfig.setValue("InforceConvertPointBase",o.InforceConvertPointBase),this.yearConfig.setValue("FindConvertPointBase",o.FindConvertPointBase),this.yearConfig.setValue("ScheduleConvertPointBase",o.ScheduleConvertPointBase),this.yearConfig.setValue("MeetConvertPointBase",o.MeetConvertPointBase),this.yearConfig.setValue("SubmitConvertPointBase",o.SubmitConvertPointBase),this.yearConfig.setValue("GoalSettingActivityProcMode",o.GoalSettingActivityProcMode),this.yearConfig.setValue("ProgressBarControlMode",o.ProgressBarControlMode),this.yearConfig.setValue("GoalAndPlanDifferenceLimit",o.GoalAndPlanDifferenceLimit),this.yearConfig.setValue("NowToYearEndDays",o.NowToYearEndDays),this.yearConfig.setValue("MonthQuantityOfYear",o.MonthQuantityOfYear),this.dao.transactionInsert(this.yearConfig),this.yearConfig_ext.setValue("ClientID",t),o.extensions&&o.extensions.forEach(function(e){n.yearConfig_ext.setValue(e.id,e.value)}),this.dao.transactionInsert(this.yearConfig_ext),[2]})})},e.prototype.saveConfig=function(){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return console.log("[saveYearConfigAPI] isFirstUse",this.FirstUseAPP),null==this.FirstUseAPP||this.FirstUseAPP==undefined?[3,2]:(this.deviceInfo.addRestriction(new Bt("Category",["FirstUseAPP"])),[4,this.profile_dao.queryByTable(this.deviceInfo).toPromise()]);case 1:if(t=e.sent(),console.log("[saveYearConfigAPI] queryResp",t),t.Header.status)return 0<t.Body.length?(this.deviceInfo.setValue("CategoryVal",this.FirstUseAPP?"Y":"N"),console.log("[saveYearConfigAPI] deviceInfo 1",this.deviceInfo),this.profile_dao.transactionUpdate(this.deviceInfo)):(this.deviceInfo=this.daoFactory.getTable("Profile","TW_LH_SD_DeviceInfo"),this.deviceInfo.setValue("Category","FirstUseAPP"),this.deviceInfo.setValue("CategoryVal",this.FirstUseAPP?"Y":"N"),this.deviceInfo.setValue("UpdateTime",(new Date).getTime()),console.log("[saveYearConfigAPI] otherParameter 2",this.deviceInfo),this.profile_dao.transactionInsert(this.deviceInfo)),[2,this.profile_dao.runTransaction().toPromise()];e.label=2;case 2:return[2]}})})},e}(),Vn=function(){function e(e){this.APP_CONFIG=e,this.agentID="",this.url="",this.lastUpdateTime="2019-01-01 00:00:00"}return e.prototype.setAgentID=function(e){this.agentID=e},e.prototype.getMockPath=function(){return"./assets/mock/AgencyPlan.json"},e.prototype.getAPIName=function(){return"getAgencyPlan"},e.prototype.getRequestData=function(){var e=new mn,t=this.APP_CONFIG.ENV;return""!=this.agentID&&this.agentID!=undefined&&null!=this.agentID?(this.url=this.APP_CONFIG[t].API_URL.getAgencyPlan,e.url=this.url+"/"+this.agentID):e.url=this.url,e.type="GET",e.params=(new i.HttpParams).set("lastUpdateTime",this.lastUpdateTime),e},e}(),Hn=function(){function e(e){this.daoFactory=e,this.AgencyPlanDatas=[]}return e.prototype.getAPIName=function(){return"saveAgencyPlan"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){var t=this;console.log("AgencyPlanDatas",this.AgencyPlanDatas);var e=this.daoFactory.getDefaultTable("TW_LH_SD_Agency_Detail_Data"),n=this.daoFactory.getDefaultTable("TW_LH_SD_Agency_Detail_Data_Extension"),o=this.daoFactory.getDefaultTable("TW_LH_SD_Agency_Plan_Main"),r=this.daoFactory.getDefaultTable("TW_LH_SD_Agency_Plan_Main_Extension");return this.dao=this.daoFactory.getDefaultDao(),console.log("agencyPlanMain",o),console.log("agencyPlanDetail",e),o&&e?(this.dao.transactionDelete(e),this.dao.transactionDelete(n),this.dao.transactionDelete(o),this.dao.transactionDelete(r),L.from(Promise.all(this.AgencyPlanDatas.map(function(e){return t._getDate(e)})).then(function(){return t.dao.runTransaction().toPromise()}))):L.of(!1)},e.prototype._getDate=function(m){return I(this,void 0,void 0,function(){var n,o,i,a,r,s,c,u,l,h,p,f,g,d,_,y,T=this;return z(this,function(e){switch(e.label){case 0:i=this.daoFactory.getDefaultTable("TW_LH_SD_Agency_Detail_Data"),a=this.daoFactory.getDefaultTable("TW_LH_SD_Agency_Detail_Data_Extension"),r=this.daoFactory.getDefaultTable("TW_LH_SD_Agency_Plan_Main"),s=this.daoFactory.getDefaultTable("TW_LH_SD_Agency_Plan_Main_Extension"),c=this.daoFactory.getDefaultTable("TW_LH_SD_Other_Parameter"),u=m.DataYear,console.log("DataYear",u),l=m.Values,console.log("MainDatas",l);try{for(h=$(l),p=h.next();!p.done;p=h.next())f=p.value,g=Q.v4(),r.setValue("ClientID",g),r.setValue("DataYear",u),r.setValue("DataType",f.DataType),r.setValue("Forecast",f.Forecast),r.setValue("Actual",f.Actual),r.setValue("MonthPlan",f.Plan),r.setValue("Manpower",f.Manpower),r.setValue("Recruitment",f.Recruitment),this.dao.transactionInsert(r),s.setValue("ClientID",g),m.extensions&&m.extensions.forEach(function(e){s.setValue(e.id,e.value)}),this.dao.transactionInsert(s)}catch(t){n={error:t}}finally{try{p&&!p.done&&(o=h["return"])&&o.call(h)}finally{if(n)throw n.error}}return d=new Map,null!=m.DirectUnit&&d.set("Direct",m.DirectUnit),null!=m.InDirectUnit&&d.set("Indirect",m.InDirectUnit),0<d.size&&d.forEach(function(e,t){var n=0;for(n=0;n<e.length;n++){var o=e[n],r=Q.v4();i.setValue("ClientID",r),i.setValue("DataYear",u),i.setValue("DirectUnitType",t),i.setValue("AgentID",o.AgentID),i.setValue("AgentName",o.AgentName),i.setValue("JobGrade",o.JobGrade),i.setValue("IsApprove",o.IsApprove?"Y":"N"),i.setValue("Drilldown",o.Drilldown?"Y":"N"),i.setValue("AppUseMode",o.AppUseMode),i.setValue("DataType",o.DataType),i.setValue("Goal",o.Goal),i.setValue("Forecast",o.Forecast),i.setValue("Actual",o.Actual),i.setValue("MonthPlan",o.Plan),i.setValue("Manpower",o.Manpower),i.setValue("Recruitment",o.Recruitment),i.setValue("CaseCount",o.CaseCount),i.setValue("PerCase",o.PerCase),i.setValue("Orders",n),T.dao.transactionInsert(i),a.setValue("ClientID",r),o.extensions&&o.extensions.forEach(function(e){a.setValue(e.id,e.value)}),T.dao.transactionInsert(a)}}),_=m.CompletionRate,console.log("[saveAgencyPlanAPI] completionRate",_),Oe.isNotEmpty(_)?((c=this.daoFactory.getDefaultTable("TW_LH_SD_Other_Parameter")).addRestriction(new Bt("MappingID",["CompletionRate"])),c.addRestriction(new Bt("DataYear",[u])),[4,this.dao.queryByTable(c).toPromise()]):[3,2];case 1:y=e.sent(),console.log("[saveAgencyPlanAPI] queryResp",y),y.Header.status&&(0<y.Body.length?(c.setValue("SetValue",_.toString()),console.log("[saveAgencyPlanAPI] otherParameter 1",c),this.dao.transactionUpdate(c)):((c=this.daoFactory.getDefaultTable("TW_LH_SD_Other_Parameter")).setValue("ClientID",Q.v4()),c.setValue("DataYear",u),c.setValue("MappingID","CompletionRate"),c.setValue("SetValue",_.toString()),c.setValue("syncTime",(new Date).getTime()),console.log("[saveAgencyPlanAPI] otherParameter 2",c),this.dao.transactionInsert(c))),e.label=2;case 2:return[2]}})})},e}(),Gn=function(){function e(e){this.daoFactory=e,this.ProgressDatas=[]}return e.prototype.getAPIName=function(){return"saveProgress"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){var t=this;console.log("ProgressDatas",this.ProgressDatas);var e=this.daoFactory.getDefaultTable("TW_LH_SD_Personal_Progress"),n=this.daoFactory.getDefaultTable("TW_LH_SD_Personal_Progress_Extension"),o=this.daoFactory.getDefaultTable("TW_LH_SD_Team_Progress_Main"),r=this.daoFactory.getDefaultTable("TW_LH_SD_Team_Progress_Main_Extension"),i=this.daoFactory.getDefaultTable("TW_LH_SD_Team_Progress_Detail"),a=this.daoFactory.getDefaultTable("TW_LH_SD_Team_Progress_Detail_Extension"),s=this.daoFactory.getDefaultTable("TW_LH_SD_Other_Parameter");return console.log("table personalProgress",e),console.log("table teamProgressMain",o),console.log("table teamProgressDetail",i),console.log("table otherParameter",s),this.dao=this.daoFactory.getDefaultDao(),e&&o&&i&&s?(this.dao.transactionDelete(e),this.dao.transactionDelete(o),this.dao.transactionDelete(i),this.dao.transactionDelete(n),this.dao.transactionDelete(r),this.dao.transactionDelete(a),L.from(Promise.all(this.ProgressDatas.map(function(e){return t._getDate(e)})).then(function(){return t.dao.runTransaction().toPromise()}))):L.of(!1)},e.prototype._getDate=function(E){return I(this,void 0,void 0,function(){var o,r,i,a,s,c,u,l,h,p,f,g,d,_,y,T,m,D,I,S,v,P,A,C,b=this;return z(this,function(e){switch(e.label){case 0:if(s=this.daoFactory.getDefaultTable("TW_LH_SD_Personal_Progress"),c=this.daoFactory.getDefaultTable("TW_LH_SD_Personal_Progress_Extension"),u=this.daoFactory.getDefaultTable("TW_LH_SD_Team_Progress_Main"),l=this.daoFactory.getDefaultTable("TW_LH_SD_Team_Progress_Main_Extension"),h=this.daoFactory.getDefaultTable("TW_LH_SD_Team_Progress_Detail"),p=this.daoFactory.getDefaultTable("TW_LH_SD_Team_Progress_Detail_Extension"),f=this.daoFactory.getDefaultTable("TW_LH_SD_Other_Parameter"),console.log("ProgressData",E),g=E.DataYear,console.log("DataYear",g),null!=E.Personal.Values){d=E.Personal.Values,console.log("personalDatas",d);try{for(_=$(d),y=_.next();!y.done;y=_.next())T=y.value,v=Q.v4(),s.setValue("ClientID",v),s.setValue("DataYear",g),s.setValue("DataType",T.DataType),s.setValue("TimeBase",T.TimeBase),s.setValue("Find",T.Find),s.setValue("Schedule",T.Schedule),s.setValue("Meet",T.Meet),s.setValue("Submit",T.Submit),s.setValue("Inforce",T.Inforce),s.setValue("FYFC",T.FYFC),this.dao.transactionInsert(s),c.setValue("ClientID",v),T.extensions&&T.extensions.forEach(function(e){c.setValue(e.id,e.value)}),this.dao.transactionInsert(c)}catch(t){o={error:t}}finally{try{y&&!y.done&&(r=_["return"])&&r.call(_)}finally{if(o)throw o.error}}}if(null!=E.Team.Values){m=E.Team.Values,console.log("TeamMainlDatas",m);try{for(D=$(m),I=D.next();!I.done;I=D.next())S=I.value,v=Q.v4(),u.setValue("ClientID",v),u.setValue("DataYear",g),u.setValue("DataType",S.DataType),u.setValue("TimeBase",S.TimeBase),u.setValue("Goal",S.Goal),u.setValue("Forecast",S.Forecast),u.setValue("Actual",S.Actual),u.setValue("Shortfall",S.Shortfall),this.dao.transactionInsert(u),l.setValue("ClientID",v),S.extensions&&S.extensions.forEach(function(e){l.setValue(e.id,e.value)}),this.dao.transactionInsert(l)}catch(n){i={error:n}}finally{try{I&&!I.done&&(a=D["return"])&&a.call(D)}finally{if(i)throw i.error}}}return P=new Map,null!=E.Team.DirectUnit&&P.set("Direct",E.Team.DirectUnit),null!=E.Team.InDirectUnit&&P.set("Indirect",E.Team.InDirectUnit),0<P.size&&P.forEach(function(e,t){console.log("key",t,"datas",e);var n=0;for(n=0;n<e.length;n++){var o=e[n],r=Q.v4();h.setValue("ClientID",r),h.setValue("DataYear",g),h.setValue("DirectUnitType",t),h.setValue("TimeBase",o.TimeBase),h.setValue("AgentID",o.AgentID),h.setValue("AgentName",o.AgentName),h.setValue("JobGrade",o.JobGrade),h.setValue("TeamName",o.TeamName),h.setValue("Drilldown",o.Drilldown?"Y":"N"),h.setValue("DataType",o.DataType),h.setValue("AppUseMode",o.AppUseMode),null!=o.Activities&&h.setValue("Activities",o.Activities),h.setValue("Goal",o.Goal),h.setValue("Forecast",o.Forecast),h.setValue("Actual",o.Actual),h.setValue("Shortfall",o.Shortfall),h.setValue("Orders",n),b.dao.transactionInsert(h),p.setValue("ClientID",r),o.extensions&&o.extensions.forEach(function(e){p.setValue(e.id,e.value)}),b.dao.transactionInsert(p)}}),A=E.YesterdayPoint,console.log("[saveProgressAPI] YesterdayPoint",A),null==A||A==undefined?[3,2]:((f=this.daoFactory.getDefaultTable("TW_LH_SD_Other_Parameter")).addRestriction(new Bt("MappingID",["YesterdayPoint"])),f.addRestriction(new Bt("DataYear",[g])),[4,this.dao.queryByTable(f).toPromise()]);case 1:C=e.sent(),console.log("[saveProgressAPI] queryResp",C),C.Header.status&&(0<C.Body.length?(f.setValue("SetValue",A),console.log("[saveProgressAPI] otherParameter 1",f),this.dao.transactionUpdate(f)):((f=this.daoFactory.getDefaultTable("TW_LH_SD_Other_Parameter")).setValue("ClientID",Q.v4()),f.setValue("DataYear",g),f.setValue("MappingID","YesterdayPoint"),f.setValue("SetValue",A),f.setValue("syncTime",(new Date).getTime()),console.log("[saveProgressAPI] otherParameter 2",f),this.dao.transactionInsert(f))),e.label=2;case 2:return[2]}})})},e}(),xn=function(){function e(e){this.APP_CONFIG=e,this.agentID="",this.url="",this.lastUpdateTime="2019-01-01 00:00:00"}return e.prototype.setAgentID=function(e){this.agentID=e},e.prototype.getMockPath=function(){return"./assets/mock/Progress.json"},e.prototype.getAPIName=function(){return"getProgress"},e.prototype.getRequestData=function(){var e=new mn,t=this.APP_CONFIG.ENV;return""!=this.agentID&&this.agentID!=undefined&&null!=this.agentID?(this.url=this.APP_CONFIG[t].API_URL.getProgress,e.url=this.url+"/"+this.agentID):e.url=this.url,e.type="GET",e.params=(new i.HttpParams).set("lastUpdateTime",this.lastUpdateTime),e},e}(),Wn=function(){function e(){this._configName=""}return Object.defineProperty(e.prototype,"configName",{get:function(){return this._configName},set:function(e){this._configName=e},enumerable:!0,configurable:!0}),e.prototype.getAPIName=function(){return"getMetaConfig"},e.prototype.getMockPath=function(){return"./assets/config/meta/"+this._configName+".json"},e}(),Bn=function(){function e(e,t){this._translateService=e,this._deviceService=t}return e.prototype.getAPIName=function(){return"getSettingValue"},e.prototype.getMockPath=function(){return"./assets/mock/getSettingValue.json"},e.prototype.executeSQL=function(){var e=this;return L.Observable.create(function(t){var n={Language:e._translateService.getCurrentLanguage(),LastUpdatedTime:"Setting_See_Details"};e._deviceService.getAppVersion().then(function(e){n.Version=e,t.next({Header:{isSuccess:!0},Body:[n]}),t.complete()})})},e}(),Un=function(){function e(e){this.APP_CONFIG=e,this.agentID="",this.url="",this.lastUpdateTime="2019-01-01 00:00:00"}return e.prototype.setAgentID=function(e){this.agentID=e},e.prototype.getMockPath=function(){return"assets/mock/Goal.json"},e.prototype.getAPIName=function(){return"getGoal"},e.prototype.getRequestData=function(){var e=new mn,t=this.APP_CONFIG.ENV;return""!=this.agentID&&this.agentID!=undefined&&null!=this.agentID?(this.url=this.APP_CONFIG[t].API_URL.getGoal,e.url=this.url+"/"+this.agentID):e.url=this.url,e.type="GET",e.params=(new i.HttpParams).set("lastUpdateTime",this.lastUpdateTime),e},e}(),Yn=function(){function e(e){this.daoFactory=e,this.GoalDatas=[]}return e.prototype.getAPIName=function(){return"saveGoal"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){var e,t,n,o,r,i;console.log("GoalDatas",this.GoalDatas);var a=this.daoFactory.getDefaultTable("TW_LH_SD_Goal_Setting"),s=this.daoFactory.getDefaultTable("TW_LH_SD_Goal_Setting_Extension"),c=this.daoFactory.getDefaultTable("TW_LH_SD_Goal_Setting_Value"),u=this.daoFactory.getDefaultTable("TW_LH_SD_Goal_Setting_Plan_Value"),l=this.daoFactory.getDefaultTable("TW_LH_SD_Goal_Setting_Plan_Value_Extension"),h=this.daoFactory.getDefaultDao();if(console.log("GoalSetting",a),console.log("GoalSetting_Ext",s),console.log("GoalSettingValue",c),console.log("GoalSettingPlan",u),console.log("GoalSettingPlan_Ext",l),a&&s&&c&&u&&l){h.transactionDelete(a),h.transactionDelete(c),h.transactionDelete(u),h.transactionDelete(s),h.transactionDelete(l);try{for(var p=$(this.GoalDatas),f=p.next();!f.done;f=p.next()){var g=f.value;console.log("GoalData",g);var d=g.DataYear;if(console.log("DataYear",d),null!=g.GoalSetting){var _=g.GoalSetting,y=Q.v4();console.log("GoalSettingData",_),a.setValue("ClientID",y),a.setValue("DataYear",d),a.setValue("ApproveStatus",_.Status),a.setValue("IsNeedSetting",_.IsNeedSetting?"Y":"N"),a.setValue("IsFirstTime",_.IsFirstTime?"Y":"N"),a.setValue("Remainingdays",_.Remainingdays),a.setValue("GoalSetMonth",_.GoalSetMonth),a.setValue("PersonnelGoalApplicableYM",_.PersonnelGoalApplicableYM),a.setValue("TeamGoalApplicableYM",_.TeamGoalApplicableYM),a.setValue("SupervisorComment",_.SupervisorComment),h.transactionInsert(a),s.setValue("ClientID",y),_.extensions&&_.extensions.forEach(function(e){s.setValue(e.id,e.value)}),h.transactionInsert(s)}if(null!=g.GoalValue){var T=g.GoalValue;console.log("GoalValueDatas",T);try{for(var m=$(T),D=m.next();!D.done;D=m.next()){var I=D.value;c.setValue("ClientID",Q.v4()),c.setValue("DataYear",d),c.setValue("DataType",I.DataType),c.setValue("Value",I.Value.toString()),h.transactionInsert(c)}}catch(C){n={error:C}}finally{try{D&&!D.done&&(o=m["return"])&&o.call(m)}finally{if(n)throw n.error}}}if(null!=g.GoalPlan){var S=g.GoalPlan;if(console.log("GoalPlanData",S),"Month"==S.TimeBase){var v=S.Values;try{for(var P=$(v),A=P.next();!A.done;A=P.next()){I=A.value,y=Q.v4();u.setValue("ClientID",y),u.setValue("DataYear",d),u.setValue("PerformanceType",I.PerformanceType),u.setValue("Month",I.Month),u.setValue("Value",I.Value),h.transactionInsert(u),l.setValue("ClientID",y),I.extensions&&I.extensions.forEach(function(e){l.setValue(e.id,e.value)}),h.transactionInsert(l)}}catch(b){r={error:b}}finally{try{A&&!A.done&&(i=P["return"])&&i.call(P)}finally{if(r)throw r.error}}}}}}catch(E){e={error:E}}finally{try{f&&!f.done&&(t=p["return"])&&t.call(p)}finally{if(e)throw e.error}}return h.runTransaction()}return L.of(!1)},e}(),qn=function(){function e(e){this.daoFactory=e,this.ActualDatas=[]}return e.prototype.getAPIName=function(){return"saveActual"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){var e,t,n,o;console.log("ActualDatas",this.ActualDatas);var r=this.daoFactory.getDefaultTable("TW_LH_SD_Actual_Value"),i=this.daoFactory.getDefaultTable("TW_LH_SD_Actual_Value_Extension"),a=this.daoFactory.getDefaultDao();if(console.log("ActualValue",r),r){a.transactionDelete(r),a.transactionDelete(i);try{for(var s=$(this.ActualDatas),c=s.next();!c.done;c=s.next()){var u=c.value;console.log("ActualData",u);var l=u.DataYear;console.log("DataYear",l);var h=u.Values;console.log("ActualMainDatas",h);try{for(var p=$(h),f=p.next();!f.done;f=p.next()){var g=f.value,d=Q.v4();r.setValue("ClientID",d),r.setValue("DataYear",l),r.setValue("DataType",g.DataType),r.setValue("PerformanceType",g.PerformanceType),r.setValue("Month",g.Month),r.setValue("Value",g.Value),a.transactionInsert(r),i.setValue("ClientID",d),g.extensions&&g.extensions.forEach(function(e){i.setValue(e.id,e.value)}),a.transactionInsert(i)}}catch(_){n={error:_}}finally{try{f&&!f.done&&(o=p["return"])&&o.call(p)}finally{if(n)throw n.error}}}}catch(y){e={error:y}}finally{try{c&&!c.done&&(t=s["return"])&&t.call(s)}finally{if(e)throw e.error}}return a.runTransaction()}return L.of(!1)},e}(),Xn=function(){function e(e){this.APP_CONFIG=e,this.agentID="",this.url="",this.lastUpdateTime="2019-01-01 00:00:00"}return e.prototype.setAgentID=function(e){this.agentID=e},e.prototype.getMockPath=function(){return"assets/mock/Actual.json"},e.prototype.getAPIName=function(){return"getActual"},e.prototype.getRequestData=function(){var e=new mn,t=this.APP_CONFIG.ENV;return""!=this.agentID&&this.agentID!=undefined&&null!=this.agentID?(this.url=this.APP_CONFIG[t].API_URL.getActual,e.url=this.url+"/"+this.agentID):e.url=this.url,e.type="GET",e.params=(new i.HttpParams).set("lastUpdateTime",this.lastUpdateTime),e},e}(),Jn=function(){function e(){this.url=""}return e.prototype.getAPIName=function(){return"pushGoalSettingData"},e.prototype.getRequestData=function(){var e=new mn;return e.url=this.url,e.body=this.mainData,e.type="POST",e},e.prototype.getMockPath=function(){return"./assets/mock/GoalCallback.json"},e}(),Qn=function(){function e(){this.url="",this.mainData={}}return e.prototype.getAPIName=function(){return"pushApproveGoal"},e.prototype.getRequestData=function(){var e=new mn;return e.url=this.url,e.body=this.mainData,e.type="POST",e},e.prototype.getMockPath=function(){return"./assets/mock/logout.json"},e}(),Kn=function(){function e(e){this.daoFactory=e,this.dataType="",this.token=""}return e.prototype.setDataType=function(e){this.dataType=e},e.prototype.getAPIName=function(){return"getDeviceInfo"},e.prototype.getMockPath=function(){return"StepupLevel"===this.dataType?"./assets/mock/getDeviceInfoForAgentInfo.json":"./assets/mock/getDeviceInfo.json"},e.prototype.executeSQL=function(){var e=this.daoFactory.getTable("Profile","TW_LH_SD_DeviceInfo"),t=this.daoFactory.getDao("Profile");return""!=this.dataType&&e.addRestriction(new Bt("Category",[this.dataType])),t.queryByTable(e)},e}(),zn=function(){function e(){this.url="",this.body={},this.type="GET",this.params=null}return e.prototype.getAPIName=function(){return"onlineLogin"},e.prototype.getMockPath=function(){return"./assets/mock/onlineLogin.json"},e.prototype.getRequestData=function(){var e=new mn;return e.body=this.body,e.url=this.url,e.type="POST",e.params=this.params,e},e}(),$n=function(){function e(e){this.daoFactory=e,this._isPopup=null,this._isShow=null}return Object.defineProperty(e.prototype,"isShow",{get:function(){return this._isShow},set:function(e){this._isShow=e},enumerable:!0,configurable:!0}),e.prototype.setKeyword=function(e){this._keyword=e},e.prototype.setPageInfo=function(e){this._pageInfo=e},e.prototype.setIsPopup=function(e){this._isPopup=e},e.prototype.getAPIName=function(){return"getDashboardMessageList"},e.prototype.getMockPath=function(){return"./assets/mock/getDashboardMessageList.json"},e.prototype.executeSQL=function(){var i=this;return L.Observable.create(function(t){var e=i.daoFactory.getDefaultDao();if(e!=undefined){var n=i.daoFactory.getDefaultTable("TW_LH_SD_Message");if(n){if(e=new Ft(e),Oe.isNotEmpty(i._keyword)&&("All"==i._keyword||("UnRead"==i._keyword?n.addRestriction(new Bt("Status",[i._keyword])):"PendingApproval"===i._keyword?(n.addRestriction(new Bt("MessageCategory",["GoalSetting"])),n.addRestriction(new Bt("MessageType",["Need_Goal_Approve"])),n.addRestriction(new Bt("LinkStatus",["Approve"]))):"Customer"!=i._keyword&&"Calendar"!=i._keyword&&"GoalSetting"!=i._keyword&&"Progress"!=i._keyword||n.addRestriction(new Bt("MessageCategory",[i._keyword])))),null!==i._isPopup){var o=i._isPopup?"Y":"N";n.addRestriction(new Bt("IsPopup",[o]))}if(null!==i._isShow){var r=i._isShow?"Y":"N";n.addRestriction(new Bt("IsShow",[r]))}i._pageInfo&&(n.addRestriction(new Pt([i._pageInfo.pageSize])),n.addRestriction(new At([(i._pageInfo.page-1)*i._pageInfo.pageSize]))),n.addRestriction(new bt([{column:"MessageTime",order:"DESC"}])),e.queryByTable(n).subscribe(function(e){console.log("queryByTable: ",JSON.stringify(e)),t.next(e),t.complete()})}else t.next(!1),t.complete()}else t.next(!1),t.complete()})},e}(),Zn=function(){function e(e){this.daoFactory=e,this._clientIDList=[]}return e.prototype.setClientID=function(e){this._clientID=e},e.prototype.setClientIDList=function(e){this._clientIDList=e},e.prototype.setStatus=function(e){this._status=e},e.prototype.getAPIName=function(){return"updateDashboardMessageStatus"},e.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},e.prototype.executeSQL=function(){var o=this;return L.Observable.create(function(t){var e=o.daoFactory.getDefaultDao();if(e!=undefined){var n=o.daoFactory.getDefaultTable("TW_LH_SD_Message");n?(e=new Ft(e),n=n,0<o._clientIDList.length?n.addRestriction(new qt("ClientID",o._clientIDList)):n.addRestriction(new Bt("ClientID",[o._clientID])),n.setValue("Status",o._status),e.updateByTable(n).subscribe(function(e){t.next(e),t.complete()})):(t.next(!1),t.complete())}else t.next(!1),t.complete()})},e}(),eo=function(){function e(e){this.daoFactory=e,this._messageID=null,this._col=null,this._val=null}return Object.defineProperty(e.prototype,"val",{get:function(){return this._val},set:function(e){this._val=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(e){this._col=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messageID",{get:function(){return this._messageID},set:function(e){this._messageID=e},enumerable:!0,configurable:!0}),e.prototype.getAPIName=function(){return"ChangeMessageStatus"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){return this._messageID&&this._col&&this._val?L.from(this._updateStatus(this._messageID,this._col,this._val)):L.of(!1)},e.prototype._updateStatus=function(i,a,s){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return t=null,n=this.daoFactory.getDefaultDao(),o=this.daoFactory.getDefaultTable("TW_LH_SD_Message"),console.log("_updateStatus Message",o),o?(o.addRestriction(new Bt("MessageID",[i])),[4,n.queryByTable(o).toPromise()]):[3,3];case 1:return(r=e.sent()).Header.status&&0<r.Body.length?(o.setValue(a,s),[4,n.updateByTable(o).toPromise()]):[3,3];case 2:t=e.sent(),e.label=3;case 3:return console.log("_updateStatus resp",t),[2,t]}})})},e}(),to=function(){function e(e){this.APP_CONFIG=e,this._deviceID=""}return e.prototype.setDeviceID=function(e){this._deviceID=e},e.prototype.getAPIName=function(){return"unbindDevice"},e.prototype.getMockPath=function(){return"./assets/mock/logout.json"},e.prototype.getRequestData=function(){var e=this.APP_CONFIG.ENV,t=this.APP_CONFIG[e].API_URL.unbindDevice,n=new mn;return n.url=t,n.body={DeviceId:this._deviceID},n.type="POST",n},e}(),no=function(){function e(e){this._DaoFactory=e}return e.prototype.getAPIName=function(){return"getUpdateTimeList"},e.prototype.getMockPath=function(){return"./assets/mock/getUpdateTimeList.json"},e.prototype.executeSQL=function(){var o=this;return L.Observable.create(function(t){var e=o._DaoFactory.getTable("Profile","TW_LH_SD_VW_FuncSync_Time"),n=o._DaoFactory.getDao("Profile");e!=undefined&&n!=undefined?(e=e,(n=new Ft(n)).queryByTable(e).subscribe(function(e){t.next(e),t.complete()})):(t.next(!1),t.complete())})},e}(),oo=function(){function e(e,t,n,o,r,i){this.APIFactory=e,this.DAOFactory=t,this.deviceFactory=n,this.translateService=o,this.deviceService=r,this.APP_CONFIG=i}return e.prototype.doTask=function(){var n=this;return new Promise(function(e,t){console.log("register API"),n.APIFactory.registerAPI(new dn(n.DAOFactory)),n.APIFactory.registerAPI(new Sn(n.DAOFactory)),n.APIFactory.registerAPI(new _n),n.APIFactory.registerAPI(new gn(n.DAOFactory)),n.APIFactory.registerAPI(new Cn(n.DAOFactory)),n.APIFactory.registerAPI(new Tn(n.DAOFactory)),n.APIFactory.registerAPI(new yn(n.DAOFactory,n.APP_CONFIG)),n.APIFactory.registerAPI(new In),n.APIFactory.registerAPI(new Dn),n.APIFactory.registerAPI(new Pn),n.APIFactory.registerAPI(new An),n.APIFactory.registerAPI(new Ln),n.APIFactory.registerAPI(new Nn),n.APIFactory.registerAPI(new bn(n.DAOFactory)),n.APIFactory.registerAPI(new En(n.DAOFactory)),n.APIFactory.registerAPI(new vn(n.deviceFactory)),n.APIFactory.registerAPI(new On(n.DAOFactory)),n.APIFactory.registerAPI(new Fn(n.DAOFactory)),n.APIFactory.registerAPI(new wn),n.APIFactory.registerAPI(new Mn),n.APIFactory.registerAPI(new Rn),n.APIFactory.registerAPI(new jn(n.APP_CONFIG)),n.APIFactory.registerAPI(new kn(n.DAOFactory)),n.APIFactory.registerAPI(new Vn(n.APP_CONFIG)),n.APIFactory.registerAPI(new Hn(n.DAOFactory)),n.APIFactory.registerAPI(new xn(n.APP_CONFIG)),n.APIFactory.registerAPI(new Gn(n.DAOFactory)),n.APIFactory.registerAPI(new Un(n.APP_CONFIG)),n.APIFactory.registerAPI(new Yn(n.DAOFactory)),n.APIFactory.registerAPI(new Xn(n.APP_CONFIG)),n.APIFactory.registerAPI(new qn(n.DAOFactory)),n.APIFactory.registerAPI(new Jn),n.APIFactory.registerAPI(new Qn),n.APIFactory.registerAPI(new Kn(n.DAOFactory)),n.APIFactory.registerAPI(new Wn),n.APIFactory.registerAPI(new Bn(n.translateService,n.deviceService)),n.APIFactory.registerAPI(new zn),n.APIFactory.registerAPI(new $n(n.DAOFactory)),n.APIFactory.registerAPI(new Zn(n.DAOFactory)),n.APIFactory.registerAPI(new eo(n.DAOFactory)),n.APIFactory.registerAPI(new to(n.APP_CONFIG)),n.APIFactory.registerAPI(new no(n.DAOFactory)),e("register API tasks Done!")})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:p},{type:Nt},{type:xe},{type:rt},{type:We},{type:undefined,decorators:[{type:u.Inject,args:[_]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(p),u.inject(Nt),u.inject(xe),u.inject(rt),u.inject(We),u.inject(_))},token:e,providedIn:"root"}),e}(),ro=function(){function e(e,t,n,o,r,i,a,s){this.errorHandler=e,this.dataSyncTask=t,this.configTask=n,this.deviceTask=o,this.registerAPITask=r,this.customRegisterAPITask=i,this.customTask=a,this.initialFinish=s,this._sequentialTasks=[],this._parallelTasks=[],this.registerAPITask&&this._sequentialTasks.push(this.registerAPITask),this.customRegisterAPITask&&this._sequentialTasks.push(this.customRegisterAPITask),this.dataSyncTask&&this._sequentialTasks.push(this.dataSyncTask),this.deviceTask&&this._sequentialTasks.push(this.deviceTask),this.configTask&&this._sequentialTasks.push(this.configTask),this.customTask&&this._sequentialTasks.push(this.customTask)}return e.prototype.load=function(){return I(this,void 0,void 0,function(){var t,n,o,r,i,a;return z(this,function(e){switch(e.label){case 0:console.log("initial service load!",this._sequentialTasks),e.label=1;case 1:return e.trys.push([1,13,,14]),[4,this.waitnseconds(1e3)];case 2:e.sent(),e.label=3;case 3:e.trys.push([3,8,9,10]),o=$(this._sequentialTasks),r=o.next(),e.label=4;case 4:return r.done?[3,7]:[4,r.value.doTask()];case 5:e.sent(),e.label=6;case 6:return r=o.next(),[3,4];case 7:return[3,10];case 8:return i=e.sent(),t={error:i},[3,10];case 9:try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(t)throw t.error}return[7];case 10:return[4,Promise.all(this._parallelTasks.map(function(e){return e.doTask()})).then(function(e){})];case 11:return e.sent(),[4,this.dataSyncTask.refreshSchema()];case 12:return e.sent(),this.initialFinish&&this.initialFinish.afterInitialFinish(),[3,14];case 13:return a=e.sent(),console.warn("Initial Error: maybe not on the mobile"),this.errorHandler.handleError(a),[3,14];case 14:return[2]}})})},e.prototype.waitnseconds=function(n){return new Promise(function(e,t){setTimeout(function(){e()},n)})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.ErrorHandler},{type:Gt},{type:pn},{type:fn},{type:oo},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[v]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[A]}]},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[J]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.ErrorHandler),u.inject(Gt),u.inject(pn),u.inject(fn),u.inject(oo),u.inject(v,8),u.inject(A,8),u.inject(J,8))},token:e,providedIn:"root"}),e}(),io=function(){function e(){}return e.prototype.setBodyJSON=function(e){this.bodyJSON=e},e.prototype.getBodyJSON=function(){return this.bodyJSON},e}(),ao=function(){function e(){this.url="",this.body={},this.type="GET",this.params=null}return e.prototype.getAPIName=function(){return"Logout"},e.prototype.getMockPath=function(){return"./assets/mock/logout.json"},e.prototype.getRequestData=function(){var e=new mn;return e.url=this.url,e.type="POST",e},e}(),so=function(){function e(e){this.daoFactory=e,this._messageID=null,this._col=null,this._val=null}return Object.defineProperty(e.prototype,"val",{get:function(){return this._val},set:function(e){this._val=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(e){this._col=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messageID",{get:function(){return this._messageID},set:function(e){this._messageID=e},enumerable:!0,configurable:!0}),e.prototype.getAPIName=function(){return"ChangeMessageStatus"},e.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},e.prototype.executeSQL=function(){return this._messageID&&this._col&&this._val?L.from(this._updateStatus(this._messageID,this._col,this._val)):L.of(!1)},e.prototype._updateStatus=function(i,a,s){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return t=null,n=this.daoFactory.getDefaultDao(),o=this.daoFactory.getDefaultTable("TW_LH_SD_Message"),console.log("_updateStatus Message",o),o?(o.addRestriction(new Bt("MessageID",[i])),[4,n.queryByTable(o).toPromise()]):[3,3];case 1:return(r=e.sent()).Header.status&&0<r.Body.length?(o.setValue(a,s),[4,n.updateByTable(o).toPromise()]):[3,3];case 2:t=e.sent(),e.label=3;case 3:return console.log("_updateStatus resp",t),[2,t]}})})},e}(),co=function(){function e(e){this._year=-1,this._daoFactory=e}return e.prototype.SetYear=function(e){this._year=e},e.prototype.getAPIName=function(){return"getOtherParameter"},e.prototype.getMockPath=function(){return"./assets/mock/getOtherParameterMock.json"},e.prototype.executeSQL=function(){console.debug("SQLite Start ");var e=this._daoFactory.getDefaultDao();console.debug("SQLite defaultDao: ",e);var t=this._daoFactory.getDefaultTable("TW_LH_SD_Other_Parameter");if(-1!==this._year&&t.addRestriction(new Bt("DataYear",[this._year])),console.debug("SQLite tableObj: ",t),e!=undefined&&t!=undefined)return L.from(e.queryByTable(t).toPromise().then(function(e){return console.debug("SQLite getOtherParameter resp: ",e),console.debug("SQLite getOtherParameter json resp: ",JSON.stringify(e)),e}));L.of(!1),console.debug("SQLite failed")},e}(),uo=function(){function e(e,t,n,o,r){var i=this;this.httpService=e,this.APIFactory=t,this.dispatcher=n,this.deviceService=o,this.APP_CONFIG=r,this.deviceService.getAppVersion().then(function(e){i.appVersion=e}),this.platform=this.deviceService.getDevicePlatform()}return e.prototype.checkVersion=function(){var n=this,e=this.APIFactory.getAPI("CheckVersion");return e.version=this.appVersion,e.DeviceSystem=this.deviceService.getDevicePlatform(),L.Observable.create(function(t){n.dispatcher.dispatch(e).subscribe(function(e){console.log("check version resp:",e),e.version!=n.appVersion?t.next({isSuccess:!0,newVersion:!0,appVersion:new nn(e.appPath,e.version)}):t.next({isSuccess:!0,newVersion:!1,appVersion:new nn(e.appPath,e.version)}),t.complete()},function(e){console.warn("check Version request error:",e.message),t.next({isSuccess:!1,errorMsg:e.message}),t.complete()})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:i.HttpClient},{type:p},{type:nt},{type:We},{type:undefined,decorators:[{type:u.Inject,args:[_]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(i.HttpClient),u.inject(p),u.inject(nt),u.inject(We),u.inject(_))},token:e,providedIn:"root"}),e}(),lo={PENDING:0,AVAILABLE:1};lo[lo.PENDING]="PENDING",lo[lo.AVAILABLE]="AVAILABLE";var ho=function(){function e(e,t,n,o,r,i,a){this.APP_CONFIG=e,this.APIFactory=t,this.dispatcher=n,this.errorHandler=o,this.DaoFactory=r,this.devcieService=i,this.registerDataSyncFunc=a,this.syncAPIMap={},this.FuncAPIMap={},this.SyncProcessList=[],this.func_url={},this.syncStateSubject=new L.BehaviorSubject(this.getCurrentSyncState()),this.init()}return e.prototype.init=function(){var t=this;this.func_url=this.APP_CONFIG[this.APP_CONFIG.ENV].SYNC_URL,this.FuncAPIMap=this.registerDataSyncFunc.getFuncMap(),this.registerDataSyncFunc.getSyncInstance().forEach(function(e){t.registerAPI(e)})},e.prototype.getSyncState=function(){return this.syncStateSubject.asObservable()},e.prototype.registerAPI=function(e){this.syncAPIMap[e.getName()]=e},e.prototype.syncAllFunc=function(t){return void 0===t&&(t=!1),I(this,void 0,void 0,function(){return z(this,function(e){return console.log("syncAllFunc:",this.FuncAPIMap,Object.keys(this.FuncAPIMap)),[2,this.syncFunc(Object.keys(this.FuncAPIMap),t)]})})},e.prototype.syncFunc=function(_,y){return void 0===y&&(y=!1),I(this,void 0,void 0,function(){var t,n,o,r,i,a,s,c,u,l,h,p,f,g,d=this;return z(this,function(e){switch(e.label){case 0:if(console.log("SyncProcessList:",this.SyncProcessList),console.log("Sync Func:",_),!this.devcieService.getNetworkState())return[3,17];e.label=1;case 1:return e.trys.push([1,14,15,16]),y||(_=_.filter(function(e){return!d.SyncProcessList.includes(e)})),this.SyncProcessList=m(this.SyncProcessList,_),o=[],r=[],_.forEach(function(e){Object.keys(d.FuncAPIMap).includes(e)&&(1<d.FuncAPIMap[e].length?r=m(r,d.FuncAPIMap[e]):o=m(o,d.FuncAPIMap[e]))}),console.log("SeqSync before uniq:",r),console.log("parallelSync before uniq:",o),r=T.uniq(r),o=T.uniq(o),console.log("SeqSync after uniq:",r),console.log("parallelSync after uniq:",o),console.log("SyncProcessList after uniq:",this.SyncProcessList),"DEV"==this.APP_CONFIG.ENV?[2]:(i=[],(a=this.DaoFactory.getDao("Profile"))?(s=this.DaoFactory.getTable("Profile","TW_LH_SD_DataSync_Time"),[4,a.queryByTable(s).toPromise()]):[3,12]);case 2:return c=e.sent(),console.log("dataSyncTime resp:",c),u=c.Body,o.forEach(function(e){i.push(d.getSyncPromiseObject(e,u,a))}),[4,Promise.all(i)];case 3:e.sent(),e.label=4;case 4:e.trys.push([4,9,10,11]),l=$(r),h=l.next(),e.label=5;case 5:return h.done?[3,8]:(p=h.value,[4,this.getSyncPromiseObject(p,u,a)]);case 6:e.sent(),e.label=7;case 7:return h=l.next(),[3,5];case 8:return[3,11];case 9:return f=e.sent(),t={error:f},[3,11];case 10:try{h&&!h.done&&(n=l["return"])&&n.call(l)}finally{if(t)throw t.error}return[7];case 11:return[3,13];case 12:throw new Error("Cannot Find Profile DAO.");case 13:return[3,16];case 14:return g=e.sent(),this.errorHandler.handleError(new D("F00110",g.message)),[3,16];case 15:return this.SyncProcessList=this.SyncProcessList.filter(function(e){return!_.includes(e)}),[7];case 16:return[3,18];case 17:console.log("It's offline now, skip syncFunc:",_),e.label=18;case 18:return[2]}})})},e.prototype.sync=function(f,g){return I(this,void 0,void 0,function(){var t,n,o,r,i,a,s,c,u,l,h,p;return z(this,function(e){switch(e.label){case 0:t=g.filter(function(e){return e.FuncID==f}).map(function(e){return e.BackendTime})[0],n=Date.now(),e.label=1;case 1:return e.trys.push([1,14,15,16]),o=this.syncAPIMap[f],r=this.func_url[f],i=g.filter(function(e){return e.FuncID==f}).map(function(e){return e.BackendTime})[0],a=g.filter(function(e){return e.FuncID==f}).map(function(e){return e.FrontendTime})[0],console.group("last sync "+f+" time:"),console.log("backendTime:",i),console.log("frontendTime:",a),console.groupEnd(),o.getState()!==lo.AVAILABLE?[3,11]:(o.setState(lo.PENDING),this.updateState(),[4,o.getSequentialIDNeeded(a)]);case 2:return s=e.sent(),console.log("sequenceID need:",s),0<s?[4,this.getSequentialID(f,s)]:[3,5];case 3:return c=e.sent(),[4,o.setSequentialID(c)];case 4:e.sent(),e.label=5;case 5:return[4,o.getPushJson(a)];case 6:return u=e.sent(),console.log("pushJson:",u),0<u.length?[4,this.pushToServer({data:u,url:r.push})]:[3,8];case 7:e.sent(),e.label=8;case 8:return[4,this.pullFromServer({backendTime:i,url:r.pull})];case 9:return l=e.sent(),console.log("pullJson:",l),[4,this.syncAPIMap[f].pullData(l)];case 10:if(h=e.sent(),console.log("pull result:",h),!h.Header.status)throw new Error(h.Header.msg);return t=K.parseISO(l.lastUpdateTime).getTime(),n=Date.now(),[3,13];case 11:return[4,this.waitUntilSyncFinish(f)];case 12:e.sent(),e.label=13;case 13:return[3,16];case 14:return p=e.sent(),n=g.filter(function(e){return e.FuncID==f}).map(function(e){return e.FrontendTime})[0],this.errorHandler.handleError(new D("F00113",f+" sync failed,"+p.message)),[3,16];case 15:return this.syncAPIMap[f].setState(lo.AVAILABLE),this.updateState(),[2,Promise.resolve({backendTime:t,frontendTime:n})];case 16:return[2]}})})},e.prototype.pushToServer=function(e){var n=e.data,o=e.url;return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return(t=this.APIFactory.getAPI("SyncPush")).url=o,t.body=n,[4,this.dispatcher.dispatch(t).toPromise()];case 1:return e.sent(),[2]}})})},e.prototype.pullFromServer=function(e){var n=e.backendTime,o=e.url;return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return(t=this.APIFactory.getAPI("SyncPull")).lastUpdateTime=new Date(n).toISOString(),t.url=o,[4,this.dispatcher.dispatch(t).toPromise().then(function(e){return console.log("data from server:",e),e})];case 1:return[2,e.sent()]}})})},e.prototype.getSequentialID=function(e,t){var n=this.APIFactory.getAPI("getSyncSequenceID");if(n)return n.type=e,n.num=t,this.dispatcher.dispatch(n).toPromise().then(function(e){return console.log("get sync sequence ID resp:",e),e.ids})},e.prototype.getCurrentSyncState=function(){var t=this,n={};return Object.keys(this.syncAPIMap).forEach(function(e){n[e]=t.syncAPIMap[e].getState()}),n},e.prototype.updateState=function(){this.syncStateSubject.next(this.getCurrentSyncState())},e.prototype.waitUntilSyncFinish=function(t){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,this.getSyncState().pipe(a.first(function(e){return 0<Object.entries(e).filter(function(e){return e[0]===t&&e[1]===lo.AVAILABLE}).length})).toPromise()]})})},e.prototype.getSyncPromiseObject=function(a,s,c){return I(this,void 0,void 0,function(){var t,n,o,r,i;return z(this,function(e){switch(e.label){case 0:return[4,this.sync(a,s)];case 1:return t=e.sent(),n=t.backendTime,o=t.frontendTime,(r=this.DaoFactory.getTable("Profile","TW_LH_SD_DataSync_Time")).addRestriction(new Bt("FuncID",[a])),r.setValue("BackendTime",n),r.setValue("FrontendTime",o),[4,c.updateByTable(r).toPromise()];case 2:return i=e.sent(),console.log("Finish sync function "+a+" :",i),[2,i]}})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:u.Inject,args:[_]}]},{type:p},{type:nt},{type:u.ErrorHandler},{type:Nt},{type:We},{type:undefined,decorators:[{type:u.Inject,args:[N]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(_),u.inject(p),u.inject(nt),u.inject(u.ErrorHandler),u.inject(Nt),u.inject(We),u.inject(N))},token:e,providedIn:"root"}),e}(),po=function(){function e(e,t,n,o){this.DaoFactory=e,this.APIFactory=t,this.dispatcher=n,this.errorHandler=o}return e.prototype.pushErrorLog=function(){return L.from(this._pushErrorLog())},e.prototype.pushActionLog=function(){return L.from(this._pushActionLog())},e.prototype._pushErrorLog=function(){return I(this,void 0,void 0,function(){var t,n,o,r,i,a,s;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),console.log("into pushErrorLog()"),t=this.DaoFactory.getDao("Profile"),(n=this.DaoFactory.getTable("Profile","TW_LH_SD_Error_Log"))?(n.addRestriction(new Ot("IsSend",["Y"])),[4,t.queryByTable(n).toPromise()]):[3,4];case 1:return(o=e.sent()).Header.status?(console.log("error log table data:",o.Body),r=o.Body,(i=this.APIFactory.getAPI("PushErrorLog")).errorList=r,[4,this.dispatcher.dispatch(i).toPromise()]):[3,4];case 2:return a=e.sent(),console.log("push error Log resp:",a),a.success?(n=this.DaoFactory.getTable("Profile","TW_LH_SD_Error_Log"),[4,t.deleteByTable(n).toPromise()]):[3,4];case 3:s=e.sent(),console.log("deleteResp:",s),e.label=4;case 4:return[3,6];case 5:return e.sent(),this.errorHandler.handleError(new Error("pushErrorLog fail!")),[3,6];case 6:return[2]}})})},e.prototype._pushActionLog=function(){return I(this,void 0,void 0,function(){var t,n,o,r,i,a,s;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),console.log("into pushActionLog()"),t=this.DaoFactory.getDao("Profile"),(n=this.DaoFactory.getTable("Profile","TW_LH_SD_Action_Log")).addRestriction(new Ot("IsSend",["Y"])),[4,t.queryByTable(n).toPromise()];case 1:return(o=e.sent()).Header.status?(console.log("Action log table data:",o.Body),r=o.Body,(i=this.APIFactory.getAPI("PushActionLog")).actionList=r,[4,this.dispatcher.dispatch(i).toPromise()]):[3,4];case 2:return a=e.sent(),console.log("push action Log resp:",a),a.success?(n=this.DaoFactory.getTable("Profile","TW_LH_SD_Action_Log"),[4,t.deleteByTable(n).toPromise()]):[3,4];case 3:s=e.sent(),console.log("deleteResp:",s),e.label=4;case 4:return[3,6];case 5:return e.sent(),this.errorHandler.handleError(new Error("pushActionLog fail!")),[3,6];case 6:return[2]}})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:Nt},{type:p},{type:nt},{type:u.ErrorHandler}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(Nt),u.inject(p),u.inject(nt),u.inject(u.ErrorHandler))},token:e,providedIn:"root"}),e}(),fo=function(){function e(e,t,n){this.dispatcher=e,this.translateService=t,this.APIFactory=n,this.profileCodeTypeMap=new Map,this.profileCodeMap=new Map}return e.prototype.getCodeArray=function(e){if(0==this.profileCodeTypeMap.size)return new Array;var t=this.profileCodeTypeMap.get(e);return t==undefined&&(t=new Array),m(t)},e.prototype.convertCode2Text=function(e,t){if(0!=this.profileCodeMap.size&&t!=undefined){var n=this.profileCodeMap.get(e+"_"+t);if(n!=undefined){var o=n.getMappingID();return this.translateService.translate(o)}}return t},e.prototype.getArgumentsByCode=function(e,t){if(0!=this.profileCodeMap.size){var n=this.profileCodeMap.get(e+"_"+t);if(n!=undefined)return n.getArguments()}return null},e.prototype._fetchCodeData=function(){var h=this,e=this.APIFactory.getAPI("getProfileCode");return console.debug("profile-code.service fetchCodeData",e),L.Observable.create(function(l){h.dispatcher.dispatch(e).subscribe(function(e){h.profileCodeTypeMap.clear(),h.profileCodeMap.clear();var t=e.Body;console.log("<--- Datas ---\x3e"),console.log(e);for(var n=0;n<t.length;n++){var o=t[n],r=Object.create(tn.prototype),i=(r=Object.assign(r,o)).getTypeId(),a=r.getCode(),s=r.getMappingID(),c=h.translateService.translate(s);r.setDisplayText(c);var u=h.profileCodeTypeMap.get(i);u==undefined&&(u=new Array),u.push(r),h.profileCodeMap.set(i+"_"+a,r),h.profileCodeTypeMap.set(i,u)}console.debug("profileCodeMap",h.profileCodeMap),console.debug("profileCodeTypeMap",h.profileCodeTypeMap),l.next(!0),l.complete()})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:nt},{type:rt},{type:p}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(nt),u.inject(rt),u.inject(p))},token:e,providedIn:"root"}),e}(),go=function(){function e(e,t,n,o,r,i,a){this.versionCheck=e,this.syncService=t,this.logService=n,this.profileCodeService=o,this.notificationMgr=r,this.settingService=i,this.pushIDMgr=a,this.loadedSubject=new L.Subject}return e.prototype.loading=function(){this._loading()},e.prototype.onLoaded=function(){return this.loadedSubject.asObservable()},e.prototype._loading=function(){return I(this,void 0,void 0,function(){var t,n=this;return z(this,function(e){switch(e.label){case 0:return[4,this.syncService.syncAllFunc(!0)];case 1:return e.sent(),this.loadedSubject.next(50),[4,this.profileCodeService._fetchCodeData().toPromise()];case 2:return e.sent(),this.loadedSubject.next(60),[4,this.logService.pushActionLog().toPromise()];case 3:return e.sent(),this.loadedSubject.next(70),[4,this.logService.pushErrorLog().toPromise()];case 4:return e.sent(),this.loadedSubject.next(80),[4,this.notificationMgr.init()];case 5:return e.sent(),this.loadedSubject.next(85),[4,this.settingService.deviceChange(this.pushIDMgr.getPushID())];case 6:return e.sent(),this.loadedSubject.next(88),[4,this.versionCheck.checkVersion().toPromise()];case 7:return(t=e.sent()).isSuccess?(this.loadedSubject.next(95),t.newVersion?this.notificationMgr.pushNotification(Ye.NewVersionLogin,t.appVersion):setTimeout(function(){n.loadedSubject.next(100)},800)):(console.log("Check version error!!"),this.loadedSubject.next(100)),[2]}})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:uo},{type:ho},{type:po},{type:fo},{type:Qe},{type:$t},{type:undefined,decorators:[{type:u.Optional},{type:u.Inject,args:[H]}]}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(uo),u.inject(ho),u.inject(po),u.inject(fo),u.inject(Qe),u.inject($t),u.inject(H,8))},token:e,providedIn:"root"}),e}(),_o=function(){function e(e){this.url=e}return e.prototype.getUrl=function(){return this.url},e}(),yo=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.DaoFactory=e,this.PushAOP=t,this.PullAOP=n,this.tmpPushData=null,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"CALENDAR"},e.prototype.getPushJson=function(a){return I(this,void 0,void 0,function(){var t,n,o,r,i;return z(this,function(e){switch(e.label){case 0:return this.DaoFactory.getDefaultDao(),t=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar_Extension"),n=[],[4,this.getCustomerIDMap()];case 1:return o=e.sent(),[4,this.getPushData(a)];case 2:return r=e.sent(),i=t.getColumns().filter(function(e){return"ClientID"!==e.getName()&&"CalendarID"!==e.getName()}),n=r.map(function(t){var e=i.map(function(e){return{id:e.getName(),type:e.getType(),value:t[e.getName()]}});return{appointmentId:t.CalendarID,name:t.Title,meetingLocation:t.Location,appointmentType:t.CalendarType,allDay:"Y"===t.IsAllDay,startDateTime:new Date(t.StartTime).toISOString(),endDateTime:new Date(t.EndTime).toISOString(),alertTimes:[t.Alert1,t.Alert2,t.Alert3].filter(function(e){return null!=e&&""!=e}),personId:o[t.CustomerClientID]?o[t.CustomerClientID]:"",description:t.Remark,isChangeable:"OPUS"!==t.DataSource,extensions:e,synchDetail:{clientTime:new Date(t.ClientTime).toISOString(),lastUpdateDateTimeBackend:new Date(t.DataTime).toISOString(),toDelete:"Y"===t.IsDelete}}}),this.PushAOP?[4,this.PullAOP.execute(n)]:[3,4];case 3:n=e.sent(),e.label=4;case 4:return[2,n]}})})},e.prototype.pullData=function(v){return I(this,void 0,void 0,function(){var o,r,i,a,s,c,u,l,h,p,f,g,d,_,y,T,m,D,I,S;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(v)]:[3,2];case 1:v=e.sent(),e.label=2;case 2:return 0<v.appointments.length||0<v.deletedAppointmentIds.length?(s=this.DaoFactory.getDefaultDao(),c=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar"),u=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar_Extension"),[4,this.getCustomerIDMap(!0)]):[3,6];case 3:return l=e.sent(),[4,s.queryByTable(c).toPromise().then(function(e){return e.Body})];case 4:h=e.sent(),p=h.map(function(e){return e.CalendarID}),f=h.map(function(e){return e.ClientID}),console.log("calendar ID array:",p),console.log("calendar Client ID array:",f);try{for(g=$(v.appointments),d=g.next();!d.done;d=g.next())_=d.value,y=0<_.alertTimes.length?"Y":"N",c=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar"),u=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar_Extension"),c.setValue("CalendarID",_.appointmentId),c.setValue("Title",_.name),c.setValue("Location",_.meetingLocation),c.setValue("CalendarType",_.appointmentType),c.setValue("IsAllDay",_.allDay?"Y":"N"),c.setValue("StartTime",K.parseISO(_.startDateTime).getTime()),c.setValue("EndTime",K.parseISO(_.endDateTime).getTime()),c.setValue("CustomerClientID",l[_.personId]),c.setValue("IsAlert",y),y&&c.setValue("Alert1",_.alertTimes[0]),1<_.alertTimes.length&&c.setValue("Alert2",_.alertTimes[1]),2<_.alertTimes.length&&c.setValue("Alert3",_.alertTimes[2]),c.setValue("Remark",_.description),c.setValue("IsDelete","N"),c.setValue("DataSource",_.isChangeable?"APP":"OPUS"),c.setValue("DataTime",K.parseISO(_.synchDetail.lastUpdateDateTimeBackend).getTime()),c.setValue("ClientTime",Date.now()),T=_.extensions,c.setValue("CalendarID",_.appointmentId),u.setValue("CalendarID",_.appointmentId),null!=T&&T.forEach(function(e){u.setValue(e.id,e.value)}),p.includes(_.appointmentId)?(c.addRestriction(new Bt("CalendarID",[_.appointmentId])),u.addRestriction(new Bt("CalendarID",[_.appointmentId])),s.transactionUpdate(c),s.transactionUpdate(u)):(m=Q.v4(),c.setValue("ClientID",m),u.setValue("ClientID",m),s.transactionInsert(c),s.transactionInsert(u))}catch(t){o={error:t}}finally{try{d&&!d.done&&(r=g["return"])&&r.call(g)}finally{if(o)throw o.error}}try{for(D=$(v.deletedAppointmentIds),I=D.next();!I.done;I=D.next())S=I.value,c=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar"),u=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar_Extension"),c.addRestriction(new Bt("CalendarID",[S])),u.addRestriction(new Bt("CalendarID",[S])),s.transactionDelete(c),s.transactionDelete(u)}catch(n){i={error:n}}finally{try{I&&!I.done&&(a=D["return"])&&a.call(D)}finally{if(i)throw i.error}}return[4,s.runTransaction().toPromise()];case 5:return[2,e.sent()];case 6:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return[4,this.getPushData(n)];case 1:return t=e.sent(),this.tmpPushData=t.filter(function(e){return null===e.CalendarID}),[2,this.tmpPushData.length]}})})},e.prototype.setSequentialID=function(f){return I(this,void 0,void 0,function(){var n,o,r,i,a,s,c,u,l,h,p;return z(this,function(e){switch(e.label){case 0:if(null==this.tmpPushData)return[3,2];r=this.tmpPushData,i=this.DaoFactory.getDefaultDao();try{for(a=$(r.entries()),s=a.next();!s.done;s=a.next())c=g(s.value,2),u=c[0],l=c[1],h=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar"),p=this.DaoFactory.getDefaultTable("TW_LH_SD_Calendar_Extension"),h.setValue("CalendarID",f[u]),h.addRestriction(new Bt("ClientID",[l.ClientID])),i.transactionUpdate(h),p.setValue("CalendarID",f[u]),p.addRestriction(new Bt("ClientID",[l.ClientID])),i.transactionUpdate(p)}catch(t){n={error:t}}finally{try{s&&!s.done&&(o=a["return"])&&o.call(a)}finally{if(n)throw n.error}}return[4,i.runTransaction().toPromise()];case 1:e.sent(),this.tmpPushData=null,e.label=2;case 2:return[2]}})})},e.prototype.getPushData=function(i){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return t=[],n=this.DaoFactory.getDefaultDao(),o=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Calendar"),n&&o?(o.addRestriction(new Yt("ClientTime",[i])),[4,n.queryByTable(o).toPromise()]):[3,2];case 1:r=e.sent(),console.log("query calendar obj:",r),0<r.Body.length&&(t=r.Body),e.label=2;case 2:return[2,t]}})})},e.prototype.getCustomerIDMap=function(i){return void 0===i&&(i=!1),I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return t=this.DaoFactory.getDefaultDao(),n=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),t&&n?[4,t.queryByTable(n).toPromise()]:[3,2];case 1:if(o=e.sent(),console.log("query customer obj:",o),0<o.Body.length)return r=o.Body,[2,(r=i?r.map(function(e){return{key:e.CustomerID,val:e.ClientID}}):r.map(function(e){return{key:e.ClientID,val:e.CustomerID}})).reduce(function(e,t){return e[t.key]=t.val,e},{})];e.label=2;case 2:return[2,{}]}})})},e}(),To=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.DaoFactory=e,this.PushAOP=t,this.PullAOP=n,this.tmpPushData=null,this.customerData=null,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"CUSTOMER_CONTACT"},e.prototype.getPushJson=function(i){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return t=[],[4,this.getPushData(i)];case 1:return n=e.sent(),o=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact_Extension"),r=o.getColumns().filter(function(e){return"ClientID"!==e.getName()&&"CustomerClientID"!==e.getName()&&"ContactID"!==e.getName()}),t=n.map(function(t){var e=r.map(function(e){return{id:e.getName(),type:e.getType(),value:t[e.getName()]}});return{noteId:t.ContactID,personId:t.CustomerID,text:t.Note,origin:"",creationDateTime:new Date(t.NoteTime).toISOString(),extensions:e,synchDetail:{lastUpdateDateTimeBackend:new Date(t.DataTime).toISOString(),toDelete:"Y"===t.IsDelete}}}),this.PushAOP?[4,this.PullAOP.execute(t)]:[3,3];case 2:t=e.sent(),e.label=3;case 3:return[2,t]}})})},e.prototype.pullData=function(_){return I(this,void 0,void 0,function(){var n,o,r,i,a,s,c,u,l,h,p,f,g,d;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(_)]:[3,2];case 1:_=e.sent(),e.label=2;case 2:return 0<_.notes.length||0<_.deletedNoteIds.length?(r=this.DaoFactory.getDefaultDao(),i=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact"),a=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact_Extension"),this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),[4,r.queryByTable(i).toPromise().then(function(e){return e.Body.map(function(e){return e.ContactID})})]):[3,5];case 3:s=e.sent(),c=this.customerData,u=c.Body.map(function(e){return e.ClientID}),l=c.Body.map(function(e){return e.CustomerID});try{for(h=$(_.notes),p=h.next();!p.done;p=h.next())f=p.value,i=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact"),a=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact_Extension"),i.setValue("CustomerClientID",u[l.indexOf(f.personId)]),i.setValue("ContactID",f.noteId),i.setValue("Note",f.text),i.setValue("NoteTime",K.parseISO(f.creationDateTime).getTime()),i.setValue("DataTime",K.parseISO(f.synchDetail.lastUpdateDateTimeBackend).getTime()),i.setValue("IsDelete","N"),i.setValue("ClientTime",Date.now()),g=f.extensions,i.setValue("CustomerClientID",u[l.indexOf(f.personId)]),i.setValue("ContactID",f.noteId),a.setValue("CustomerClientID",u[l.indexOf(f.personId)]),a.setValue("ContactID",f.noteId),null!=g&&g.forEach(function(e){a.setValue(e.id,e.value)}),s.includes(f.noteId)?(i.addRestriction(new Bt("ContactID",[f.noteId])),a.addRestriction(new Bt("ContactID",[f.noteId])),r.transactionUpdate(i),r.transactionUpdate(a)):(d=Q.v4(),i.setValue("ClientID",d),a.setValue("ClientID",d),r.transactionInsert(i),r.transactionInsert(a))}catch(t){n={error:t}}finally{try{p&&!p.done&&(o=h["return"])&&o.call(h)}finally{if(n)throw n.error}}return 0<_.deletedNoteIds.length&&(i=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact"),a=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact_Extension"),i.addRestriction(new qt("ContactID",_.DeleteIds)),a.addRestriction(new qt("ContactID",_.DeleteIds)),r.transactionDelete(i),r.transactionDelete(a)),[4,r.runTransaction().toPromise()];case 4:return[2,e.sent()];case 5:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return[4,this.getPushData(n)];case 1:return t=e.sent(),this.tmpPushData=t.filter(function(e){return null===e.ContactID}),[2,this.tmpPushData.length]}})})},e.prototype.setSequentialID=function(f){return I(this,void 0,void 0,function(){var n,o,r,i,a,s,c,u,l,h,p;return z(this,function(e){switch(e.label){case 0:if(null==this.tmpPushData)return[3,2];r=this.tmpPushData,i=this.DaoFactory.getDefaultDao();try{for(a=$(r.entries()),s=a.next();!s.done;s=a.next())c=g(s.value,2),u=c[0],l=c[1],h=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact"),p=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Contact_Extension"),h.setValue("ContactID",f[u]),p.setValue("ContactID",f[u]),h.addRestriction(new Bt("ClientID",[l.ClientID])),p.addRestriction(new Bt("ClientID",[l.ClientID])),i.transactionUpdate(h),i.transactionUpdate(p)}catch(t){n={error:t}}finally{try{s&&!s.done&&(o=a["return"])&&o.call(a)}finally{if(n)throw n.error}}return[4,i.runTransaction().toPromise()];case 1:e.sent(),this.tmpPushData=null,e.label=2;case 2:return[2]}})})},e.prototype.getPushData=function(d){return I(this,void 0,void 0,function(){var n,o,r,i,a,s,c,u,l,h,p,f,g;return z(this,function(e){switch(e.label){case 0:return r=[],i=this.DaoFactory.getDefaultDao(),a=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),s=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer_Contact"),[4,i.queryByTable(a).toPromise()];case 1:return c=e.sent(),this.customerData=c,u=c.Body,i&&s?(s.addRestriction(new Yt("ClientTime",[d])),[4,i.queryByTable(s).toPromise()]):[3,3];case 2:if(l=e.sent(),console.log("query contact obj:",l),console.log("customer array:",u),0<l.Body.length){h=function(t){var e=u.filter(function(e){return e.ClientID==t.CustomerClientID});0<e.length&&(t.CustomerID=e[0].CustomerID)};try{for(p=$(l.Body),f=p.next();!f.done;f=p.next())g=f.value,h(g)}catch(t){n={error:t}}finally{try{f&&!f.done&&(o=p["return"])&&o.call(p)}finally{if(n)throw n.error}}r=l.Body}e.label=3;case 3:return[2,r]}})})},e}(),mo=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.DaoFactory=e,this.PushAOP=t,this.PullAOP=n,this.tmpPushData=null,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"CUSTOMER"},e.prototype.getPushJson=function(h){return I(this,void 0,void 0,function(){var t,n,o,r,i,a,s,c,u,l;return z(this,function(e){switch(e.label){case 0:return t=[],[4,this.getPushData(h)];case 1:return n=e.sent(),o=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Extension"),r=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Tel_Extension"),i=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Email_Extension"),a=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Address_Extension"),s=o.getColumns().filter(function(e){return"ClientID"!==e.getName()&&"CustomerID"!==e.getName()}),c=r.getColumns().filter(function(e){return"ClientID"!==e.getName()&&"CustomerClientID"!==e.getName()}),u=i.getColumns().filter(function(e){return"ClientID"!==e.getName()&&"CustomerClientID"!==e.getName()}),l=a.getColumns().filter(function(e){return"ClientID"!==e.getName()&&"CustomerClientID"!==e.getName()}),t=n.map(function(t){var e=s.map(function(e){return{id:e.getName(),type:e.getType(),value:t[e.getName()]}});return{customerID:t.CustomerID,firstName:t.FirstName,middleName:"",lastName:t.LastName,alternateName:"",marritalStatus:t.Marriage,occupation:t.Occupation,employer:t.Company,birthDate:"null"===t.BirthdayYear||null===t.BirthdayYear?null:t.BirthdayYear+"-"+t.BirthdayMonth+"-"+t.BirthdayDate,ageRange:t.AgeRange,gender:t.Gender,numberOfChildren:t.Children,addresses:t.Address.map(function(t){var e=l.map(function(e){return{id:e.getName(),type:e.getType(),value:t[e.getName()]}});return{addressType:t.AddressType,countryCode:t.Country,city:t.City,area:t.Area,postCode:t.Zipcode,line1:t.Address,line2:"",line3:"",line4:"",isChangeable:"OPUS"!==t.DataSource,extensions:e}}),phoneChannels:t.Tel.map(function(t){var e=c.map(function(e){return{id:e.getName(),type:e.getType(),value:t[e.getName()]}});return{usageType:t.TelType,phoneNumber:t.Tel,isChangeable:"OPUS"!==t.DataSource,extensions:e}}),emailContacts:t.Email.map(function(t){var e=u.map(function(e){return{id:e.getName(),type:e.getType(),value:t[e.getName()]}});return{emailType:t.EmailType,email:t.Email,isChangeAble:"OPUS"!==t.DataSource,extensions:e}}),annualIncomeRange:t.Income,contactLink:t.Source,familiarity:t.Familiarity,touchPointFrequency:t.ContactFrequancy,leadProbability:t.Possibility,isFollowed:"Y"===t.IsFollow,isOverTimeAlert:"Y"===t.IsOverTimeAlert,isChangeable:"OPUS"!==t.DataSource,profileCompletion:t.Completeness,extensions:e,synchDetail:{clientTime:new Date(t.ClientTime).toISOString(),lastUpdateDateTimeBackend:new Date(t.DataTime).toISOString(),toDelete:"Y"===t.IsDelete}}}),console.log("customer getPushJson:",t),this.PushAOP?[4,this.PullAOP.execute(t)]:[3,3];case 2:t=e.sent(),e.label=3;case 3:return[2,t]}})})},e.prototype.pullData=function(J){return I(this,void 0,void 0,function(){var i,a,s,c,u,l,h,p,f,g,d,_,y,T,m,D,I,S,v,P,A,C,b,E,L,N,O,F,w,M,R,j,k,V,H,G,x,W,B,U,Y,q,X;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(J)]:[3,2];case 1:J=e.sent(),e.label=2;case 2:return 0<J.customerInfos.length||0<J.deletedPersonIds.length?(f=this.DaoFactory.getDefaultDao(),g=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),d=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Tel"),_=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Email"),y=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Address"),T=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Extension"),m=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Email_Extension"),D=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Address_Extension"),I=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Tel_Extension"),[4,f.queryByTable(g).toPromise()]):[3,5];case 3:S=e.sent(),v=S.Body.map(function(e){return e.ClientID}),P=S.Body.map(function(e){return e.CustomerID}),A=J.customerInfos.map(function(e){return e.customerID}),C=S.Body.filter(function(e){return-1<A.indexOf(e.CustomerID)}).map(function(e){return e.ClientID}),d.addRestriction(new qt("CustomerClientID",C)),_.addRestriction(new qt("CustomerClientID",C)),y.addRestriction(new qt("CustomerClientID",C)),I.addRestriction(new qt("CustomerClientID",C)),m.addRestriction(new qt("CustomerClientID",C)),D.addRestriction(new qt("CustomerClientID",C)),f.transactionDelete(d),f.transactionDelete(_),f.transactionDelete(y),f.transactionDelete(I),f.transactionDelete(m),f.transactionDelete(D);try{for(b=$(J.customerInfos),E=b.next();!E.done;E=b.next()){L=E.value,N="",g=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer"),T=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Extension"),m=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Email_Extension"),D=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Address_Extension"),I=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Tel_Extension"),g.setValue("CustomerID",L.customerID),g.setValue("FirstName",L.firstName),g.setValue("LastName",L.lastName),g.setValue("Occupation",L.occupation),g.setValue("Company",L.employer),g.setValue("BirthdayYear",null===L.birthDate||0<=L.birthDate.indexOf("null")?null:L.birthDate.split("-")[0]),g.setValue("BirthdayMonth",null===L.birthDate||0<=L.birthDate.indexOf("null")?null:L.birthDate.split("-")[1]),g.setValue("BirthdayDate",null===L.birthDate||0<=L.birthDate.indexOf("null")?null:L.birthDate.split("-")[2]),g.setValue("AgeRange",L.ageRange),g.setValue("Gender",L.gender),g.setValue("Income",L.annualIncomeRange),g.setValue("Source",L.contactLink),g.setValue("Marriage",L.marritalStatus),g.setValue("Children",L.numberOfChildren),g.setValue("Familiarity",L.familiarity),g.setValue("ContactFrequancy",L.touchPointFrequency),g.setValue("Possibility",L.leadProbability),g.setValue("IsFollow",L.isFollowed?"Y":"N"),g.setValue("IsDelete","N"),g.setValue("Completeness",L.profileCompletion),g.setValue("DataSource",L.isChangeable?"APP":"OPUS"),g.setValue("DataTime",K.parseISO(L.synchDetail.lastUpdateDateTimeBackend).getTime()),g.setValue("IsOverTimeAlert",L.isOverTimeAlert),g.setValue("ClientTime",Date.now()),O=L.extensions,T.setValue("CustomerID",L.customerID),console.log("customer Extensions",O),null!=O&&O.forEach(function(e){T.setValue(e.id,e.value)}),P.includes(L.customerID)?(N=v[P.indexOf(L.customerID)],g.addRestriction(new Bt("CustomerID",[L.customerID])),T.addRestriction(new Bt("CustomerID",[L.customerID])),f.transactionUpdate(g),f.transactionUpdate(T)):(N=Q.v4(),g.setValue("ClientID",N),T.setValue("ClientID",N),f.transactionInsert(g),f.transactionInsert(T));try{for(F=$(L.emailContacts),w=F.next();!w.done;w=F.next())M=w.value,R=Q.v4(),(_=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Email")).setValue("ClientID",R),_.setValue("CustomerClientID",N),_.setValue("EmailType",M.emailType),_.setValue("Email",M.email),_.setValue("DataSource",M.isChangeAble?"APP":"OPUS"),j=M.extensions,m.setValue("ClientID",R),m.setValue("CustomerClientID",N),console.log("emailExtensions",j),null!=j&&j.forEach(function(e){m.setValue(e.id,e.value)}),f.transactionInsert(m),f.transactionInsert(_)}catch(t){s={error:t}}finally{try{w&&!w.done&&(c=F["return"])&&c.call(F)}finally{if(s)throw s.error}}try{for(k=$(L.addresses),V=k.next();!V.done;V=k.next())H=V.value,G=Q.v4(),(y=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Address")).setValue("ClientID",G),y.setValue("CustomerClientID",N),y.setValue("AddressType",H.addressType),y.setValue("Country",H.countryCode),y.setValue("City",H.city),y.setValue("Area",H.area),y.setValue("Zipcode",H.postCode),y.setValue("Address",H.line1),y.setValue("DataSource",H.isChangeAble?"APP":"OPUS"),x=H.extensions,D.setValue("ClientID",G),D.setValue("CustomerClientID",N),console.log("addressExtensions",x),null!=x&&x.forEach(function(e){D.setValue(e.id,e.value)}),f.transactionInsert(D),f.transactionInsert(y)}catch(n){u={error:n}}finally{try{V&&!V.done&&(l=k["return"])&&l.call(k)}finally{if(u)throw u.error}}try{for(W=$(L.phoneChannels),B=W.next();!B.done;B=W.next())U=B.value,Y=Q.v4(),(d=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Tel")).setValue("ClientID",Y),d.setValue("CustomerClientID",N),d.setValue("TelType",U.usageType),d.setValue("Tel",U.phoneNumber),d.setValue("DataSource",U.isChangeable?"APP":"OPUS"),q=U.extensions,I.setValue("ClientID",Y),I.setValue("CustomerClientID",N),console.log("telExtensions",q),null!=q&&q.forEach(function(e){I.setValue(e.id,e.value)}),f.transactionInsert(I),f.transactionInsert(d)}catch(o){h={error:o}}finally{try{B&&!B.done&&(p=W["return"])&&p.call(W)}finally{if(h)throw h.error}}}}catch(r){i={error:r}}finally{try{E&&!E.done&&(a=b["return"])&&a.call(b)}finally{if(i)throw i.error}}return 0<(X=J.deletedPersonIds.map(function(t){var e=S.Body.filter(function(e){return e.CustomerID===t});return 0<e.length?e[0].ClientID:null}).filter(function(e){return null!==e})).length&&(g=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer"),_=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Email"),y=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Address"),d=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Tel"),m=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Email_Extension"),D=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Address_Extension"),I=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer_Tel_Extension"),g.addRestriction(new qt("CustomerID",J.deletedPersonIds)),_.addRestriction(new qt("CustomerClientID",X)),y.addRestriction(new qt("CustomerClientID",X)),d.addRestriction(new qt("CustomerClientID",X)),m.addRestriction(new qt("CustomerClientID",X)),D.addRestriction(new qt("CustomerClientID",X)),I.addRestriction(new qt("CustomerClientID",X)),f.transactionDelete(g),f.transactionDelete(_),f.transactionDelete(y),f.transactionDelete(d),f.transactionDelete(m),f.transactionDelete(D),f.transactionDelete(I)),[4,f.runTransaction().toPromise()];case 4:return[2,e.sent()];case 5:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(i){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return t=0,n=this.DaoFactory.getDefaultDao(),o=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),n&&o?(o.addRestriction(new Yt("ClientTime",[i])),[4,n.queryByTable(o).toPromise()]):[3,2];case 1:r=e.sent(),console.log("query customer obj:",r),this.tmpPushData=r.Body.filter(function(e){return null===e.CustomerID}),t=this.tmpPushData.length,e.label=2;case 2:return[2,t]}})})},e.prototype.setSequentialID=function(p){return I(this,void 0,void 0,function(){var n,o,r,i,a,s,c,u,l,h;return z(this,function(e){switch(e.label){case 0:if(null==this.tmpPushData)return[3,2];r=this.tmpPushData,i=this.DaoFactory.getDefaultDao();try{for(a=$(r.entries()),s=a.next();!s.done;s=a.next())c=g(s.value,2),u=c[0],l=c[1],(h=this.DaoFactory.getDefaultTable("TW_LH_SD_Customer")).setValue("CustomerID",p[u]),h.addRestriction(new Bt("ClientID",[l.ClientID])),i.transactionUpdate(h)}catch(t){n={error:t}}finally{try{s&&!s.done&&(o=a["return"])&&o.call(a)}finally{if(n)throw n.error}}return[4,i.runTransaction().toPromise()];case 1:e.sent(),this.tmpPushData=null,e.label=2;case 2:return[2]}})})},e.prototype.getPushData=function(D){return I(this,void 0,void 0,function(){var n,o,r,i,a,s,c,u,l,h,p,f,g,d,_,y,T,m;return z(this,function(e){switch(e.label){case 0:return r=[],i=this.DaoFactory.getDefaultDao(),a=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),i&&a?(a.addRestriction(new Yt("ClientTime",[D])),[4,i.queryByTable(a).toPromise()]):[3,5];case 1:return s=e.sent(),console.log("query customer obj:",s),0<s.Body.length?(c=s.Body,u=c.map(function(e){return e.ClientID}),i=this.DaoFactory.getDefaultDao(),l=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer_Tel"),h=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer_Email"),p=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer_Address"),l.addRestriction(new qt("CustomerClientID",u)),h.addRestriction(new qt("CustomerClientID",u)),p.addRestriction(new qt("CustomerClientID",u)),[4,i.queryByTable(l).toPromise()]):[3,5];case 2:return f=e.sent(),[4,i.queryByTable(h).toPromise()];case 3:return g=e.sent(),[4,i.queryByTable(p).toPromise()];case 4:d=e.sent(),_=function(t){t.Tel=f.Body.filter(function(e){return e.CustomerClientID==t.ClientID}),t.Email=g.Body.filter(function(e){return e.CustomerClientID==t.ClientID}),t.Address=d.Body.filter(function(e){return e.CustomerClientID==t.ClientID}),r.push(t)};try{for(y=$(c),T=y.next();!T.done;T=y.next())m=T.value,_(m)}catch(t){n={error:t}}finally{try{T&&!T.done&&(o=y["return"])&&o.call(y)}finally{if(n)throw n.error}}e.label=5;case 5:return[2,r]}})})},e}(),Do=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.DaoFactory=e,this.PushAOP=t,this.PullAOP=n,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"MESSAGE"},e.prototype.getPushJson=function(s){return I(this,void 0,void 0,function(){var t,n,o,r,i,a;return z(this,function(e){switch(e.label){case 0:return t=[],n=this.DaoFactory.getDefaultDao(),o=this.DaoFactory.getDefaultTable("TW_LH_SD_Message"),n&&o?(o.addRestriction(new Yt("ClientTime",[s])),[4,n.queryByTable(o).toPromise()]):[3,2];case 1:r=e.sent(),console.log("query message obj:",r),0<r.Body.length&&(i=r.Body,a=i.filter(function(e){return"Reading"===e.Status}).map(function(e){return e.MessageID}),t=a),e.label=2;case 2:return this.PushAOP?[4,this.PullAOP.execute(t)]:[3,4];case 3:t=e.sent(),e.label=4;case 4:return[2,t]}})})},e.prototype.pullData=function(m){return I(this,void 0,void 0,function(){var o,r,i,a,s,c,u,l,h,p,f,g,d,_,y,T;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(m)]:[3,2];case 1:m=e.sent(),e.label=2;case 2:return 0<m.messageInfos.length||0<m.deletedMessageIds.length?(s=this.DaoFactory.getDefaultDao(),c=this.DaoFactory.getDefaultTable("TW_LH_SD_Message"),u=this.DaoFactory.getDefaultTable("TW_LH_SD_Message_Extension"),[4,s.queryByTable(c).toPromise().then(function(e){return e.Body})]):[3,5];case 3:l=(l=e.sent()).map(function(e){return e.MessageID});try{for(h=$(m.messageInfos),p=h.next();!p.done;p=h.next())f=p.value,g=l.includes(f.messageID),c=this.DaoFactory.getDefaultTable("TW_LH_SD_Message"),u=this.DaoFactory.getDefaultTable("TW_LH_SD_Message_Extension"),c.setValue("MessageID",f.messageID),c.setValue("MessageCategory",f.messageCategory),c.setValue("MessageType",f.messageType),c.setValue("Title",f.title),c.setValue("Description",f.description),c.setValue("Arguments",f.arguments),c.setValue("Status",f.status),c.setValue("IsClick",f.isClick?"Y":"N"),c.setValue("IsPopup",f.isPopup?"Y":"N"),c.setValue("IsShow",f.isShow?"Y":"N"),c.setValue("LinkStatus",f.linkStatus),c.setValue("MessageTime",K.parseISO(f.messageTime).getTime()),c.setValue("ClientTime",Date.now()),c.setValue("IsDelete","N"),c.setValue("DataTime",K.parseISO(f.synchDetail.lastUpdateDateTimeBackend).getTime()),u.setValue("MessageID",f.messageID),g?(c.addRestriction(new Bt("MessageID",[f.messageID])),u.addRestriction(new Bt("MessageID",[f.messageID])),s.transactionUpdate(c),s.transactionUpdate(u)):(d=Q.v4(),c.setValue("ClientID",d),u.setValue("ClientID",d),s.transactionInsert(c),s.transactionInsert(u))}catch(t){o={error:t}}finally{try{p&&!p.done&&(r=h["return"])&&r.call(h)}finally{if(o)throw o.error}}try{for(_=$(m.deletedMessageIds),y=_.next();!y.done;y=_.next())T=y.value,c=this.DaoFactory.getDefaultTable("TW_LH_SD_Message"),u=this.DaoFactory.getDefaultTable("TW_LH_SD_Message_Extension"),c.addRestriction(new Bt("MessageID",[T])),u.addRestriction(new Bt("MessageID",[T])),s.transactionDelete(c),s.transactionDelete(u)}catch(n){i={error:n}}finally{try{y&&!y.done&&(a=_["return"])&&a.call(_)}finally{if(i)throw i.error}}return[4,s.runTransaction().toPromise()];case 4:return[2,e.sent()];case 5:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,-1]})})},e.prototype.setSequentialID=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2]})})},e}(),Io=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.DaoFactory=e,this.PushAOP=t,this.PullAOP=n,this.state=lo.AVAILABLE}return e.prototype.getName=function(){return"GOAL_EXPECTED"},e.prototype.getState=function(){return this.state},e.prototype.setState=function(e){this.state=e},e.prototype.getPushJson=function(t){return I(this,void 0,void 0,function(){var i;return z(this,function(e){switch(e.label){case 0:return i=[],[4,this.getPushData(t)];case 1:return e.sent().forEach(function(e){for(var t=[],n=1;n<=4;n++){var o={Qarter:n,Value:e["Q"+n]};t.push(o)}var r={DataYear:e.DataYear,FYFC:e.FYFC,ANP:e.ANP,Recruitments:t,synchDetail:{lastUpdateDateTimeBackend:new Date(e.DataTime).toISOString()},extensions:[]};i.push(r)}),this.PushAOP?[4,this.PullAOP.execute(i)]:[3,3];case 2:i=e.sent(),e.label=3;case 3:return[2,i]}})})},e.prototype.pullData=function(n){return I(this,void 0,void 0,function(){var l,h,p,t,f=this;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(n)]:[3,2];case 1:n=e.sent(),e.label=2;case 2:return n.GoalExpected&&0<n.GoalExpected.length?(l=this.DaoFactory.getDefaultDao(),h=this.DaoFactory.getDefaultTable("TW_LH_SD_Goal_Setting_Expected"),p=this.DaoFactory.getDefaultTable("TW_LH_SD_Goal_Setting_Expected_Extension"),console.log("GoalSettingExpected",h),null!=n.GoalExpected&&(t=n.GoalExpected,console.log("GoalExpectedDatas",t),t.forEach(function(e){var t,n;console.log("GoalExpectedData",e);var o=e.DataYear;if(console.log("ToDeleteGoalExpectedYears",o),null!=o){h.addRestriction(new Bt("DataYear",[o])),l.transactionDelete(h);var r=Q.v4();(h=f.DaoFactory.getDefaultTable("TW_LH_SD_Goal_Setting_Expected")).setValue("ClientID",r),h.setValue("DataYear",e.DataYear),h.setValue("FYFC",e.FYFC),h.setValue("ANP",e.ANP),h.setValue("DataTime",K.parseISO(e.synchDetail.lastUpdateDateTimeBackend).getTime()),h.setValue("ClientTime",Date.now()),p.setValue("ClientID",r);var i=e.Recruitments;try{for(var a=$(i),s=a.next();!s.done;s=a.next()){var c=s.value;h.setValue("Q"+c.Qarter,c.Value)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(n=a["return"])&&n.call(a)}finally{if(t)throw t.error}}console.log("GoalSettingExpected 2",h),l.transactionInsert(h),l.transactionInsert(p)}})),[4,l.runTransaction().toPromise()]):[3,4];case 3:return[2,e.sent()];case 4:return[2,new ot({status:!0},[])]}})})},e.prototype.getSequentialIDNeeded=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,-1]})})},e.prototype.setSequentialID=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2]})})},e.prototype.getPushData=function(i){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return t=[],n=this.DaoFactory.getDefaultDao(),o=this.DaoFactory.getDefaultTable("TW_LH_SD_VW_Goal_Setting_Expected"),n&&o?(o.addRestriction(new Yt("ClientTime",[i])),[4,n.queryByTable(o).toPromise()]):[3,2];case 1:r=e.sent(),console.log("query GoalExpected obj:",r),0<r.Body.length&&(t=r.Body),e.label=2;case 2:return[2,t]}})})},e}(),So=function(){function e(e,t,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this.apiFactory=e,this.dispatcher=t,this.PushAOP=n,this.PullAOP=o,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"GOAL"},e.prototype.getPushJson=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,[]]})})},e.prototype.pullData=function(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(n)]:[3,2];case 1:n=e.sent(),e.label=2;case 2:return 0<n.Goals.length?((t=this.apiFactory.getAPI("saveGoal")).GoalDatas=n.Goals,[4,this.dispatcher.dispatch(t).toPromise()]):[3,4];case 3:return[2,e.sent()];case 4:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,-1]})})},e.prototype.setSequentialID=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2]})})},e}(),vo=function(){function e(e,t,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this.apiFactory=e,this.dispatcher=t,this.PushAOP=n,this.PullAOP=o,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"ACTUAL"},e.prototype.getPushJson=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,[]]})})},e.prototype.pullData=function(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(n)]:[3,2];case 1:n=e.sent(),e.label=2;case 2:return 0<n.Actual.length?((t=this.apiFactory.getAPI("saveActual")).ActualDatas=n.Actual,[4,this.dispatcher.dispatch(t).toPromise()]):[3,4];case 3:return[2,e.sent()];case 4:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,-1]})})},e.prototype.setSequentialID=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2]})})},e}(),Po=function(){function e(e,t,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this.apiFactory=e,this.dispatcher=t,this.PushAOP=n,this.PullAOP=o,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"AGENCY_PLAN"},e.prototype.getPushJson=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,[]]})})},e.prototype.pullData=function(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(n)]:[3,2];case 1:n=e.sent(),e.label=2;case 2:return 0<n.AgencyPlans.length?((t=this.apiFactory.getAPI("saveAgencyPlan")).AgencyPlanDatas=n.AgencyPlans,[4,this.dispatcher.dispatch(t).toPromise()]):[3,4];case 3:return[2,e.sent()];case 4:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,-1]})})},e.prototype.setSequentialID=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2]})})},e}(),Ao=function(){function e(e,t,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this.apiFactory=e,this.dispatcher=t,this.PushAOP=n,this.PullAOP=o,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"PROGRESS"},e.prototype.getPushJson=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,[]]})})},e.prototype.pullData=function(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(n)]:[3,2];case 1:n=e.sent(),e.label=2;case 2:return 0<n.Progress.length?((t=this.apiFactory.getAPI("saveProgress")).ProgressDatas=n.Progress,[4,this.dispatcher.dispatch(t).toPromise()]):[3,4];case 3:return[2,e.sent()];case 4:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,-1]})})},e.prototype.setSequentialID=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2]})})},e}(),Co=function(){function e(e,t,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this.apiFactory=e,this.dispatcher=t,this.PushAOP=n,this.PullAOP=o,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"YEAR_CONFIG"},e.prototype.getPushJson=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,[]]})})},e.prototype.pullData=function(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(n)]:[3,2];case 1:n=e.sent(),e.label=2;case 2:return 0<n.Configurations.length?((t=this.apiFactory.getAPI("saveYearConfig")).FirstUseAPP=n.FirstUseAPP,t.yearConfigs=n.Configurations,[4,this.dispatcher.dispatch(t).toPromise()]):[3,4];case 3:return[2,e.sent()];case 4:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,-1]})})},e.prototype.setSequentialID=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2]})})},e}(),bo=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.DaoFactory=e,this.PushAOP=t,this.PullAOP=n,this.state=lo.AVAILABLE}return e.prototype.getState=function(){return this.state},e.prototype.getName=function(){return"PROFILE_CODE"},e.prototype.getPushJson=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,[]]})})},e.prototype.pullData=function(d){return I(this,void 0,void 0,function(){var o,r,i,a,s,c,u,l,h,p,f,g;return z(this,function(e){switch(e.label){case 0:return this.PullAOP?[4,this.PullAOP.execute(d)]:[3,2];case 1:d=e.sent(),e.label=2;case 2:if(s=this.DaoFactory.getDao("Profile"),c=this.DaoFactory.getTable("Profile","TW_LH_SD_Code"),!(0<d.datalist.length))return[3,4];s.transactionDelete(c);try{for(u=$(d.datalist),l=u.next();!l.done;l=u.next()){h=l.value;try{for(p=$(h.values),f=p.next();!f.done;f=p.next())g=f.value,(c=this.DaoFactory.getTable("Profile","TW_LH_SD_Code")).setValue("TypeID",h.datalistId),c.setValue("Code",g.value),c.setValue("MappingID",g.label),c.setValue("Orders",g.orders),c.setValue("Arguments",g.arguments),c.setValue("ValidityPeriod",K.endOfDay(new Date(g.validityPeriod)).getTime()),s.transactionInsert(c)}catch(t){i={error:t}}finally{try{f&&!f.done&&(a=p["return"])&&a.call(p)}finally{if(i)throw i.error}}}}catch(n){o={error:n}}finally{try{l&&!l.done&&(r=u["return"])&&r.call(u)}finally{if(o)throw o.error}}return[4,s.runTransaction().toPromise()];case 3:return[2,e.sent()];case 4:return[2,new ot({status:!0},[])]}})})},e.prototype.setState=function(e){this.state=e},e.prototype.getSequentialIDNeeded=function(){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,-1]})})},e.prototype.setSequentialID=function(e){return I(this,void 0,void 0,function(){return z(this,function(e){return[2]})})},e}(),Eo=function(){function e(){this.handlers={}}return e.prototype.deleteRouteSnapshot=function(){var n=this;console.log("delete snapshot!!"),Object.keys(this.handlers).forEach(function(e){var t=null;n.handlers[e]&&(t=n.handlers[e].componentRef),t&&t.destroy()}),this.handlers={}},e.prototype.shouldDetach=function(e){return console.debug("shouldDetach======>",e),this.isReuseRoute(e)},e.prototype.store=function(e,t){console.debug("store======>",e,t),console.log("this.getRouteUrl:",this.getRouteUrl(e)),this.handlers[this.getRouteUrl(e)]=t},e.prototype.shouldAttach=function(e){return this.isReuseRoute(e)&&!!this.handlers[this.getRouteUrl(e)]},e.prototype.retrieve=function(e){return this.handlers[this.getRouteUrl(e)]?this.handlers[this.getRouteUrl(e)]:null},e.prototype.shouldReuseRoute=function(e,t){return e.routeConfig===t.routeConfig},e.prototype.getRouteUrl=function(e){for(var t=this.getTruthRoute(e),n=[];t;)n.push(t.url.join("/")),t=t.parent;return n.filter(function(e){return e}).reverse().join("/")},e.prototype.getTruthRoute=function(e){for(var t=e;t.firstChild;)t=t.firstChild;return t},e.prototype.isReuseRoute=function(e){for(var t=!0,n=e;n;)n.data.hasOwnProperty("cache")&&(t=n.data.cache),n=n.firstChild;return console.debug("isReuseRoute",t),t},e}(),Lo=function(){function e(e,t,n,o,r,i){var a=this;this.APIFactory=e,this.dispatcher=t,this.deviceService=n,this.settingService=o,this.injector=r,this.APP_CONFIG=i,this.isDebug=!1,this.settingService.getDebugMode().subscribe(function(e){a.isDebug=e})}return e.prototype.handleError=function(i){return I(this,void 0,void 0,function(){var t,n,o,r;return z(this,function(e){switch(e.label){case 0:return this.APP_CONFIG.ENV,t=this.getAPIFactory(),n=this.getAPIDispatcher(),console.error(i),this.isDebug&&alert("error:"+i.message),[4,s.fromError(i,{offline:!0})];case 1:return o=(o=e.sent()).map(function(e){return e.source}),(r=t.getAPI("LogError"))&&(r.time=new Date,r.message=i.message,r.stack=o,r.DeviceModel=this.deviceService.getDeviceManufacturer(),r.DeviceSystem=this.deviceService.getDevicePlatform(),n.dispatch(r).toPromise().then(function(e){console.log("log error resp:",e)})),[2]}})})},e.prototype.getAPIFactory=function(){return this.APIFactory||this.injector.get(p)},e.prototype.getAPIDispatcher=function(){return this.dispatcher||this.injector.get(nt)},e.decorators=[{type:u.Injectable}],e.ctorParameters=function(){return[{type:p},{type:nt},{type:We},{type:$t},{type:u.Injector},{type:undefined,decorators:[{type:u.Inject,args:[_]}]}]},e}(),No=function(){function e(e,t,n,o,r,i){this.injector=e,this.AOPTokenService=t,this.APIFactory=n,this.dispatcher=o,this.DaoFactory=r,this.profileCodeService=i}return e.prototype.getMetaJson=function(e){var t=this.APIFactory.getAPI("getMetaConfig");return t.configName=e,this.dispatcher.dispatch(t).toPromise()},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.Injector},{type:Ne},{type:p},{type:nt},{type:Nt},{type:fo}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.INJECTOR),u.inject(Ne),u.inject(p),u.inject(nt),u.inject(Nt),u.inject(fo))},token:e,providedIn:"root"}),e}(),Oo=function(){function e(){}return e.prototype.onValueChange=function(e,t,n,o,r,i){},e.prototype.onValidateAll=function(e,t){return!0},e.prototype.btnClick=function(e,t,n){},e}(),Fo=function(){function e(e,t,n){this.errorHandler=e,this.APIFactory=t,this.dispatcher=n}return e.prototype.getData=function(o,r){return void 0===r&&(r=null),I(this,void 0,void 0,function(){var t,n;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=this.APIFactory.getAPI(o.source.read),r&&Object.keys(r).forEach(function(e){t[e]=r[e]}),[4,this.dispatcher.dispatch(t).toPromise()];case 1:return[2,e.sent().Body[0]];case 2:return n=e.sent(),this.errorHandler.handleError(new D("F00802",n.message)),[2,null];case 3:return[2]}})})},e.prototype.saveData=function(o,r,i){return void 0===i&&(i=null),I(this,void 0,void 0,function(){var t,n;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=this.APIFactory.getAPI(o.source.write),i&&Object.keys(i).forEach(function(e){t[e]=i[e]}),t.Data=r,[4,this.dispatcher.dispatch(t).toPromise()];case 1:return[2,e.sent()];case 2:return n=e.sent(),this.errorHandler.handleError(new D("F00803",n.message)),[2,null];case 3:return[2]}})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u.ErrorHandler},{type:p},{type:nt}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.ErrorHandler),u.inject(p),u.inject(nt))},token:e,providedIn:"root"}),e}(),wo=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return l(e,r),e.prototype.getData=function(e,t){return I(this,void 0,void 0,function(){return z(this,function(e){return[2,null]})})},e.prototype.saveData=function(t,n,o){return I(this,void 0,void 0,function(){return z(this,function(e){return t.source.write?[2,r.prototype.saveData.call(this,t,n,o)]:[2,null]})})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(u.ErrorHandler),u.inject(p),u.inject(nt))},token:e,providedIn:"root"}),e}(Fo),Mo=function rr(e,t,n){this.id=null,this.name=null,this.type=null,this.optionRef=null,this.showTitle=null,this.required=null,this.readonly=null,this.inline=null,this.grid=null,this.order=null,this["default"]=null,this.maxLength=null,this.placeholder=null,this.groupColumns=[],this.groupRows=[],this.icon=null,this.canAdd=null,this.maxNumber=null,this.showDefaultOption=null,this.rowTitle=null,this.id=e,this.name=t,this.type=n},Ro=function(){function e(){this.source=null,this.Rows=[],this.Columns=[],this.Footer=[]}return e.prototype.setColumn=function(t,e){var n=this;if(console.log("MetaConfig setColumn:",t,e),t=t.map(function(e){return n.createColumnObject(e)}),0<e.length){var o=T.flatMap(e,function(e){return e.columns});e=e.map(function(e){return n.createGroupColumnObject(e,t)}),t=t.filter(function(e){return!o.includes(e.id)}),e.forEach(function(e){e.groupRows=n.convertColumns2Row(e.groupColumns),t.splice(e.order,0,e)}),t.forEach(function(e,t){e.order=t})}this.Columns=t,this.Rows=this.convertColumns2Row(t)},e.prototype.setFooter=function(e){this.Footer=e.map(function(e){return new Mo(e.id,e.name,e.type)})},e.prototype.createColumnObject=function(e){var t=new Mo(e.id,e.name,e.type);return t.optionRef=e.ref,t.showTitle=e.showTitle,t.required=e.required,t.readonly=e.readonly,t.grid=e.grid,t.inline=e.inline,t.order=e.order,t["default"]=e["default"],t.maxLength=e.maxLength,t.groupColumns=e.groupColumns,t.icon=e.icon,t.canAdd=e.canAdd,t.maxNumber=e.maxNumber,t.placeholder=e.placeholder,t.showDefaultOption=e.showDefaultOption,t.rowTitle=e.rowTitle,t},e.prototype.createGroupColumnObject=function(e,n){var t=e.columns,o=this.createColumnObject(e);return o.groupColumns=t.map(function(t){return n.filter(function(e){return e.id===t})[0]}),o},e.prototype.convertColumns2Row=function(e){console.log("MetaConfig convertColumns2Row:",e);for(var t=[],n=[],o=0;o<e.length;o++)t.push(e[o]),!1!==e[o].inline&&o!==e.length-1||(n.push(m(t)),t=[]);return n},e}(),jo=function ir(e,t,n){this.type=e,this.read=t,this.write=n},ko=function ar(e,t,n,o){this.pc=e,this.nb=t||e,this.pad=n||e,this.mobile=o||e},Vo=function(){function e(){}return e.prototype.parse=function(e){console.log("Default Meta Parser parse:",e),e.columns=this.fillDefaultColumnSetting(e.columns);var t=e.group?e.group:[];t=this.fillDefaultColumnSetting(t);var n=new Ro;return console.log("DefaultMetaParser parse:",e,t),n.source=this.getSource(e),n.setColumn(e.columns,t),n.setFooter(e.footer),console.log("After Parse:",n),n},e.prototype.getSource=function(e){try{var t=e.source.type,n=e.source.read,o=e.source.write;return new jo(t,n=n||null,o=o||null)}catch(r){throw new D("F00801",r.message)}},e.prototype.fillDefaultColumnSetting=function(e){var t=this;return e.map(function(e){return t._defaultSetting(e)})},e.prototype._defaultSetting=function(e){var t=e.grid;return t=t?"number"==typeof t?new ko(t):new ko(t.pc,t.nb,t.pad,t.mobile):new ko(12),Object.assign({type:"Group",ref:"",showTitle:!0,required:!1,readonly:!1,inline:!1,order:0,"default":"",maxLength:999,showDefaultOption:!0,groupColumns:[],icon:null,canAdd:!1,maxNumber:999,placeholder:"",rowTitle:null},e,{grid:t})},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),Ho=function sr(e,t,n){this.colID=e,this.isValid=t,this.message=n},Go=function(){function e(e,t,n){this.metaService=e,this.parser=t,this.executor=n,this.metaID=null,this.metaLoaded=!1,this.metaConfig=null,this._data=null,this.metaID=this.getMetaID()}return e.prototype.ngOnInit=function(){console.log("MetaComponent ngOninit!"),this.init()},e.prototype.init=function(){return I(this,void 0,void 0,function(){var t,n;return z(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,this.metaService.getMetaJson(this.metaID)];case 1:return t=e.sent(),this.metaConfig=this.parser.parse(t),[4,this.loadData()];case 2:return e.sent(),this.metaLoaded=!0,[3,4];case 3:throw n=e.sent(),new D("F00800",n.message);case 4:return[2]}})})},e.prototype.loadData=function(){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return[4,this.executor.getData(this.metaConfig,this.getMetaParams())];case 1:return(t=e.sent())&&(this._data=t,this.onDataUpdated()),[2]}})})},e.prototype.waitUntilMetaLoaded=function(){var o=this;return new Promise(function(e,t){var n=setInterval(function(){o.metaLoaded&&(clearInterval(n),e())},100)})},e.prototype.isMetaLoaded=function(){return this.metaLoaded},e}(),xo=function(i){function e(e,t,n,o){var r=i.call(this,e,n,o)||this;return r.profileCodeService=t,r}return l(e,i),e.prototype.ngOnInit=function(){console.log("DisplayMetaComponent ngOninit!"),i.prototype.ngOnInit.call(this)},e.prototype.onDataUpdated=function(){this.convertCodeToDisplay()},e.prototype.convertCodeToDisplay=function(){var i=this;this.metaConfig.Columns.filter(function(e){return"Label"===e.type&&!!e.optionRef}).forEach(function(e){i._data[e.id]&&(i._data[e.id]=i.profileCodeService.convertCode2Text(e.optionRef,i._data[e.id]))}),this.metaConfig.Columns.filter(function(e){return"Group"===e.type}).forEach(function(o){var r=o.groupColumns.filter(function(e){return"Label"===e.type&&!!e.optionRef});console.log("colsNeedConvert:",r),0<r.length&&i._data[o.id]&&i._data[o.id].forEach(function(e,t){var n=r.map(function(e){return{key:e.id,value:i.profileCodeService.convertCode2Text(e.optionRef,i._data[o.id][t][e.id])}}).reduce(function(e,t){return e[t.key]=t.value,e},{});console.log("extendedObj:",n),e=Object.assign(e,n)})})},e}(Go),Wo=function(i){function e(e,t,n,o){var r=i.call(this,e,n,o)||this;return r.profileCodeService=t,r.validationResult=new Me,r}return l(e,i),e.prototype.ngOnInit=function(){console.log("FormMetaComponent ngOninit!"),i.prototype.ngOnInit.call(this)},e.prototype.onChange=function(e,t,n,o){void 0===n&&(n=null),void 0===o&&(o=-1),console.log("onChange:",e,t,n,o);var r=n&&0<=o,i=r?e:e+o.toString(),a=this.valid(e,t,r);console.log("validResp:",a),a?this.validationResult.deleteError(i):this.validationResult.setErrorMap(i,a.message),this.onValueChange(e,t,n,o)},e.prototype.valid=function(t,e,n){void 0===n&&(n=!1),console.log("valid:",t,e,n);var o,r=new Ho(t,!0,"");if(n){var i=this.metaConfig.Columns.filter(function(e){return"Group"===e.type}).map(function(e){return e.groupColumns});o=T.flatten(i).filter(function(e){return e.id===t})[0]}else o=this.metaConfig.Columns.filter(function(e){return e.id===t})[0];return console.log("valid col:",o),"Input"===o.type?o.required&&!e&&(r.isValid=!1,r.message=o.id+"_required"):"Select"===o.type&&(!o.required||""!==e&&e||(r.isValid=!1,r.message=o.id+"_required")),r},e.prototype.validAll=function(){var r=this,i=this.metaConfig.Columns.filter(function(e){return"Group"!==e.type}).map(function(e){return r.valid(e.id,r._data[e.id])}).filter(function(e){return!e.isValid});return this.metaConfig.Columns.filter(function(e){return"Group"===e.type}).forEach(function(e){var t=e.id;r._data[t].forEach(function(n,o){i=i.concat(e.groupColumns.map(function(e){var t=r.valid(e.id,n[e.id],!0);return t.colID=e.id+o.toString(),t}).filter(function(e){return!e.isValid}))})}),console.log("validAll result:",i),i},e.prototype.onBtnClick=function(r,i){return I(this,void 0,void 0,function(){var t,n,o=this;return z(this,function(e){switch(e.label){case 0:return this._data[i+"Btn"]&&(this._data[i+"Btn"].disable=!0),"submit"!==r?[3,4]:(this.validationResult.clearErrorMap(),(t=this.validAll()).forEach(function(e){o.validationResult.setErrorMap(e.colID,e.message)}),this.onValidateAll()&&0===t.length?[4,this.saveData()]:[3,2]);case 1:return n=e.sent(),console.log("save data resp:",n),this.btnClick(r,i),this._data[i+"Btn"]&&(this._data[i+"Btn"].disable=!0),[3,3];case 2:this._data[i+"Btn"].disable=!1,e.label=3;case 3:return[3,5];case 4:this.btnClick(r,i),e.label=5;case 5:return[2]}})})},e.prototype.saveData=function(){return I(this,void 0,void 0,function(){return z(this,function(e){switch(e.label){case 0:return[4,this.executor.saveData(this.metaConfig,this._data,this.getMetaParams())];case 1:return[2,e.sent()]}})})},e.prototype.onGroupRemove=function(t,n){var o=this;this._data[t]=this._data[t].filter(function(e,t){return t!=n}),this.metaConfig.Columns.filter(function(e){return e.id===t})[0].groupColumns.forEach(function(e){o.validationResult.deleteError(e.id+n.toString())})},e.prototype.onGroupAdd=function(t){var o=this.metaConfig.Columns.filter(function(e){return e.id===t})[0].groupColumns,e=o.map(function(e){return e.id});console.log("keys:",e);var n=e.map(function(t){var e={},n=o.filter(function(e){return e.id===t})[0]["default"];return e[t]=n,e}).reduce(function(e,t){return Object.assign(e,t)},{});console.log("GroupAdd newObj:",n),this._data[t]=m(this._data[t],[n])},e.prototype.onDataUpdated=function(){this.addBtnAttr(),this.fetchOptions()},e.prototype.fetchOptions=function(){var t=this;this.metaConfig.Columns.filter(function(e){return e.optionRef&&0<e.optionRef.length}).map(function(e){return t.createOption(e)}).forEach(function(e){t._data[e.key]=e.val});var e=this.metaConfig.Columns.filter(function(e){return"Group"===e.type}).map(function(e){return e.groupColumns.filter(function(e){return e.optionRef&&0<e.optionRef.length})});T.flatMap(e,function(e){return e.map(function(e){return t.createOption(e)})}).forEach(function(e){t._data[e.key]=e.val})},e.prototype.addBtnAttr=function(){var t=this;this.metaConfig.Footer.forEach(function(e){"submit"!==e.type&&"button"!==e.type||(t._data[e.id+"Btn"]=Object.assign({disable:!1},e))})},e.prototype.createOption=function(t){var n=this,e={key:t.id+"Option",val:[]},o=this.profileCodeService.getCodeArray(t.optionRef);return"Select"===t.type?e.val=o.map(function(e){return new on(e.getCode(),n.profileCodeService.convertCode2Text(t.optionRef,e.getCode()))}):e.val=o.map(function(e){return{id:e.getCode(),name:n.profileCodeService.convertCode2Text(t.optionRef,e.getCode()),arguments:JSON.parse(e.getArguments())}}),e},e}(Go),Bo=function(){function e(){}return e.addBean=function(t){0===this.beanPool.filter(function(e){return e.name===t.name}).length&&this.beanPool.push(t)},e.validObject=function(e,t){try{console.log("validObject:",t,e);var n=this.getBean(t);if(n){var o=n.validSelf(e);return 0<o.length&&this.errorHandler(o,t),0===o.length}throw new Error("Cannot find Bean "+t+".")}catch(r){return console.error("Valid Object error",r),!0}},e.addCondition=function(e,t,n){var o=this.getBean(e),r=o.getOrCreateProperty(t);console.log("addCondition:",o,r),r.addCondition(n)},e.getBean=function(t){return 0<this.beanPool.filter(function(e){return e.name===t}).length?this.beanPool.filter(function(e){return e.name===t})[0]:null},e.errorHandler=function(e,t){console.error(e.reduce(function(e,t){return e+"\n"+t},"Class "+t+" valid error:"))},e.beanPool=[],e}(),Uo=function(){function e(e){this.name=e,this.conditionList=[]}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),e.prototype.addCondition=function(e){this.conditionList.push(e)},e.prototype.validProperty=function(t){var n=this;return this.conditionList.filter(function(e){return!e.valid(t)}).map(function(e){return e.getErrorMsg(n.name)})},e}(),Yo=function(){function e(e,t){this.name=e,this.type=t,this.propertyList=[]}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!0,configurable:!0}),e.prototype.getOrCreateProperty=function(t){var e=this.propertyList.filter(function(e){return e.name===t});if(0<e.length)return e[0];var n=new Uo(t);return this.addProperty(n),n},e.prototype.validSelf=function(t){var e=T.flatMap(this.propertyList,function(e){return e.validProperty(t[e.name])});return console.log("validSelf result:",e),e},e.prototype.addProperty=function(e){this.propertyList.push(e)},e}();var qo={Required:0,Max:1,Min:2};qo[qo.Required]="Required",qo[qo.Max]="Max",qo[qo.Min]="Min";var Xo=function(){function e(){this.baseTypes=["string","undefined","number","boolean"],this.type=qo.Required}return e.prototype.getType=function(){return this.type},e.prototype.valid=function(e){return this.value=e,console.log("RequiredCondition valid:",e,-1===this.baseTypes.indexOf(typeof e)),-1!==this.baseTypes.indexOf(typeof e)||null===e?null!==e&&e!==undefined:e instanceof Array?0<e.length:"object"==typeof e?Bo.validObject(e,e.beanName):void 0},e.prototype.getErrorMsg=function(e){return e+" is "+this.value+" but expect required."},e}();function Jo(e){console.log("Valid.ts validObject:",e),e instanceof Array?e.forEach(function(e){return Jo(e)}):Bo.validObject(e,e.beanName)}e.CoreModule=Vt,e.StringUtils=Oe,e.DateUtils=Fe,e.PageInfo=we,e.ValidationResult=Me,e.NumberUtils=Re,e.TableUtils=je,e.Language=Ht,e.TranslatePipe=it,e.TranslateService=rt,e.InitialService=ro,e.ConfigTask=pn,e.DataSyncTask=Gt,e.DeviceTask=fn,e.ConfigToken=_,e.GoalSettingInterfaceToken=y,e.configTaskToken=S,e.registerAPITaskToken=v,e.dataSyncTaskToken=P,e.customTaskToken=A,e.fetchLanguageFinishToken=C,e.fetchSettingFinishToken=b,e.fetchConfigFinishToken=E,e.registerDataSyncFuncToken=N,e.checkTimeoutToken=O,e.timeoutActionToken=F,e.checkPermissionToken=w,e.authActionToken=M,e.authRouteToken=R,e.AfterLoginToken=j,e.LoadingAppToken=k,e.LoginMgrToken=V,e.PushIDMgrToken=H,e.checkForRootToken=G,e.RestHeaderToken=x,e.LanguageAccessToken=W,e.LanguageUpdateToken=B,e.NetworkChangeToken=U,e.FontSizeAccessToken=Y,e.changeFontSizeToken=q,e.showRuleToken=X,e.initialFinishToken=J,e.NotificationProviderToken=Z,e.GoalSettingNotStartFirstMessageActionToken=ee,e.GoalSettingNotStartMessageActionToken=te,e.NeedGoalSettingMessageActionToken=ne,e.GoalPromoSettingMessageActionToken=oe,e.GoalAutoApproveMessageActionToken=re,e.GoalAutoApproveLeaderMessageActionToken=ie,e.ApproveGoalIsRejectMessageActionToken=ae,e.ApproveGoalIsApproveMessageActionToken=se,e.PendingReviewMessageActionToken=ce,e.SupervisorHaveChangeAgentMessageActionToken=ue,e.SupervisorHaveChangeOldMessageActionToken=le,e.SupervisorHaveChangeNewMessageActionToken=he,e.GoalAutoRejectMessageActionToken=pe,e.GoalAutoRejectLeaderMessageActionToken=fe,e.ActivityArriveTenPointMessageActionToken=ge,e.ActivityArriveTwentyPointMessageActionToken=de,e.ActivityNotArriveTwentyPointMessageActionToken=_e,e.ReminderEventsMessageActionToken=ye,e.DataPrivacyProtectionMessageActionToken=Te,e.OvertimeMessageActionToken=me,e.AutoDeleteMessageActionToken=De,e.OfflineMessageActionToken=Ie,e.VersionCheckMessageActionToken=Se,e.TimoutMessageActionToken=ve,e.DataCollectionMessageActionToken=Pe,e.ContactPermissionActionToken=Ae,e.yearConfigExtensionDataToken=Ce,e.goalSettingExtensionDataToken=be,e.agencyPlanExtensionDataToken=Ee,e.actionDirectiveTaskToken=Le,e.AOPTokenService=Ne,e.APIInvokeMethod=f,e.APIFactory=p,e.APIResponse=io,e.APIRequest=mn,e.APIDispatch=nt,e.SettingAPI=dn,e.SettingUpdateAPI=Sn,e.getAgencyPlanAPI=Vn,e.getActualAPI=Xn,e.getGoalAPI=Un,e.getYearConfigAPI=jn,e.getProgressAPI=xn,e.GetDeviceInfoAPI=Kn,e.LoginAPI=zn,e.LogoutAPI=ao,e.DashboardGetMessageListAPI=$n,e.DashboardUpdateMessageStatusAPI=Zn,e.ChangeMessageStatusAPI=so,e.pushApproveGoalAPI=Qn,e.OfflineAuthAPI=yn,e.pushGoalSettingDataAPI=Jn,e.GetOtherParameterAPI=co,e.UnbindDeviceAPI=to,e.UpdateTimeListAPI=no,e.SyncPushAPI=Pn,e.ClientCustomDao=Ft,e.DaoFactory=Nt,e.SQLCommand=Ct,e.SQLiteColumn=St,e.SQLiteDao=Et,e.SQLiteDatabase=It,e.SQLiteResponse=ot,e.SQLiteTable=vt,e.AndCompoundRestriction=Wt,e.EqualRestriction=Bt,e.GreaterOrEqualRestriction=Ut,e.GreaterRestriction=Yt,e.InRestriction=qt,e.LessOrEqualRestriction=Xt,e.LikeRestriction=Jt,e.LimitRestriction=Pt,e.NotEqualRestriction=Ot,e.NotNullRestriction=Qt,e.NullRestriction=Kt,e.ORCompoundRestriction=zt,e.OffsetRestriction=At,e.OrderByRestriction=bt,e.Address=ke,e.ContactItem=He,e.Phone=Ve,e.CordovaDeviceDao=Ge,e.DeviceService=We,e.DeviceFactory=xe,e.LoginInfo=st,e.LoginResponse=ct,e.LOGIN_TYPE=ut,e.DefaultLoginMgr=gt,e.DefaultLoadingApp=go,e.AuthObject=Ze,e.AuthError=et,e.ActionDirective=Dt,e.ACTION_STATUS=_t,e.ActionEvent=yt,e.ActionService=Tt,e.AuthService=mt,e.CheckPermissionService=dt,e.TimeoutService=tt,e.RouteObject=_o,e.FUNC_STATE=lo,e.CalendarSync=yo,e.ContactSync=To,e.CustomerSync=mo,e.MessageSync=Do,e.GoalExpectedSync=Io,e.GoalSync=So,e.ActualSync=vo,e.AgencyPlanSync=Po,e.ProgressSync=Ao,e.YearConfigSync=Co,e.ProfileCodeSync=bo,e.DataSyncService=ho,e.VersionCheckService=uo,e.Setting=xt,e.ViewDateChange=Zt,e.ChangeAction=en,e.ProfileCode=tn,e.versionInfo=nn,e.LanguageCode=h,e.SelectOption=on,e.SuccessStatus=rn,e.GoalExtension=an,e.SubmitGoalData=sn,e.SubmitGoalPlan=cn,e.SubmitGoalPlanInfo=un,e.SubmitGoalSettingValue=ln,e.SubmitGoalInfo=hn,e.YESNO={YES:"Y",NO:"N"},e.TIMEBASE={DAY:"Day",WEEK:"Week",MONTH:"Month",QUARTER:"Quarter",YEAR:"Year"},e.SUBMITGOALTYPE={ALL:"All",PLAN:"Plan"},e.PERFORMANCETYPE={PERSONAL:"P",TEAM:"T"},e.APPMODE=pt,e.ProfileCodeService=fo,e.SettingService=$t,e.LogService=po,e.CustomRouterReuseStrategy=Eo,e.AppRouter=ht,e.ErrorsHandler=Lo,e.APPError=D,e.MetaService=No,e.DisplayMetaController=Oo,e.APIExecutor=Fo,e.InputExecutor=wo,e.DefaultMetaParser=Vo,e.MetaColumn=Mo,e.MetaConfig=Ro,e.MetaGrid=ko,e.MetaSource=jo,e.MetaValid=Ho,e.BaseMetaComponent=Go,e.DisplayMetaComponent=xo,e.FormMetaComponent=Wo,e.TranslatePricePipe=kt,e.TranslatePriceService=jt,e.NotificationMgr=Qe,e.NotificationObject=Xe,e.NotificationProvider=Je,e.NotificationType=Ye,e.NotificationCategory=qe,e.SqliteExecutorComponent=wt,e.NumberFormatPipe=at,e.Bean=function cr(n){return function(e){return Bo.addBean(new Yo(n,e)),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.beanName=n,e}return l(e,t),e}(e)}},e.Required=function ur(e,t){Bo.addBean(new Yo(e.constructor.name,e)),Bo.addCondition(e.constructor.name,t,new Xo)},e.Valid=function lr(e){return console.log("valid type:",e),function(e,t,n){var i=n.value;return n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log("pool:",Bo.beanPool);var n=i.apply(this,e);return console.log("valid result: ",n),L.isObservable(n)?(console.log("isObservable(result)"),function o(e){return new L.Observable(function(t){e.subscribe({next:function(e){Jo(e),t.next(e)},error:function(e){t.error(e)},complete:function(){t.complete()}})})}(n)):n instanceof Promise?(console.log("result instanceof Promise"),function r(n){return I(this,void 0,void 0,function(){var t;return z(this,function(e){switch(e.label){case 0:return[4,n];case 1:return Jo(t=e.sent()),[2,t]}})})}(n)):(console.log("not Observable, not instanceof Promise"),Jo(n),n)},n}},e.ɵe=nt,e.ɵbe=p,e.ɵm=Ue,e.ɵy=$e,e.ɵg=d,e.ɵi=Ke,e.ɵh=ze,e.ɵbn=Dt,e.ɵbu=Tt,e.ɵbo=mt,e.ɵbj=gt,e.ɵs=Be,e.ɵbr=dt,e.ɵz=tt,e.ɵl=xe,e.ɵk=We,e.ɵby=Nt,e.ɵf=_,e.ɵc=W,e.ɵd=B,e.ɵj=x,e.ɵbp=M,e.ɵbq=R,e.ɵbs=w,e.ɵba=O,e.ɵbb=F,e.ɵn=_,e.ɵo=V,e.ɵq=Z,e.ɵp=H,e.ɵr=Le,e.ɵa=it,e.ɵb=rt,e.ɵu=Qe,e.ɵv=Je,e.ɵbm=at,e.ɵbi=jt,e.ɵbh=kt,e.ɵbk=ht,e.ɵbz=$t,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=allianzSND-core.umd.min.js.map