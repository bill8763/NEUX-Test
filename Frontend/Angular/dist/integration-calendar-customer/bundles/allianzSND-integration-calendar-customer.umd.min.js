!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/forms"),require("@allianz/ngx-ndbx"),require("@allianz/ngx-ndbx/icon"),require("@angular/common"),require("@allianzSND/ui"),require("@allianz/ngx-ndbx/formfield"),require("@allianz/ngx-ndbx/datefield"),require("@angular/animations"),require("@allianz/ngx-ndbx/input"),require("@allianz/ngx-ndbx/progressbar"),require("@allianz/ngx-ndbx/grid"),require("@angular/core"),require("rxjs/operators"),require("uuid"),require("date-fns"),require("@allianzSND/core"),require("rxjs")):"function"==typeof define&&define.amd?define("@allianzSND/integration-calendar-customer",["exports","@angular/forms","@allianz/ngx-ndbx","@allianz/ngx-ndbx/icon","@angular/common","@allianzSND/ui","@allianz/ngx-ndbx/formfield","@allianz/ngx-ndbx/datefield","@angular/animations","@allianz/ngx-ndbx/input","@allianz/ngx-ndbx/progressbar","@allianz/ngx-ndbx/grid","@angular/core","rxjs/operators","uuid","date-fns","@allianzSND/core","rxjs"],e):e((t.allianzSND=t.allianzSND||{},t.allianzSND["integration-calendar-customer"]={}),t.ng.forms,t.ngxNdbx,t.icon,t.ng.common,t.ui,t.formfield,t.datefield,t.ng.animations,t.input,t.progressbar,t.grid,t.ng.core,t.rxjs.operators,t.uuid,t.dateFns,t.i1,t.rxjs)}(this,function(t,e,n,i,o,a,r,s,l,c,u,p,h,d,V,m,j,f){"use strict";var g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function y(t,e){function n(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function b(e,r,s,l){return new(s||(s=Promise))(function(t,n){function i(t){try{a(l.next(t))}catch(e){n(e)}}function o(t){try{a(l["throw"](t))}catch(e){n(e)}}function a(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(i,o)}a((l=l.apply(e,r||[])).next())})}function C(i,o){var a,r,s,t,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function n(t){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,r&&(s=2&t[0]?r["return"]:t[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;switch(r=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,r=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(i,l)}catch(e){t=[6,e],r=0}finally{a=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([e,t])}}}function B(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,a=n.call(t),r=[];try{for(;(void 0===e||0<e--)&&!(i=a.next()).done;)r.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=a["return"])&&n.call(a)}finally{if(o)throw o.error}}return r}function D(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}var x=new h.InjectionToken("calendarEditMetaController"),k=new h.InjectionToken("calendarDetailMetaController"),w=function(){function t(t){this.profileCodeService=t,this.alertOpt=[],this.alertOpt=this.profileCodeService.getCodeArray("Calendar_RemindTime")}return t.prototype.onDataUpdated=function(t){var e="Y"===t.IsAllDay;t.Alert1Option=this.getAlertOption(e),t.Alert2Option=this.getAlertOption(e),t.Alert3Option=this.getAlertOption(e),t.StartTime?(t.StartDate=m.startOfDay(new Date(t.StartTime)),t.StartTime=new Date(t.StartTime)):(t.StartDate=t.ViewDate,t.StartTime=m.addHours(this.toFiveUnit(this.combineDateTime(t.ViewDate,new Date)),1),e||(t.StartDate=t.StartTime)),t.EndTime?(t.EndDate=m.startOfDay(new Date(t.EndTime)),t.EndTime=new Date(t.EndTime)):(t.EndDate=m.startOfDay(t.StartDate),t.EndTime=m.addHours(t.StartTime,1),e||(t.EndDate=t.EndTime)),t.IsAllDay||(t.IsAllDay="N"),t.IsAlert||(t.IsAlert="Y"),t.Alert1||(t.Alert1=e?"2":"8"),t.Alert2||(t.Alert2=""),console.log("Default controller onDataUpdated:",t)},t.prototype.onValueChange=function(t,e,n,i,o,a){var r="Y"===o.IsAllDay;"IsAllDay"===t?(o[t]=e?"Y":"N",this.checkEndBeforeStartError(o,a),o.Alert1Option=this.getAlertOption(e),o.Alert2Option=this.getAlertOption(e),o.Alert3Option=this.getAlertOption(e),o.Alert1=e?"2":"8",o.Alert2="",a.deleteError("Alert1"),a.deleteError("Alert2")):"IsAlert"===t?(o[t]=e?"Y":"N",e?o.Alert1===o.Alert2&&o.Alert1?a.setErrorMap("Alert2","Wrong_Alert"):o.Alert1||o.Alert2||a.setErrorMap("Alert1","Wrong_Alert_Require"):(a.deleteError("Alert1"),a.deleteError("Alert1"))):"StartDate"===t?(o.StartDate=e||m.startOfDay(new Date),r?o.EndDate=o.StartDate:(o.EndDate=this.getToDate(o.StartDate,o.StartTime),o.EndTime=this.getToDate(o.StartDate,o.StartTime)),this.checkEndBeforeStartError(o,a)):"StartTime"===t?(o.StartTime=e?this.toFiveUnit(e):this.toFiveUnit(new Date),o.EndDate=this.getToDate(o.StartDate,o.StartTime),o.EndTime=this.getToDate(o.StartDate,o.StartTime),this.checkEndBeforeStartError(o,a)):"EndDate"===t?(o.EndDate=e||m.startOfDay(new Date),this.checkEndBeforeStartError(o,a)):"EndTime"===t?(o.EndTime=e?this.toFiveUnit(e):this.toFiveUnit(new Date),this.checkEndBeforeStartError(o,a)):"Alert1"!==t&&"Alert2"!==t||(o.Alert1===o.Alert2&&o.Alert1?a.setErrorMap("Alert2","Wrong_Alert"):"Y"!==o.IsAlert||o.Alert1||o.Alert2?(a.deleteError("Alert1"),a.deleteError("Alert2")):a.setErrorMap("Alert1","Wrong_Alert_Require"))},t.prototype.onValidateAll=function(t,e){return"Y"===t.IsAllDay?(t.StartDateTime=m.startOfDay(t.StartDate),t.EndDateTime=m.startOfDay(t.EndDate)):(t.StartDateTime=this.combineDateTime(t.StartDate,t.StartTime),t.EndDateTime=this.combineDateTime(t.EndDate,t.EndTime)),t.ClientID||(t.ClientID=V.v4()),"Y"!==t.IsAlert||t.Alert1||t.Alert2||e.setErrorMap("Alert1","Wrong_Alert_Require"),e.isTrue()},t.prototype.btnClick=function(t,e,n){},t.prototype.toFiveUnit=function(t){var e=t,n=m.getMinutes(e),i=n%5==0?0:5-n%5;return m.addMinutes(e,i)},t.prototype.getToDate=function(t,e){console.log("GetToDate:",t,e),console.log("GetMonth:",m.getMonth(t));var n=new Date(m.getYear(t),m.getMonth(t),m.getDate(t),m.getHours(e),m.getMinutes(e));return n=this.toFiveUnit(n),m.addHours(n,1)},t.prototype.checkEndBeforeStartError=function(t,e){e.deleteError("StartDate"),e.deleteError("EndDate"),e.deleteError("StartTime"),e.deleteError("EndTime");var n="Y"===t.IsAllDay;if(m.isSameDay(t.StartDate,t.EndDate)||m.isAfter(t.EndDate,t.StartDate)){if(!n){var i=t.StartDate,o=t.StartTime,a=t.EndDate,r=t.EndTime,s=this.combineDateTime(i,o),l=this.combineDateTime(a,r);m.isBefore(l,m.addMinutes(s,15))&&(e.setErrorMap("EndDate",""),e.setErrorMap("EndTime","Wrong_End_Time"))}}else e.setErrorMap("StartDate","Wrong_Start_Time")},t.prototype.combineDateTime=function(t,e){return new Date(m.getYear(t),m.getMonth(t),m.getDate(t),m.getHours(e),m.getMinutes(e))},t.prototype.getAlertOption=function(e){var n=this;return this.alertOpt.filter(function(t){return JSON.parse(t.getArguments()).isAllDay===e}).map(function(t){return new a.SelectOption(t.getCode(),n.profileCodeService.convertCode2Text(t.getTypeId(),t.getCode()))})},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:j.ProfileCodeService}]},t.ngInjectableDef=h.defineInjectable({factory:function(){return new t(h.inject(j.ProfileCodeService))},token:t,providedIn:"root"}),t}(),I=new h.InjectionToken("customerEditMetaController"),S=new h.InjectionToken("customerDetailMetaController"),T=new h.InjectionToken("customerContactEditMetaController"),_=new h.InjectionToken("customerContactDetailMetaController"),E=new h.InjectionToken("customerFilterMetaController"),P=new h.InjectionToken("customerCriteriaSearch"),A=new h.InjectionToken("customerImportDisplay"),M=new h.InjectionToken("addProgressPoint"),L=new h.InjectionToken("customerShowRule"),N=function(u){function t(t,e,n,i,o,a,r,s,l){var c=u.call(this,e,n,i,o)||this;return c.elementRef=t,c.metaService=e,c.addProgressPoint=s,c.showRule=l,c.isMetaDataDone=new h.EventEmitter,c.isSaveClickChange=new h.EventEmitter,c.editType="add",c.saveEvent=new h.EventEmitter,c._viewDate=new Date,c._isSaveClick=!1,c.language=new j.Language,c._translateMap=new Map,c.calendarEventList=[],c.activityOptionList=[],c.customerClientOptionList=[],c.alertOptionList=[],c.eventListBGColor="transparent",c._customerClientID="",console.log("calendar-edit construct:",a,r),c._metaController=r||a,c}return y(t,u),Object.defineProperty(t.prototype,"isSaveClick",{get:function(){return this._isSaveClick},set:function(t){var e=this;console.log("CalendarEdit set isSaveClick:",t),this._isSaveClick=t,1==this._isSaveClick&&(console.log("Click Calendar edit save"),this.onBtnClick("submit","save"),setTimeout(function(){e.isSaveClickChange.emit(!1)},500))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientID",{get:function(){return this._clientID},set:function(t){0==(this._clientID=t).length?this.editType="add":this.editType="edit",this.isMetaLoaded()&&this.loadData()},enumerable:!0,configurable:!0}),t.prototype.getMetaParams=function(){return{_clientID:this._clientID}},Object.defineProperty(t.prototype,"customerItemList",{get:function(){return this.customerClientOptionList},set:function(t){console.log("calendar-edit set customerItemList:",t),this.customerClientOptionList=t,this._data&&this.fillDefaultVal()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"translateMap",{get:function(){return this._translateMap},set:function(t){this._translateMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewDate",{get:function(){return this._viewDate},set:function(t){console.warn("viewDateChange"),this._viewDate=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"todayCalendarEvent",{get:function(){return this.calendarEventList},set:function(t){this.calendarEventList=t},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.windowWidth=window.innerWidth,this.editEvent(),u.prototype.ngOnInit.call(this)},t.prototype.btnClick=function(t,e){"submit"===t&&(console.log("calendar addProgressPoint",this.addProgressPoint),this.addProgressPoint&&"add"==this.editType&&this.addProgressPoint.addCalendarPoint(this._data,1),this.saveEvent.emit({data:this._data,type:this.editType})),this._metaController.btnClick(t,e,this._data)},t.prototype.onValidateAll=function(){var t=!0;return this.validationResult.isTrue()?(t=this._metaController.onValidateAll(this._data,this.validationResult),console.log("onValidate:",t)):(t=!1,this.validationResult.isError("Note")&&alert("Note "+this.validationResult.getErrorMsg("Note"))),t||(this.saveEvent.emit({data:null,type:"fail"}),this.scrollToError()),t},t.prototype.getMetaID=function(){return"calendarEdit"},t.prototype.onValueChange=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=-1),this._data[t]=e,this._metaController.onValueChange(t,e,n,i,this._data,this.validationResult)},t.prototype.onDataUpdated=function(){u.prototype.onDataUpdated.call(this),console.log("Calendar Edit DataUpdated:",this._data),this._data.ViewDate=this._viewDate,this._data.EditType=this.editType,this._data.CustomerClientID=this._customerClientID?this._customerClientID:this._data.CustomerClientID,this.fillDefaultVal(),this._metaController&&this._metaController.onDataUpdated(this._data),this.isMetaDataDone.emit(!0)},t.prototype.shouldHidden=function(t){return-1<["Alert1","Alert2"].indexOf(t)?"N"===this._data.IsAlert:-1<["StartTime","EndTime"].indexOf(t)?"Y"===this._data.IsAllDay:"CustomerClientID"===t?0<this._customerClientID.length:void 0},Object.defineProperty(t.prototype,"customerClientID",{get:function(){return this._customerClientID},set:function(t){this._customerClientID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowConfig",{get:function(){return this.metaConfig.Rows},enumerable:!0,configurable:!0}),t.prototype.onResize=function(t){this.windowWidth=t.target.innerWidth},t.prototype.fillDefaultVal=function(){this._data.CustomerClientIDOption=this.customerClientOptionList},t.prototype.editEvent=function(){this.showDate=this._convertDate(this._viewDate),console.log("EditEvent showDate:",this.showDate)},t.prototype.isMetaLoaded=function(){return this.metaLoaded},t.prototype.scrollToError=function(){var i=this;console.log("in scrollToError"),setTimeout(function(){var t=i.elementRef.nativeElement.querySelector(".error-msg"),e=document.querySelector(".calendar-edit-content").querySelector(".form-scroll-content");if(t&&e){var n=t.offsetTop-50;e.scrollTo({top:n,behavior:"smooth"}),console.log("scrollToError",n)}console.log("scrollToError",e,t)},200)},t.prototype._convertDate=function(t){return this.showRule?this.showRule.convertDate(t):m.format(t,"MM/dd/yyyy")},t.decorators=[{type:h.Component,args:[{selector:"snd-calendar-edit",template:'<ng-template *ngIf="windowWidth < 1024; then mobileBlock else pcBlock"></ng-template>\n\n<ng-template #mobileBlock>\n  <app-ui-form-layout-row>\n    <ng-container *ngTemplateOutlet="formContent"></ng-container>\n  </app-ui-form-layout-row>\n</ng-template>\n\x3c!-- end: mobileBlock --\x3e\n\n<ng-template #pcBlock>\n  <ng-container *ngTemplateOutlet="formContent"></ng-container>\n  <ng-container *ngTemplateOutlet="eventListContent"></ng-container>\n</ng-template>\n\x3c!-- end: pcBlock --\x3e\n\n<ng-template #formContent>\n  <app-ui-form-layout-col *ngIf="data && isMetaLoaded()" [colPC]="8" [colNB]="8" [colPad]="12" [colMobile]="12">\n    <app-ui-form-layout-advanced>\n      <ng-container *ngFor="let row of rowConfig;">\n        <app-ui-form-title-sm *ngIf="row[0].rowTitle">{{row[0].rowTitle | translate}}\n        </app-ui-form-title-sm>\n        <app-ui-form-layout-row *ngIf="!shouldHidden(row[0].id)">\n          <ng-container *ngFor="let col of row;">\n            \x3c!-- Customize Alert2 --\x3e\n            <app-ui-form-layout-col *ngIf="col.id===\'Alert2\'" [colPC]="\'auto\'" [colNB]="\'auto\'" [colPad]="\'auto\'"\n              [colMobile]="\'auto\'" [id]="col.id">\n              <div class="calendar-edit-alert-switcher"></div>\n            </app-ui-form-layout-col>\n            \x3c!-- End of Customize Alert2 --\x3e\n            <app-ui-form-layout-col *ngIf="!shouldHidden(col.id)" [colPC]="col.grid.pc" [colNB]="col.grid.nb"\n              [colPad]="col.grid.pad" [colMobile]="col.grid.mobile">\n              \x3c!-- Input --\x3e\n              <ng-container *ngIf="col.type===\'Input\'">\n                <app-ui-form-input [(nxValue)]="data[col.id]" (nxValueChange)="onChange(col.id,$event)"\n                  [inputTitle]="col.name | translate" [name]="col.name|translate" [isDisable]="false"\n                  [isError]="validationResult.isError(col.id)" [maxLength]="col.maxLength || 999" [id]="col.id">\n                </app-ui-form-input>\n              </ng-container>\n              \x3c!-- End of Input --\x3e\n              \x3c!-- Select --\x3e\n              <ng-container *ngIf="col.type===\'Select\'">\n                <app-ui-form-select [(nxValue)]="data[col.id]" (nxValueChange)="onChange(col.id,$event)"\n                  [selectTitle]="col.name | translate" [selectOption]="data[col.id+\'Option\']"\n                  [isShowTitle]="col.showTitle" [isError]="validationResult.isError(col.id)"\n                  [placeholder]="col.placeholder | translate" [id]="col.id" [isShowDefaultOption]="col.showDefaultOption">\n                </app-ui-form-select>\n              </ng-container>\n              \x3c!-- End of Select --\x3e\n              \x3c!-- Switch --\x3e\n              <ng-container *ngIf="col.type===\'Switch\'">\n                <app-ui-form-switcher [nxValue]="data[col.id]===\'Y\'" (nxValueChange)="onChange(col.id,$event)"\n                  [labelTxt]="!col.showTitle ? \'\' : col.name | translate " [id]="col.id">\n                </app-ui-form-switcher>\n              </ng-container>\n              \x3c!-- End of Switch --\x3e\n              \x3c!-- Date --\x3e\n              <ng-container *ngIf="col.type===\'Date\'">\n                <app-ui-form-date [nxValue]="data[col.id]" (nxValueChange)="onChange(col.id,$event)"\n                  [title]="col.name | translate" [isError]="validationResult.isError(col.id)" [id]="col.id">\n                </app-ui-form-date>\n              </ng-container>\n              \x3c!-- End of Date --\x3e\n              \x3c!-- Time --\x3e\n              <ng-container *ngIf="col.type===\'Time\'">\n                <app-ui-form-timepicker [nxValue]="data[col.id]" (nxValueChange)="onChange(col.id,$event)"\n                  [isError]="validationResult.isError(col.id)" [id]="col.id">\n                </app-ui-form-timepicker>\n              </ng-container>\n              \x3c!-- End of Time --\x3e\n              <app-ui-form-error-msg *ngIf="validationResult.getErrorMsg(col.id)">\n                {{validationResult.getErrorMsg(col.id) | translate}}</app-ui-form-error-msg>\n            </app-ui-form-layout-col>\n          </ng-container>\n        </app-ui-form-layout-row>\n      </ng-container>\n    </app-ui-form-layout-advanced>\n  </app-ui-form-layout-col>\n  <ng-container>\n\n  </ng-container>\n</ng-template>\n\x3c!-- end: formContent --\x3e\n\n<ng-template #eventListContent>\n  <app-ui-form-layout-col [colPC]="4" [colNB]="4" [colPad]="0" [colMobile]="0"\n    [ngStyle]="{ \'background-color\': eventListBGColor }" *ngIf="data && isMetaLoaded()">\n    <ng-container *ngIf="calendarEventList">\n      <div class="calendar-edit-schedule" [ngClass]="calendarEventList.length == 0? \'\':\'bgColor\'">\n\n        <app-ui-calendar-event-list [ngClass]="calendarEventList.length == 0? \'calendar-event-list-no-data\':\'\'"\n          [translateMap]="_translateMap" [title]="calendarEventList.length>0 ? showDate:\'\'"\n          [colorCode]="eventListBGColor" [eventList]="calendarEventList">\n          <div scheduleNoData>\n            <p class="calendar-list-noData-text">\n              {{this.translateMap.get(\'No_Schedule\') ? this.translateMap.get(\'No_Schedule\') : \'You have no schedule for today\'}}\n            </p>\n          </div>\n        </app-ui-calendar-event-list>\n      </div>\n    </ng-container>\n  </app-ui-form-layout-col>\n</ng-template>\n\x3c!-- end: evenListContent --\x3e\n',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}:host{display:flex;height:100%;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}:host>app-ui-form-layout-col{padding-left:0!important;margin-bottom:0!important;padding-right:0}:host>app-ui-form-layout-col:first-child{min-width:calc(100% - 200px);padding-left:20px!important;padding-right:20px}:host>app-ui-form-layout-col:last-child{max-width:200px}:host .calendar-edit-alert-switcher{display:inline-block;width:56px}:host ::ng-deep app-ui-form-title-sm{display:block;margin-bottom:-15px}:host ::ng-deep app-ui-text-type ::ng-deep .ui-text-type-container{padding:20px}:host ::ng-deep app-ui-text-type ::ng-deep .ui-text-type-container .ui-text-type-title{text-align:left}:host ::ng-deep app-ui-text-type ::ng-deep .ui-text-type-container app-ui-text-type-item:last-child{padding-bottom:20px;border-bottom:1px solid #ececec}:host ::ng-deep app-ui-text-type ::ng-deep .ui-text-type-content{width:100%;min-width:1px}:host ::ng-deep app-ui-text-type ::ng-deep .ui-text-type-content>p{display:block;max-width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}:host ::ng-deep .calendar-event-list-no-data{display:inline-block;width:100%;height:100%}:host ::ng-deep .calendar-event-list-no-data ::ng-deep app-ui-text-type .ui-text-type-container{width:100%;height:100%;padding:0}:host ::ng-deep .calendar-edit-schedule{width:100%;height:100%;margin:0;background-image:url(assets/img/appointment-noData.svg);background-color:#f5f5f5;background-repeat:no-repeat;background-size:cover;background-position:center bottom}:host ::ng-deep .calendar-edit-schedule.bgColor{background-image:none;background-color:#f5f5f5}:host ::ng-deep .calendar-edit-schedule .calendar-list-noData-text{padding:200px 25px 0}:host ::ng-deep .calendar-edit-schedule p{font-size:.875rem;font-weight:300;line-height:2;letter-spacing:.2px;text-align:center;color:#414141}@media screen and (max-width:1023px){:host>app-ui-form-layout-col:first-child{padding-left:0!important}:host>app-ui-form-layout-col:first-child,:host>app-ui-form-layout-col:last-child{max-width:100%}:host .calendar-edit-allDay-date ::ng-deep .ui-datepicker{margin-top:15px}:host [calendarEditAlertRow] app-ui-form-layout-col:last-child{flex:1!important;max-width:100%!important}:host ::ng-deep app-ui-form-layout-advanced .gas-layout-form .gas-row{justify-content:space-between}}"]}]}],t.ctorParameters=function(){return[{type:h.ElementRef},{type:j.MetaService},{type:j.ProfileCodeService},{type:j.DefaultMetaParser},{type:j.APIExecutor},{type:w},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[x]}]},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[M]}]},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[j.showRuleToken]}]}]},t.propDecorators={isMetaDataDone:[{type:h.Output}],isSaveClick:[{type:h.Input}],isSaveClickChange:[{type:h.Output}],clientID:[{type:h.Input}],customerItemList:[{type:h.Input}],translateMap:[{type:h.Input}],viewDate:[{type:h.Input}],todayCalendarEvent:[{type:h.Input}],saveEvent:[{type:h.Output}],customerClientID:[{type:h.Input}],onResize:[{type:h.HostListener,args:["window:resize",["$event"]]}]},t}(j.FormMetaComponent),O=function(){function t(){}return t.prototype.onDataUpdated=function(t){},t.prototype.onValidateAll=function(t){return!0},t.prototype.onValueChange=function(t,e,n,i,o,a){},t.prototype.btnClick=function(t,e,n){},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=h.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),F=function(l){function t(t,e,n,i,o,a,r){var s=l.call(this,e,n,i,o)||this;return s.DatePipe=t,s.isMetaDataDone=new h.EventEmitter,s._customerClientName="",s.language=new j.Language,s.isSameDay=!0,s.isAllDay=!1,s._metaController=null,s._clientID="",s._metaController=r||a,s}return y(t,l),Object.defineProperty(t.prototype,"calendarEventDetail",{get:function(){return this._calendarEventDetail},set:function(t){j.StringUtils.isNotEmpty(t)&&(this._calendarEventDetail=t,this.isSameDay=m.isSameDay(this._calendarEventDetail.end,this._calendarEventDetail.start),this.isAllDay=t.allDay,this._clientID=t.clientID,this.isMetaLoaded()&&this.loadData())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"customerClientName",{get:function(){return this._customerClientName},set:function(t){var e=this;this._customerClientName=t,this.waitUntilMetaLoaded().then(function(){e.onDataUpdated()})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowConfig",{get:function(){return this.metaConfig.Rows},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){l.prototype.ngOnInit.call(this)},t.prototype.getMetaID=function(){return"calendarDetail"},t.prototype.getMetaParams=function(){return{_clientID:this._clientID}},t.prototype.onDataUpdated=function(){l.prototype.onDataUpdated.call(this),console.log("calendar-detail onDataUpdated:",this._data),this._data.CustomerClientName=this._customerClientName,this._data.DisplayDate=this.getDisplayDateHTML(),this.isMetaDataDone.emit(!0)},t.prototype.getDisplayDateHTML=function(){var t=new Date(this._data.StartTime),e=new Date(this._data.EndTime);return this.isAllDay?this.DatePipe.transform(t,"MM/dd/y")+"-"+this.DatePipe.transform(e,"MM/dd/y"):this.isSameDay?this.DatePipe.transform(t,"MM/dd/y HH:mm")+"-"+this.DatePipe.transform(e,"HH:mm"):this.DatePipe.transform(t,"MM/dd/y HH:mm")+"-<br />"+this.DatePipe.transform(e,"MM/dd/y HH:mm")},t.decorators=[{type:h.Component,args:[{selector:"snd-calendar-detail",template:'<div class="calendar-detail-content">\n  <ng-container *ngIf="data && isMetaLoaded()">\n    <ng-container *ngFor="let row of rowConfig">\n      <app-ui-info-text2 *ngIf="data[row[0].id]">\n        <ng-container textType="title">{{row[0].name | translate}}</ng-container>\n        <ng-container *ngFor="let col of row; last as isLast" textType="text">\n          <span [innerHtml]="data[col.id]"></span>\n          <br *ngIf="!isLast" />\n        </ng-container>\n      </app-ui-info-text2>\n    </ng-container>\n  </ng-container>\n</div>\n',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.calendar-detail-content{padding-top:30px}.calendar-detail-content ::ng-deep .gas-layout-form .gas-row-block:first-child{margin-top:0}.calendar-detail-content ::ng-deep app-ui-info-text2:not(:last-child){display:block;margin-bottom:30px}.calendar-detail-content ::ng-deep app-ui-info-text2 .info-unit-block .title-block{margin-bottom:0}.calendar-detail-content ::ng-deep app-ui-info-text2 .info-unit-block .text-block>p{color:#414141;font-weight:300}@media screen and (max-width:1023px){.calendar-detail-content{padding-top:0}}"]}]}],t.ctorParameters=function(){return[{type:o.DatePipe},{type:j.MetaService},{type:j.ProfileCodeService},{type:j.DefaultMetaParser},{type:j.APIExecutor},{type:O},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[k]}]}]},t.propDecorators={isMetaDataDone:[{type:h.Output}],calendarEventDetail:[{type:h.Input}],customerClientName:[{type:h.Input}]},t}(j.DisplayMetaComponent),R=function(){function t(){this._optionMap=new Map,this.activityTypeList=[],this.currentFilterOptionList=[],this.activityTypeListChange=new h.EventEmitter}return t.prototype.ngOnInit=function(){},Object.defineProperty(t.prototype,"optionMap",{get:function(){return this._optionMap},set:function(t){var e=this;this._optionMap=t,this.activityTypeList=this._optionMap.get("Calendar_Type"),this.activityTypeList.forEach(function(t){t.isCheck&&e.currentFilterOptionList.push(t.getCode())})},enumerable:!0,configurable:!0}),t.prototype.onActivityFilter=function(){this.activityTypeListChange.emit(this.activityTypeList)},t.prototype.toActivityColor=function(t){return JSON.parse(t.getArguments()).color},t.decorators=[{type:h.Component,args:[{selector:"snd-calendar-filter",template:'<ng-container *ngIf="activityTypeList">\n  <div class="calendar-filter-item" *ngFor=" let codeItem of activityTypeList">\n    <app-ui-form-checkbox [(nxValue)]="codeItem.isCheck" [isDisable]="false" (nxValueChange)="onActivityFilter()" [colorCode]="toActivityColor(codeItem)" >\n      <ng-container checkboxText="style2">{{codeItem.displayText}}</ng-container>\n    </app-ui-form-checkbox>\n  </div>\n</ng-container>\n',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.calendar-filter-item:not(:last-child){margin-bottom:25px}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={optionMap:[{type:h.Input}],activityTypeListChange:[{type:h.Output}]},t}(),H=function(){function t(t,e){this._primary=t,this._secondary=e}return t.prototype.setCalendarEventColor=function(t,e){this._primary=t,this._secondary=e},Object.defineProperty(t.prototype,"primary",{get:function(){return this._primary},set:function(t){this._primary=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"secondary",{get:function(){return this._secondary},set:function(t){this._secondary=t},enumerable:!0,configurable:!0}),t}(),U=function(){function t(t,e,n,i,o,a,r,s,l,c,u,p,d,m,g){this._clientID=t,this._calendarID=e,this._customerClientID=n,this._title=i,this._location=o,this._activity=a,this._isAllDay="Y"==r,this._start=new Date(s),this._end=new Date(l),this._isAlert="Y"==c,this._alert1=u,this._alert2=p,this._alert3=d,this._remark=m,j.StringUtils.isEmpty(this._customerClientID)&&(this._customerClientID=null),j.StringUtils.isEmpty(this._activity)&&(this._activity=null),j.StringUtils.isEmpty(this._title)&&(this._title=""),j.StringUtils.isEmpty(this._location)&&(this._location=""),j.StringUtils.isEmpty(this._alert1)&&(this._alert1=""),j.StringUtils.isEmpty(this._alert2)&&(this._alert2=null),j.StringUtils.isEmpty(this._alert3)&&(this._alert3=""),j.StringUtils.isEmpty(this._remark)&&(this._remark="");var h=JSON.parse(g);null!=h&&(this._color=new H(h.color,h.backgroundColor))}return Object.defineProperty(t.prototype,"clientID",{get:function(){return this._clientID},set:function(t){this._clientID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"calendarID",{get:function(){return this._calendarID},set:function(t){this._calendarID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"customerClientID",{get:function(){return this._customerClientID},set:function(t){this._customerClientID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._title},set:function(t){this._title=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){return this._location},set:function(t){this._location=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activity",{get:function(){return this._activity},set:function(t){this._activity=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allDay",{get:function(){return this._isAllDay},set:function(t){this._isAllDay=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this._start},set:function(t){this._start=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._end},set:function(t){this._end=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAlert",{get:function(){return this._isAlert},set:function(t){this._isAlert=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alert1",{get:function(){return this._alert1},set:function(t){this._alert1=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alert2",{get:function(){return this._alert2},set:function(t){this._alert2=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alert3",{get:function(){return this._alert3},set:function(t){this._alert3=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remark",{get:function(){return this._remark},set:function(t){this._remark=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){var e=JSON.parse(t);null!=e&&(this._color=new H(e.color,e.backgroundColor))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayActivity",{get:function(){return this._displayActivity},set:function(t){this._displayActivity=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayAlert1",{get:function(){return this._displayAlert1},set:function(t){this._displayAlert1=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayAlert2",{get:function(){return this._displayAlert2},set:function(t){this._displayAlert2=t},enumerable:!0,configurable:!0}),t}(),q=function(){function t(t,e,n){this.dispatch=t,this.profileCodeService=e,this.APIFactory=n}return t.prototype.getCalendarEventList=function(t,e,n){var s=this;console.debug("calendar-service-getCalendarEventList",t,e,n);var i=this.APIFactory.getAPI("getCalendarEventList");return i.startTime=t,i.endTime=e,f.Observable.create(function(r){s.dispatch.dispatch(i).subscribe(function(t){console.debug("calendar-service-getCAlendarEventList response",t);var e=[],n=t.Body;if(n){for(var i=0;i<n.length;i++){var o=n[i],a=new U(o.ClientID,o.CalendarID,o.CustomerClientID,o.Title,o.Location,o.CalendarType,o.IsAllDay,new Date(o.StartTime),new Date(o.EndTime),o.Remark,o.IsAlert,o.Alert1,o.Alert2,o.Alert3,s.profileCodeService.getArgumentsByCode("Calendar_Type",o.CalendarType));e.push(a)}e=s.sortCalendarEventList(e),r.next(e),r.complete()}else r.next([]),r.complete()})})},t.prototype.getCalendarEventDetail=function(t){var o=this,e=this.APIFactory.getAPI("getCalendarEventDetail");return e.ClientID=t,f.Observable.create(function(i){o.dispatch.dispatch(e).subscribe(function(t){var e,n=t.Body;n=n[0],e=new U(n.ClientID,n.CalendarID,n.CustomerClientID,n.Title,n.Location,n.CalendarType,n.IsAllDay,new Date(n.StartTime),new Date(n.EndTime),n.IsAlert,n.Alert1,n.Alert2,n.Alert3,n.Remark,o.profileCodeService.getArgumentsByCode("Calendar_Type",n.CalendarType)),i.next(e),i.complete()})})},t.prototype.deleteCalendarEvent=function(t){var n=this,i=this.APIFactory.getAPI("deleteCalendarEvent");return i.clientID=t,f.Observable.create(function(e){n.dispatch.dispatch(i).subscribe(function(t){e.next(t.Header),e.complete()})})},t.prototype.addCalendarEvent=function(t){var n=this;t=this.adjustAlert(t);var i=this.APIFactory.getAPI("addCalendarEvent");return i.setCalendarEvent(t),f.Observable.create(function(e){n.dispatch.dispatch(i).subscribe(function(t){e.next(t.Header),e.complete()})})},t.prototype.updateCalendarEvent=function(t,e){var n=this;e=this.adjustAlert(e);var i=this.APIFactory.getAPI("updateCalendarEvent");return i.ClientID=t,i.setCalendarEvent(e),f.Observable.create(function(e){n.dispatch.dispatch(i).subscribe(function(t){e.next(t.Header),e.complete()})})},t.prototype.adjustAlert=function(t){if("Default"==t.alert1&&(t.alert1=""),"Default"==t.alert2&&(t.alert2=""),t.isAlert&&j.StringUtils.isNotEmpty(t.alert1)&&j.StringUtils.isNotEmpty(t.alert2)){if(t.allDay){if(JSON.parse(this.profileCodeService.getArgumentsByCode("Calendar_RemindTime",t.alert1)).day>JSON.parse(this.profileCodeService.getArgumentsByCode("Calendar_RemindTime",t.alert2)).day){var e=t.alert1;t.alert1=t.alert2,t.alert2=e}}else if(JSON.parse(this.profileCodeService.getArgumentsByCode("Calendar_RemindTime",t.alert1)).min>JSON.parse(this.profileCodeService.getArgumentsByCode("Calendar_RemindTime",t.alert2)).min){e=t.alert1;t.alert1=t.alert2,t.alert2=e}}else t.isAlert||(t.alert1="",t.alert2="",t.alert3="");return t.color=this.profileCodeService.getArgumentsByCode("Calendar_Type",t.activity),t},t.prototype.calendarValidation=function(t){var e=new j.ValidationResult;return""==t.title&&e.setErrorMap("title","required"),60<t.title.length&&e.setErrorMap("title","maxLength"),""==t.location&&e.setErrorMap("location","required"),100<t.location.length&&e.setErrorMap("location","maxLength"),"Default"!=t.activity&&""!=t.activity||e.setErrorMap("activity","required"),1==t.isAlert&&"Default"==t.alert1&&"Default"==t.alert2&&e.setErrorMap("alert1","required"),1==t.isAlert&&t.alert1==t.alert2&&"Default"!=t.alert1&&e.setErrorMap("alert2","sameAlert"),m.differenceInMinutes(t.end,t.start)<15&&0<=m.differenceInMinutes(t.end,t.start)&&1!=t.allDay?e.setErrorMap("time","minTime"):m.differenceInMinutes(t.end,t.start)<0&&e.setErrorMap("time","errorTime"),500<t.remark.length&&e.setErrorMap("remark","maxLength"),e},t.prototype.sortCalendarEventList=function(t){for(var e=0;e<t.length-1;e++)for(var n=e+1;n<t.length;n++)if(t[n].allDay&&!t[e].allDay){var i=t[e];t[e]=t[n],t[n]=i}for(e=0;e<t.length-1;e++)for(n=e+1;n<t.length;n++)if(t[n].allDay==t[e].allDay)if(t[e].allDay){if(t[n].start<t[e].start){i=t[e];t[e]=t[n],t[n]=i}else if(m.isSameDay(t[n].start,t[e].start)&&t[n].end>t[e].end){i=t[e];t[e]=t[n],t[n]=i}}else if(t[n].start<t[e].start){i=t[e];t[e]=t[n],t[n]=i}return t},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:j.APIDispatch},{type:j.ProfileCodeService},{type:j.APIFactory}]},t.ngInjectableDef=h.defineInjectable({factory:function(){return new t(h.inject(j.APIDispatch),h.inject(j.ProfileCodeService),h.inject(j.APIFactory))},token:t,providedIn:"root"}),t}(),z=function(){function t(){}return t.prototype.addValues=function(t,e){this[t]=e},t}(),W=function(){function e(t,e){void 0===t&&(t=""),void 0===e&&(e=new Map),this.filterMap=new Map,this.optionMap=new Map,this.extension={},this._keyword=t,this.filterMap=e}return e.prototype.addCriteria=function(t,e){var n=this.filterMap.get(t);n==undefined&&(n=new Array),n.includes(e)||(n.push(e),this.filterMap.set(t,n))},e.prototype.addCriteriaCols=function(t,e){this.filterMap.set(t,e)},e.prototype.hasCriteria=function(){return 0!=this.filterMap.size||j.StringUtils.isNotEmpty(this._keyword)},Object.defineProperty(e.prototype,"keyword",{get:function(){return this._keyword},set:function(t){this._keyword=t},enumerable:!0,configurable:!0}),e.prototype.getFilterMap=function(){return this.filterMap},e.prototype.getOptionMap=function(){return this.optionMap},e.prototype.setOption=function(t,e){this.optionMap.set(t,e)},e.prototype.getOption=function(t){return this.optionMap.has(t)?this.optionMap.get(t):null},e.prototype.toPresetJSON=function(){var n=new z;return this.filterMap.forEach(function(t,e){n.addValues(e,t)}),console.debug("toPresetJSON",n),n},e.prototype.toMetaJSON=function(){var n=this.toPresetJSON();return this.optionMap.forEach(function(t,e){n.addValues(e,t)}),n},e.prototype.clone=function(){var t=new e;return t._keyword=this._keyword,t.filterMap=new Map(this.filterMap),t.optionMap=new Map(this.optionMap),t.extension=Object.assign({},this.extension),t},e}(),Y=function(){function t(t,e,n,i,o,a,r,s){this._clientID=t,this._firstName=e,this._lastName=n,this._tag=i,this._complementPercent=o,this._isFollow=a,this._isOtherSource=r,"Y"==s&&(this._isHighlight=!0),j.StringUtils.isEmpty(this._firstName)&&(this._firstName="")}return Object.defineProperty(t.prototype,"isOtherSource",{get:function(){return this._isOtherSource},set:function(t){this._isOtherSource=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFollow",{get:function(){return this._isFollow},set:function(t){this._isFollow=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientID",{get:function(){return this._clientID},set:function(t){this._clientID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstName",{get:function(){return this._firstName},set:function(t){this._firstName=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastName",{get:function(){return this._lastName},set:function(t){this._lastName=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tag",{get:function(){return this._tag},set:function(t){this._tag=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"complementPercent",{get:function(){return this._complementPercent},set:function(t){this._complementPercent=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHighlight",{get:function(){return this._isHighlight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHighLight",{set:function(t){this._isHighlight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showName",{get:function(){return this._showName},set:function(t){this._showName=t},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this._clientID,this._firstName,this._lastName,this._tag,this._complementPercent,this._isFollow,this._isOtherSource,this._isHighlight?"Y":"N")},t}(),$=function(){function t(t,e){this._clientID=t,this._name=e}return Object.defineProperty(t.prototype,"clientID",{get:function(){return this._clientID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}(),G=function(){function t(t,e,n,i){this.clientID=t,this.telType=e,this.tel=n,this.dataSource=i}return t.prototype.isEmpty=function(){return j.StringUtils.isEmpty(this.tel)},t}(),J=function(){function t(t,e,n,i,o){this._clientID=t,this.firstName=e,this.lastName=n,this.birthdayMonth=i,this.birthdayDate=o,j.StringUtils.isEmpty(this.firstName)&&(this.firstName="")}return t.prototype.clone=function(){return new t(this._clientID,this.firstName,this.lastName,this.birthdayMonth,this.birthdayDate)},t}(),Q=function(){function t(t){this.profileCodeService=t}return t.prototype.getRestriction=function(t){var y=this;console.debug("DefaultCustomerCriteriaSearch criteria:",t);var e=t.keyword,b=[];if(console.debug("customerListAPI keyword",e),j.StringUtils.isNotEmpty(e)){var n=new j.ORCompoundRestriction([new j.LikeRestriction("FirstName",[e]),new j.LikeRestriction("LastName",[e])]);b.push(n)}return t.getFilterMap().forEach(function(a,t){var e,n;if(console.log(t,a),"Birthday"==t){var i=new Array,o=new Array;try{for(var r=B(a),s=r.next();!s.done;s=r.next()){var l=s.value;if("Today"==l){var c=new Date,u=c.getMonth()+1,p=c.getDate(),d=String(u),m=String(p);1==d.length&&(d="0"+d),1==m.length&&(m="0"+m),i.push(new j.AndCompoundRestriction([new j.EqualRestriction("BirthdayMonth",[d]),new j.EqualRestriction("BirthdayDate",[m])]))}else 1==l.length&&(l="0"+l),o.push(l)}}catch(f){e={error:f}}finally{try{s&&!s.done&&(n=r["return"])&&n.call(r)}finally{if(e)throw e.error}}0!=o.length&&i.push(new j.InRestriction("BirthdayMonth",o)),b.push(new j.ORCompoundRestriction(i))}else if("CustomerSource"==t){if(2!=a.length)"E"==a[0]?b.push(new j.EqualRestriction("DataSource",["OPUS"])):b.push(new j.NotEqualRestriction("DataSource",["OPUS"]))}else if("Completeness"==t){var g=y.profileCodeService.getCodeArray("Customer_Completeness"),h=new Array;g.forEach(function(t){var e=t.getCode();if(a.includes(e)){var n=JSON.parse(t.getArguments()),i=n.start,o=n.end;i/=100,o/=100,h.push(new j.AndCompoundRestriction([new j.GreaterOrEqualRestriction("Completeness",[i]),new j.LessOrEqualRestriction("Completeness",[o])]))}}),console.debug("completenessRestriction length",h.length),console.log("completenessRestriction:",h),0!=h.length&&b.push(new j.ORCompoundRestriction(h))}else b.push(new j.InRestriction(t,a))}),b},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:j.ProfileCodeService}]},t.ngInjectableDef=h.defineInjectable({factory:function(){return new t(h.inject(j.ProfileCodeService))},token:t,providedIn:"root"}),t}(),K=function(){function t(t,e,n,i,o){this.dispatcher=t,this.APIFactory=e,this.profileCodeService=n,this.defaultCriteriaSearch=i,this.customCriteriaSearch=o,this._isFirstTime=!0}return t.prototype.isFirstTime=function(){return this._isFirstTime?!(this._isFirstTime=!1):this._isFirstTime},t.prototype.updateMessageToRead=function(t,e){var n=this,i=this.APIFactory.getAPI("updateDashboardToRead");return i.setMessageType(t),i.setMessageDataCategory(e),f.Observable.create(function(e){n.dispatcher.dispatch(i).subscribe(function(t){console.debug("dashboard-service-updateMessageToRead",t),e.next(t.Header),e.complete()})})},t.prototype.getOverTimeCustomerList=function(t){var e=this,n=this.APIFactory.getAPI("getCustomerOverTime");return n.setClientID(t),f.Observable.create(function(l){e.dispatcher.dispatch(n).subscribe(function(t){console.debug("customer-service-getOverTimeList",t);for(var e=new Array,n=t.Body,i=0;i<n.length;i++)for(var o=n[i],a=JSON.parse(o.Arguments).customers,r=0;r<a.length;r++){var s=new $(a[r].id,a[r].name);e.push(s)}l.next(e),l.complete()})})},t.prototype.getAutoDeleteCustomerList=function(t){var e=this,n=this.APIFactory.getAPI("getCustomerAutoDelete");return n.setClientID(t),f.Observable.create(function(l){e.dispatcher.dispatch(n).subscribe(function(t){console.log("customer-service-getAutoDeleteCustomerList",t);for(var e=new Array,n=t.Body,i=0;i<n.length;i++)for(var o=n[i],a=JSON.parse(o.Arguments).customers,r=0;r<a.length;r++){var s=new $(a[r].id,a[r].name);e.push(s)}l.next(e),l.complete()})})},t.prototype.updateCustomerFollowStatus=function(t,e){var n=this,i=this.APIFactory.getAPI("updateCustomerFollowStatus");return i.setClient(t),i.setIsFollow(e),f.Observable.create(function(e){n.dispatcher.dispatch(i).subscribe(function(t){console.debug("customer-service-updateCustomerFollowStatus",t),e.next(t.Header),e.complete()})})},t.prototype.getFilterCriteriaPreset=function(){var t=this,e=this.APIFactory.getAPI("getCustomerFilterPreset");return f.Observable.create(function(i){t.dispatcher.dispatch(e).subscribe(function(t){console.debug("customer-service-getFilterCriteria",t);var e,n=t.Body;(n.length=!0)&&(e=JSON.parse(n[0].SettingVal)),console.debug("customer-service-getFilterCriteriaPreset",e),i.next(e),i.complete()})})},t.prototype.saveFilterCriteria=function(t){var n=this,i=this.APIFactory.getAPI("saveCustomerFilterPreset");return i.setFilterCriteria(t),f.Observable.create(function(e){n.dispatcher.dispatch(i).subscribe(function(t){console.debug("customer-service-saveFilterCriteria",t),e.next(t),e.complete()})})},t.prototype.checkInFilterCriteria=function(t,e){var n=this,i=this.APIFactory.getAPI("getCustomerList"),o=[];return o=this.customCriteriaSearch?this.customCriteriaSearch.getRestriction(e):this.defaultCriteriaSearch.getRestriction(e),i.restrictions=o,i.clientID=t,f.Observable.create(function(e){n.dispatcher.dispatch(i).subscribe(function(t){console.debug("customer-service-checkInFilterCriteria",t),e.next(0!=t.Body.length),e.complete()})})},t.prototype.getCustomerList=function(t,e){var n=this,i=[];i=this.customCriteriaSearch?this.customCriteriaSearch.getRestriction(t):this.defaultCriteriaSearch.getRestriction(t);var o=this.APIFactory.getAPI("getCustomerList");return console.debug("customer-service-getCustomerList",t,i,e),o.restrictions=i,o.pageInfo=e,f.Observable.create(function(u){n.dispatcher.dispatch(o).subscribe(function(t){console.debug("customer-service-getCustomerList",t);for(var e=new Array,n=(t.Header,t.Body),i=0;i<n.length;i++){var o=n[i],a="APP"!=o.DataSource,r="Y"==o.IsFollow,s=o.Completeness,l=o.IsOverTimeAlert,c=new Y(o.ClientID,o.FirstName,o.LastName,o.Possibility,s,r,a,l);e.push(c)}u.next(e),u.complete()})})},t.prototype.getCustomerBirthdayList=function(t,e,n){var i=this,o=this.APIFactory.getAPI("getCustomerBirthdayList");return o.subN=e,o.addN=n,o.targetDate=t,f.Observable.create(function(a){i.dispatcher.dispatch(o).subscribe(function(t){console.debug("customer-service-getCustomerBirthdayList",t);var e=[],n=t.Body;console.log("cusSer: ",n);for(var i=0;i<n.length;i++){var o=new J(n[i].ClientID,n[i].FirstName,n[i].LastName,n[i].BirthdayMonth,n[i].BirthdayDate);e.push(o)}a.next(e),a.complete()})})},t.prototype.getCustomerDetail=function(t){if(j.StringUtils.isEmpty(t))return f.of(undefined);var e=this.APIFactory.getAPI("getCustomerDetail");return e.id=t,f.from(this.dispatcher.dispatch(e).toPromise().then(function(t){return t.Header.status&&0<t.Body.length?t.Body[0]:null}))},t.prototype.importContact=function(t){var n=this,i=this.APIFactory.getAPI("importContact");return console.debug("customer-service-importContact",t),i.setItems(t),f.Observable.create(function(e){n.dispatcher.dispatch(i).subscribe(function(t){console.debug("customer-service-importContact",t),e.next(t.Header),e.complete()})})},t.prototype.validProfile=function(t){var e=this,n=new j.ValidationResult;if(j.StringUtils.isEmpty(t.lastName)&&n.setErrorMap("lastName","required"),0!=t.emails.length){var i=0;t.emails.forEach(function(t){t.isEmpty()||e.isEmailFormat(t.email)||n.setErrorMap(("email"+i).toString(),"format"),i++})}return n},t.prototype.isEmailFormat=function(t){return new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/).test(t)},t.prototype.deleteCustomerProfile=function(t){var n=this;console.log("deleteCustomerProfile",t);var i=this.APIFactory.getAPI("deleteCustomer");return i.clientID=t,f.Observable.create(function(e){n.dispatcher.dispatch(i).subscribe(function(t){console.debug("customer-service-deleteCustomerProfile",t),e.next(t.Header),e.complete()})})},t.prototype.getCustomerContactNote=function(t,e){var i=this,o=this.APIFactory.getAPI("getCustomerContactNote");return o.setClientID(t),o.setPageInfo(e),console.debug("customer-service-getCustomerContactNote",o),f.Observable.create(function(n){i.dispatcher.dispatch(o).subscribe(function(t){console.debug("customer-service-getCustomerContactNote",t);var e=t.Body;n.next(e),n.complete()})})},t.prototype.deleteCustomerContact=function(t){var n=this;console.log("deleteCustomerContact");var i=this.APIFactory.getAPI("deleteCustomerContactNote");return i.setContactClientID(t),f.Observable.create(function(e){n.dispatcher.dispatch(i).subscribe(function(t){console.debug("customer-service-editCustomerContact",t),e.next(t.Header),e.complete()})})},t.prototype.getCustomerContactTel=function(t){var i=this,e=this.APIFactory.getAPI("getCustomerTel");return e.setClientID(t),console.debug("customer-service-getCustomerContactTel",e),f.Observable.create(function(n){i.dispatcher.dispatch(e).subscribe(function(t){console.debug("customer-service-getCustomerContactTel response",t);var e=new Array;t.Body.map(function(t){return new G(t.ClientID,i.profileCodeService.convertCode2Text("Customer_TelType",t.TelType),t.Tel,t.DataSource)}).forEach(function(t){e.push(t)}),n.next(e),n.complete()})})},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:j.APIDispatch},{type:j.APIFactory},{type:j.ProfileCodeService},{type:Q},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[P]}]}]},t.ngInjectableDef=h.defineInjectable({factory:function(){return new t(h.inject(j.APIDispatch),h.inject(j.APIFactory),h.inject(j.ProfileCodeService),h.inject(Q),h.inject(P,8))},token:t,providedIn:"root"}),t}(),Z=function(){function t(t,e,n){this.profileCodeService=t,this.showRule=e,this.customerShowRule=n}return t.prototype.setCode2Option=function(t){var e,n,i=new Array;if(t!=undefined)try{for(var o=B(t),a=o.next();!a.done;a=o.next()){var r=a.value;i.push(new j.SelectOption(r.getCode(),r.displayText))}}catch(s){e={error:s}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(e)throw e.error}}return i},t.prototype.countCompleteness=function(t){return console.log("this.customerShowRule: ",this.customerShowRule),this.customerShowRule?this.customerShowRule.calculateCompleteness(t):0},t.prototype.setCustomerDefaultValue=function(t){if(j.StringUtils.isNotEmpty(t.getValue("BirthdayYear"))&&j.StringUtils.isNotEmpty(t.getValue("BirthdayMonth"))&&j.StringUtils.isNotEmpty(t.getValue("BirthdayDate"))){var e=new Date(Number(t.getValue("BirthdayYear")),Number(t.getValue("BirthdayMonth")-1),Number(t.getValue("BirthdayDate"))),n=this.countAge(e);if(t.setValue("age",n),j.StringUtils.isEmpty(t.getValue("AgeRange"))){var i=this.countAgeRange(n);i!=undefined&&t.setValue("AgeRange",i)}}},t.prototype.countAgeRange=function(i){var o;console.debug("countAgeRange",i);var t=this.profileCodeService.getCodeArray("Customer_Age");return console.log("ageRange:",t),t.forEach(function(t){var e=t.getArguments();console.debug("customer-utils countAgeRange args",e);var n=JSON.parse(e);console.debug("customer-utils countAgeRange obj",n),i>=n.start&&i<=n.end&&(console.debug("match age range",t.getCode()),o=t.getCode())}),console.debug("rangeResult",o),o},t.prototype.countAge=function(t){var e=this.calCEIntervalDays(t,new Date);console.debug("dates",e);var n=Math.floor(e/365);return console.debug("age",n),n},t.prototype.calRocIntervalDays=function(t,e){t=this.leftPad(t,7,"0"),e=this.leftPad(e,7,"0");var n=t.substring(3,5)+"/"+t.substring(5)+"/"+(Number(t.substring(0,3))+Number(1911)),i=e.substring(3,5)+"/"+e.substring(5)+"/"+(Number(e.substring(0,3))+Number(1911)),o=new Date(n),a=new Date(i).getTime()-o.getTime();return Math.floor(a/864e5)},t.prototype.calCEIntervalDays=function(t,e){return m.differenceInCalendarDays(e,t)},t.prototype.leftPad=function(t,e,n){if(t.toString().length<e)for(var i=1;i<e&&!((t=n+t).toString().length>=e);i++);return t},t.prototype.convertNameToShow=function(t,e){return this.showRule?this.showRule.convertName(t,e):(j.StringUtils.isNotEmpty(t)?t:"")+(j.StringUtils.isNotEmpty(e)?" "+e:"")},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:j.ProfileCodeService},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[j.showRuleToken]}]},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[L]}]}]},t.ngInjectableDef=h.defineInjectable({factory:function(){return new t(h.inject(j.ProfileCodeService),h.inject(j.showRuleToken,8),h.inject(L,8))},token:t,providedIn:"root"}),t}(),X=function(){function t(t,e,n,i,o,a,r,s,l,c){this.changeDetector=t,this.elementRef=e,this.settingService=n,this.translateService=i,this.calendarService=o,this.profileCodeService=a,this.customerService=r,this.customerUtils=s,this.modalManager=l,this.dataSyncService=c,this._parentHeight=0,this.parentHeightChange=new h.EventEmitter,this.YEAR="year",this.MONTH="month",this.WEEK="week",this.DAY="day",this.viewTypeIndex=2,this.viewType=this.MONTH,this.viewDate=new Date,this.weekStartsOn=1,this.calendarHeight=0,this.clientID="",this.translateMap=new Map,this.optionMap=new Map,this.customerItemList=[],this.storeStartDate=new Date,this.storeEndDate=new Date,this.calendarEventList=[],this.calendarEventListAfterFilter=[],this.viewDateCalendarEventList=[],this.calendarEventEdit=null,this.customerClientMap=new Map,this.activityTypeList=[],this.alertTypeList=[],this.language=new j.Language,this.currentFilterOptionList=[],this.isExpandFilter=!1,this.isExpandDetail=!1,this.isExpandEdit=!1,this.isDelete=!1,this.isSave=!1,this.isSaveClick=!1,this.isCalendarDelete=!1,this.isLoading=!1,this.isCalendarEditMetaDataDone=!1,this.isCalendarDetailMetaDataDone=!1,this.dayTypesList=["Cross_Day","All_Day"],this.weekdaysList=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.monthsList=["January","February","March","April","May","June","July","August","September","October","November","December"],this.noSchedule="No_Schedule",this.outsideSpace={top:0,left:0},this.paddindData={top:10,right:10,bottom:10,left:1023<window.innerWidth?170:10}}return Object.defineProperty(t.prototype,"parentHeight",{get:function(){return this._parentHeight},set:function(t){this._parentHeight=t,0==this._parentHeight&&(this._parentHeight=window.innerHeight),this.parentHeightChange.emit(this._parentHeight);var e=this.titleBtnsBlock.nativeElement,n=e.getBoundingClientRect();this.calendarHeight=this._parentHeight-n.height-parseInt(window.getComputedStyle(e).marginBottom),this.changeDetector.markForCheck()},enumerable:!0,configurable:!0}),t.prototype.onResize=function(t){this.windowWidth=t.target.innerWidth,this.calcuContentHeight(),this.scrollToCurrentTime(),console.log("calendar inside cacualte height"),this.changeDetector.markForCheck()},t.prototype.ngOnInit=function(){var e=this;this.activityTypeList=this.profileCodeService.getCodeArray("Calendar_Type"),this.alertTypeList=this.profileCodeService.getCodeArray("Calendar_RemindTime"),this.optionMap.set("Calendar_Type",this.activityTypeList),this.optionMap.set("Calendar_RemindTime",this.alertTypeList),this.dayTypesList.forEach(function(t){e.translateMap.set(t,e.translateService.translate(t))}),this.weekdaysList.forEach(function(t){e.translateMap.set(t,e.translateService.translate(t))}),this.monthsList.forEach(function(t){e.translateMap.set(t,e.translateService.translate(t))}),this.translateMap.set(this.noSchedule,this.translateService.translate(this.noSchedule)),this.windowWidth=window.innerWidth,this.windowWidth<1024&&(this.viewTypeIndex=0,this.changeDetector.markForCheck());var t=this.settingService.getSetting("CalendarFilterSetting").SettingVal;if(j.StringUtils.isNotEmpty(t)){var i=JSON.parse(t);0==Object.keys(i).length?this.activityTypeList.forEach(function(t){t.isCheck=!0}):this.activityTypeList.forEach(function(t){var e=t.getCode(),n=i[e]!=undefined&&i[e];t.isCheck=n})}this.setCurrentFilterOption(undefined),this.typeChange(this.viewTypeIndex),this.loadCalendarData(),this.createCustomerList()},t.prototype.ngAfterViewInit=function(){this.typeChange(this.viewTypeIndex)},t.prototype.switchPadViewMode=function(t){console.debug("switchPadViewMode:",this.viewDate),t!=this.viewTypeIndex&&(this.typeChange(t),this.changeDetector.detectChanges(),this.loadCalendarData())},t.prototype.typeChange=function(t){var e,n;switch(console.debug("calendar-component-typeChange",t,this.viewType,this.viewDate),this.viewTypeIndex=t){case 3:this.viewType=this.YEAR,this.calcuContentHeight();break;case 2:this.viewType=this.MONTH,this.calcuContentHeight(),e=m.startOfMonth(this.viewDate),n=m.endOfMonth(this.viewDate);break;case 1:this.viewType=this.WEEK,e=m.startOfWeek(this.viewDate,{weekStartsOn:1}),n=m.endOfWeek(this.viewDate,{weekStartsOn:1}),this.scrollToCurrentTime();break;case 0:this.viewType=this.DAY,e=m.startOfDay(this.viewDate),n=m.endOfDay(this.viewDate),this.scrollToCurrentTime()}this.viewType!=this.YEAR&&j.StringUtils.isNotEmpty(e)&&j.StringUtils.isNotEmpty(n)&&(this.storeStartDate=e,this.storeEndDate=n),console.debug("calendar-component-typeChange done")},t.prototype.mobileBackViewType=function(){switch(console.debug("mobileBackViewType",this.viewType),this.viewType){case this.MONTH:this.typeChange(3);break;case this.WEEK:case this.DAY:this.typeChange(2)}this.loadCalendarData()},t.prototype.clickToday=function(){this.viewDate=new Date,console.warn("clickToday",this.viewDate),this.changeDetector.detectChanges(),this.typeChange(this.viewTypeIndex),this.loadCalendarData(),this.loadViewDateCalendarEventList()},t.prototype.onViewDateChange=function(t){var e=new Date(t.viewDate),n=t.action;console.debug("calendar-component update viewDate:",e),console.debug("calendar-component update viewDate:",e,this.viewType),console.debug("this.viewDate:",this.viewDate,m.isSameMonth(this.viewDate,e)),this.isPad()&&m.isSameMonth(this.viewDate,e)&&this.viewType===this.MONTH?this.viewDate=e:(this.viewDate=e,this.viewType==this.YEAR&&n==j.ChangeAction.CLICK?this.typeChange(2):this.viewType!=this.MONTH||this.isPad()||n!=j.ChangeAction.CLICK?this.typeChange(this.viewTypeIndex):this.typeChange(0),this.loadViewDateCalendarEventList(),this.loadCalendarData())},t.prototype.loadCalendarData=function(){var e=this;console.debug("loadCalendar data"),this.viewType!==this.YEAR&&(20<this.calendarEventListAfterFilter.length&&(this.calendarEventListAfterFilter=[]),j.StringUtils.isNotEmpty(this.storeStartDate)&&j.StringUtils.isNotEmpty(this.storeEndDate)&&this.calendarService.getCalendarEventList(this.storeStartDate,this.storeEndDate,"").subscribe(function(t){e.calendarEventList=t,e.refreshCalendarEventList()})),console.debug("loadCalendar data done")},t.prototype.loadCalendarEventDetail=function(t){var e=this;console.log("loadCalendarEventDetail:",t),this.calendarService.getCalendarEventDetail(t).subscribe(function(t){console.warn("getCalendarEventDetail",t),e.isLoading=!1,e.calendarEventDetail=t,e.customerClientName=e.customerClientMap.get(e.calendarEventDetail.customerClientID),console.log("customerClientMap:",e.customerClientMap),e.calendarEventDetail.displayActivity=e.profileCodeService.convertCode2Text("Calendar_Type",e.calendarEventDetail.activity),e.calendarEventDetail.displayAlert1=e.profileCodeService.convertCode2Text("Calendar_RemindTime",e.calendarEventDetail.alert1),e.calendarEventDetail.displayAlert2=e.profileCodeService.convertCode2Text("Calendar_RemindTime",e.calendarEventDetail.alert2),e.onToggleDetailModal(!0)})},t.prototype.loadViewDateCalendarEventList=function(){var e=this,t=new Date(m.getYear(this.viewDate),m.getMonth(this.viewDate),m.getDate(this.viewDate),0,0,0);this.calendarService.getCalendarEventList(t,m.subMinutes(m.addDays(this.viewDate,1),1),"").subscribe(function(t){console.warn("loadViewDateCalendarEventList",t),e.viewDateCalendarEventList=t})},t.prototype.onClickDetail=function(t){this.clientID=t.clientID,this.loadCalendarEventDetail(this.clientID),this.loadViewDateCalendarEventList(),console.warn("clickDetail",this.clientID)},t.prototype.onClickDeleteCancel=function(){},t.prototype.onClickDeleteConfirm=function(){var t=this;this.modalManager.toggleLoading(!0),this.calendarService.deleteCalendarEvent(this.clientID).subscribe(function(e){return b(t,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return console.warn("this.calendarService.deleteCalendarEvent data: ",e),[4,this.dataSyncService.syncFunc(["CALENDAR"])];case 1:return t.sent(),e.status&&(this.isDelete=e.status),this.loadCalendarData(),this.isExpandDetail&&this.onToggleDetailModal(!1),this.modalManager.toggleLoading(!1),[2]}})})})},t.prototype.onClickAppointmentSave=function(){this.isSaveClick=!0},t.prototype.onSaveCalendarEvent=function(a){return b(this,void 0,void 0,function(){var e,n,i,o=this;return C(this,function(t){switch(t.label){case 0:return e=a.type,console.log("onSaveCalendarEvent:",a),"fail"===e?[3,2]:(n=a.data,i=n.ClientID,console.warn("saveCalendarEvent"),console.warn("updateCalendarEvent",i),this.modalManager.toggleLoading(!0),[4,this.dataSyncService.syncFunc(["CALENDAR"])]);case 1:t.sent(),this.modalManager.toggleLoading(!1),this.calendarService.getCalendarEventDetail(i).subscribe(function(t){o.calendarEventDetail=t,o.onToggleAppointmentModal(!1),o.loadCalendarData(),"edit"===e?(o.loadCalendarEventDetail(i),o.isSave=!0,o.loadViewDateCalendarEventList()):"add"===e&&(o.isSave=!0,console.warn("addCalendarEvent"))}),t.label=2;case 2:return this.isSaveClick=!1,[2]}})})},t.prototype.isPad=function(){return 1024<=this.windowWidth},t.prototype.editEvent=function(){console.log("calendar EditEvent:",this.calendarEventDetail),this.calendarEventEdit=new U(this.calendarEventDetail.clientID,this.calendarEventDetail.calendarID,this.calendarEventDetail.customerClientID,this.calendarEventDetail.title,this.calendarEventDetail.location,this.calendarEventDetail.activity,"",this.calendarEventDetail.start,this.calendarEventDetail.end,"",this.calendarEventDetail.alert1,this.calendarEventDetail.alert2,this.calendarEventDetail.alert3,this.calendarEventDetail.remark,null),this.calendarEventEdit.allDay=this.calendarEventDetail.allDay,this.calendarEventEdit.isAlert=this.calendarEventDetail.isAlert,this.onToggleAppointmentModal(!0)},t.prototype.addEvent=function(){var t;this.clientID="",t=new Date(m.getYear(this.viewDate),m.getMonth(this.viewDate),m.getDate(this.viewDate),m.getHours(new Date),m.getMinutes(new Date)),t=m.addMinutes(t,5-m.getMinutes(t)%5),t=m.addHours(t,1),this.calendarEventEdit=new U("","",null,"","",null,"N",t,m.addMinutes(t,15),"Y","8","","","",null),this.loadViewDateCalendarEventList(),this.onToggleAppointmentModal(!0)},t.prototype.onActivityTypeListChange=function(t){var e=this;this.alertTypeList=t,this.currentFilterOptionList=[];var n={};this.activityTypeList.forEach(function(t){console.debug("activityType codeItem",t),n!=undefined&&(n[t.getCode()]=t.isCheck),t.isCheck&&e.currentFilterOptionList.push(t.getCode())}),this.filterOptionChange(this.currentFilterOptionList),this.settingValueChange(n)},t.prototype.settingValueChange=function(t){var e=new j.Setting(this.settingService.getSetting("CalendarFilterSetting").SettingID,this.settingService.getSetting("CalendarFilterSetting").SettingName,JSON.stringify(t));this.settingService.updateSetting(e).subscribe(function(t){console.debug("calendar.component-update setting",t)})},t.prototype.filterOptionChange=function(t){console.warn("currentFilterOption",t),this.currentFilterOptionList=t,this.refreshCalendarEventList()},t.prototype.setCurrentFilterOption=function(e){var n=this;this.currentFilterOptionList=[],this.activityTypeList.forEach(function(t){console.debug("activityType codeItem",t),e!=undefined&&(e[t.getCode()]=t.isCheck),t.isCheck&&n.currentFilterOptionList.push(t.getCode())})},t.prototype.refreshCalendarEventList=function(){var e=this;this.calendarEventListAfterFilter=[],console.debug("start refreshCalendarEventList",this.calendarEventList.length),this.calendarEventListAfterFilter=this.calendarEventList.filter(function(t){return-1<e.currentFilterOptionList.indexOf(t.activity)}),console.debug("start refreshCalendarEventList done",this.calendarEventListAfterFilter),console.debug("start refreshCalendarEventList done",this.calendarEventListAfterFilter.length),this.viewType!=this.DAY&&this.viewType!=this.WEEK||this.scrollToCurrentTime()},t.prototype.scrollToCurrentTime=function(){var p=this,d=this;setTimeout(function(){var t,e,n=d.elementRef.nativeElement.querySelectorAll("div.cal-time-events");try{for(var i=B(n),o=i.next();!o.done;o=i.next()){var a=o.value,r=d.elementRef.nativeElement.querySelector("div.cal-day-headers"),s=d.elementRef.nativeElement.querySelector("div.cal-all-day-events"),l=null!=s?s.getBoundingClientRect().height:0;if(null!=r){a.style.maxHeight=d.calendarHeight-r.getBoundingClientRect().height-l-parseInt(window.getComputedStyle(r).marginBottom)+"px";var c=m.getHours(new Date);console.log("current Hour:",m.getHours(new Date)),3<c&&(a.scrollTop=80*Math.floor((c-3)/2)+82*(Math.floor((c-3)/2)+(c-3)%2))}}}catch(u){t={error:u}}finally{try{o&&!o.done&&(e=i["return"])&&e.call(i)}finally{if(t)throw t.error}}p.changeDetector.markForCheck()},100)},t.prototype.calcuContentHeight=function(){var i=this;console.debug("calcuContentHeight");var o=this;setTimeout(function(){console.warn("calcuContentHeight",i.calendarHeight);var t=o.elementRef.nativeElement.querySelector(".ui-calendar-year"),e=o.elementRef.nativeElement.querySelector("app-ui-calendar-year");null!=t&&null!=e&&(1023<o.windowWidth?(e.style.minHeight=o.calendarHeight-parseInt(window.getComputedStyle(t).marginTop)+"px",e.style.height=o.calendarHeight-parseInt(window.getComputedStyle(t).marginTop)+"px"):(t.style.height=o.calendarHeight-parseInt(window.getComputedStyle(t).marginTop)+"px",console.log("mobile year view: _this.calendarHeight:",o.calendarHeight,"window.getComputedStyle(year_ele).marginTop",window.getComputedStyle(t).marginTop)));var n=o.elementRef.nativeElement.querySelector(".cal-month-view");null!==n&&n!==undefined&&1023<o.windowWidth&&(n.style.maxHeight=o.calendarHeight+"px",n.style.minHeight=o.calendarHeight+"px"),"0px"==n.style.maxHeight&&(console.warn("Here"),n.style.maxHeight="97vh",n.style.minHeight="97vh"),i.changeDetector.markForCheck()},300)},t.prototype.renderWeek=function(){console.log("in integration renderWeek");var t=this.elementRef.nativeElement.querySelector("div.cal-day-headers"),e=this.elementRef.nativeElement.querySelector("div.cal-all-day-events");console.log("in integration renderWeek",t,e),this.scrollToCurrentTime()},t.prototype.onToggleAppointmentModal=function(t){var e=this;setTimeout(function(){e.isExpandEdit=t,e.isExpandEdit||(e.isCalendarEditMetaDataDone=!1),e.isExpandFilter&&e.onCloseInfo(),e.changeDetector.markForCheck()},0)},t.prototype.onToggleDetailModal=function(t){this.isExpandDetail=t,this.isExpandDetail||(this.isCalendarDetailMetaDataDone=!1),this.isExpandFilter&&this.onCloseInfo()},t.prototype.onToggleFilterModal=function(t){this.isExpandFilter||this.onCloseInfo()},t.prototype.onInfoTabClick=function(t){console.warn("infoTabClick"),console.warn("nowShowBtn",this.nowShowBtn),this.nowShowBtn!==undefined?t!==undefined&&(console.warn("messageContent",t.messageContent,this.nowShowBtn.messageContent),t.messageContent!==this.nowShowBtn.messageContent?(this.nowShowBtn.closeInfo(),this.nowShowBtn=t):this.resetInfoPos()):this.nowShowBtn=t,this.nowShowBtn.messageContent===this.filterInfo&&(this.isExpandFilter=!0)},t.prototype.resetInfoPos=function(){this.nowShowBtn!==undefined&&this.nowShowBtn.countPos()},t.prototype.onCloseInfo=function(){this.isExpandFilter=!1,this.nowShowBtn!==undefined&&this.nowShowBtn.closeInfo()},t.prototype.createCustomerList=function(){var l=this,t=new j.PageInfo;t.pageSize=-1;var e=new W;this.customerService.getCustomerList(e,t).subscribe(function(t){var e,n;console.log("data",t);var i=[];try{for(var o=B(t),a=o.next();!a.done;a=o.next()){var r=a.value;l.customerClientMap.set(r.clientID,l.customerUtils.convertNameToShow(r.firstName,r.lastName)),i.push(new j.SelectOption(r.clientID,l.customerUtils.convertNameToShow(r.firstName,r.lastName)))}}catch(s){e={error:s}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(e)throw e.error}}l.customerItemList=i})},t.prototype.mobileFilterClick=function(){this.isExpandFilter=!0},t.prototype.onMetaDataDone=function(t){"CalendarEdit"===t?this.isCalendarEditMetaDataDone=!0:"CalendarDetail"===t&&(this.isCalendarDetailMetaDataDone=!0)},t.decorators=[{type:h.Component,args:[{selector:"snd-calendar",template:'<app-ui-main-full>\n  <div main #calendarMain class="main-calendar">\n\n    <div #titleBtnsBlock class="calendar-title-actionBtns">\n\n      <div class="calendar-title-block">\n        <ng-template *ngIf="windowWidth < 1024; then title_mobileBlock else title_pcBlock"></ng-template>\n\n        <ng-template #title_pcBlock>\n          <p class="calendar-title-year font-size_h5">{{ this.viewDate | date: \'yyyy\' }}\n            {{language.yearUnit | translate}}</p>\n          <p class="calendar-title-month font-size_h5" [hidden]="this.viewType === \'year\'">\n            {{ this.translateMap.get(this.viewDate | date: \'MMMM\') ? this.translateMap.get(this.viewDate | date: \'MMMM\') :  this.viewDate | date: \'MMMM\'}}\n          </p>\n        </ng-template>\n        \x3c!-- end: title_pcBlock --\x3e\n\n        <ng-template #title_mobileBlock>\n          <div (click)="mobileBackViewType()">\n            \x3c!-- <nx-icon name="chevron-left" [hidden]="(this.viewType === \'year\')"></nx-icon> --\x3e\n            <div class="img-block" [hidden]="(this.viewType === \'year\')">\n              <img src="assets/img/icon-cal-back.svg" />\n            </div>\n            <p class="calendar-title-year" [hidden]="this.viewType === \'day\'">{{ this.viewDate | date: \'yyyy\' }}\n              {{language.yearUnit | translate}}</p>\n            <p class="calendar-title-month" [hidden]="(this.viewType === \'month\' || this.viewType === \'year\')">\n              {{ this.translateMap.get(this.viewDate | date: \'MMMM\') ? this.translateMap.get(this.viewDate | date: \'MMMM\') :  this.viewDate | date: \'MMMM\'}}\n            </p>\n          </div>\n        </ng-template>\n        \x3c!-- end: title_mobileBlock --\x3e\n\n      </div>\n      \x3c!-- end calendar-title-block --\x3e\n\n      <div class="calendar-switch-btn">\n        <app-ui-tab-style2 Action [action]="\'calendarViewTab\'" (onTabChildClick)="switchPadViewMode($event)" [tabIndex]="this.viewTypeIndex">\n          <app-ui-tab-child>{{language.calendarDay |translate }}</app-ui-tab-child>\n          <app-ui-tab-child>{{language.calendarWeek |translate }}</app-ui-tab-child>\n          <app-ui-tab-child>{{language.calendarMonth |translate }}</app-ui-tab-child>\n          <app-ui-tab-child>{{language.calendarYear |translate }}</app-ui-tab-child>\n        </app-ui-tab-style2>\n        \x3c!-- end tab style2 --\x3e\n      </div>\n      \x3c!-- end calendar-switch-btn --\x3e\n\n      <div class="calendar-action-btn">\n        <ul class="ui-list-block">\n          <li class="list-item-block">\n            <div class="calendar-btn" id=\'btn_calendarToday\' Action action=\'calendarToday\' (actionClick)="clickToday()">\n              <div class="text-block">\n                <p>{{language.calendarToday |translate }}</p>\n              </div>\n            </div>\n          </li>\n          <li class="list-item-block">\n            <div class="calendar-btn" id=\'btn_calendarAddEvent\' Action action="calendarAddEvent"\n              (actionClick)="addEvent()">\n              <div class="img-block">\n                <img [src]="\'assets/img/icon-cal-new.svg\'" />\n              </div>\n            </div>\n          </li>\n          <li class="list-item-block calendar-filter-btn">\n            \x3c!-- info new --\x3e\n            <div class="show-pad-and-mobile calendar-btn" id=\'btn_calendarFilter\' Action action=\'calendarFilter\'\n              (actionClick)="mobileFilterClick()">\n              <div class="img-block">\n                <img [src]="\'assets/img/icon-cal-filter.svg\'" />\n              </div>\n            </div>\n            <snd-ui-information class="show-pc filter-pc filter-info-block" [isPopupStyle]="false" [isHasArrow]="false"\n              [infoBtnType]="\'customize\'" [containerSelector]="calendarMain" [isInfoContentOverlap]="true"\n              [maxWidth]="595">\n              <ng-container btn>\n                <div class="calendar-btn">\n                  <div class="img-block">\n                    <img [src]="\'assets/img/icon-cal-filter.svg\'" />\n                  </div>\n                </div>\n              </ng-container>\n              <ng-container info-content>\n                <div class="filter-block-pc">\n                  <ng-container *ngTemplateOutlet="filterContent"></ng-container>\n                </div>\n              </ng-container>\n            </snd-ui-information>\n            \x3c!-- end of info new --\x3e\n          </li>\n        </ul>\n      </div>\n      \x3c!-- end calendar-action-btn --\x3e\n    </div>\n    \x3c!-- end calendar-title-actionBtns --\x3e\n    \x3c!-- </app-ui-infinite-scroll> --\x3e\n\n    \x3c!-- Filter content --\x3e\n    <ng-template #filterContent>\n\n      <snd-calendar-filter [optionMap]="optionMap" (activityTypeListChange)="onActivityTypeListChange($event)">\n      </snd-calendar-filter>\n    </ng-template>\n\n    \x3c!--info content--\x3e\n    <app-ui-information-content #filterInfo class="filter-pc" (btnOnClick)="onCloseInfo()" [defaultPos]="\'bottom\'"\n      [paddindData]="paddindData" [showArrow]="false">\n      \x3c!-- <div class="filter-block-pc"> --\x3e\n      <ng-container *ngTemplateOutlet="filterContent"></ng-container>\n      \x3c!-- </div> --\x3e\n    </app-ui-information-content>\n    \x3c!-- end: Filter content --\x3e\n\n    \x3c!--\n      [(isSwitchView)]="isLoading"\n    --\x3e\n    <utils-calendar class="calendar-container" [ngClass]="(isExpandDetail || isExpandEdit ? \'style-popup-open\':\'\')"\n      [viewType]="viewType" [weekStartsOn]="weekStartsOn" [viewDate]="viewDate" [translateMap]="translateMap"\n      [eventList]="calendarEventListAfterFilter" (viewDateChange)="onViewDateChange($event)"\n      (uiCalendarClickEventItem)="onClickDetail($event)" (uiCalendarMoreInfoClicked)="onInfoTabClick($event)"\n      (onRenderWeek)="renderWeek()">\n    </utils-calendar>\n  </div>\n  \x3c!-- end: main --\x3e\n\n  <div global-main>\n    \x3c!--delete block --\x3e\n    <app-ui-modal-confirm #calendarDelete [(isPopupOpen)]="isCalendarDelete" (onCancel)="onClickDeleteCancel()"\n      (onConfirm)="onClickDeleteConfirm()" [title]="language.delete | translate"\n      [message]="language.deleteDataBody | translate" [cancelBtnText]="language.no | translate"\n      [confirmBtnText]="language.yes | translate">\n    </app-ui-modal-confirm>\n    \x3c!-- end: Appointment delete --\x3e\n\n    \x3c!-- detail block --\x3e\n    <app-ui-modal-style-text1 class="wd-md" [(isPopupOpen)]="isExpandDetail" (close)="onToggleDetailModal($event)"\n      [hidden]="!isCalendarDetailMetaDataDone" [ngClass]="{\'no-scroll\': isExpandEdit}" [isModalBtmHasSpace]="false">\n      <ng-container textType="modal-title-detail">{{language.calendarAppointmentDetails | translate}}</ng-container>\n      <ng-container textType="modal-content-detail">\n        <snd-calendar-detail *ngIf="isExpandDetail" (isMetaDataDone)="onMetaDataDone(\'CalendarDetail\')" [calendarEventDetail]="calendarEventDetail"\n          [customerClientName]="customerClientName">\n        </snd-calendar-detail>\n      </ng-container>\n      \x3c!-- end: popup-content --\x3e\n      <ng-container textType="modal-btm-detail">\n        <app-ui-btn-layout>\n          <app-ui-btn [btnHeight]="\'sm\'" [btnStyle]="\'border\'" [id]="\'btn_calendarDelete\'" Action\n            action=\'calendarDelete\' (actionClick)="isCalendarDelete = true">\n            <ng-container TextType="cust">{{language.calendarDelete | translate}}</ng-container>\n          </app-ui-btn>\n          <app-ui-btn [btnHeight]="\'sm\'" [id]="\'btn_calendarEdit\'" Action action=\'calendarEdit\'\n            (actionClick)="editEvent()">\n            \x3c!-- <ng-container TextType="cust"><span [routerLink]="[\'editEvent\']">EDIT</span></ng-container> --\x3e\n            <ng-container TextType="cust">{{language.calendarEdit | translate}}</ng-container>\n          </app-ui-btn>\n        </app-ui-btn-layout>\n      </ng-container>\n      \x3c!-- end: modal-btm-detail --\x3e\n    </app-ui-modal-style-text1>\n    \x3c!-- end: Appointment Detail --\x3e\n\n    \x3c!--add/edit calendar popup--\x3e\n    <app-ui-modal-style-text1 class="wd-lg calendar-edit-content" *ngIf="isExpandEdit" [(isPopupOpen)]="isExpandEdit"\n      [isScrollToTop]="true" (close)="onToggleAppointmentModal(false)" [isBackdropClose]="true"\n      [hidden]="!isCalendarEditMetaDataDone">\n      <ng-container textType="modal-title-detail">{{language.calendarAppointment | translate}}</ng-container>\n      <ng-container textType="modal-content-detail">\n        <snd-calendar-edit *ngIf="isExpandEdit" (isMetaDataDone)="onMetaDataDone(\'CalendarEdit\')"\n          [clientID]="calendarEventEdit?calendarEventEdit.clientID :\'\' "\n          [todayCalendarEvent]="viewDateCalendarEventList" [(isSaveClick)]="isSaveClick" [viewDate]="viewDate"\n          [translateMap]="translateMap" [customerItemList]="customerItemList" (saveEvent)="onSaveCalendarEvent($event)">\n        </snd-calendar-edit>\n      </ng-container>\n      \x3c!-- end popup-content --\x3e\n      <ng-container textType="modal-btm-detail">\n        <app-ui-btn-layout>\n          <app-ui-btn [btnWd]="\'md\'" [btnHeight]="\'sm\'" [id]="\'btn_calendarSave\'" Action action=\'calendarSave\'\n            (actionClick)="onClickAppointmentSave()">\n            <ng-container TextType="cust">{{language.calendarSave | translate}}</ng-container>\n          </app-ui-btn>\n        </app-ui-btn-layout>\n      </ng-container>\n      \x3c!-- end modal-btm-detail --\x3e\n    </app-ui-modal-style-text1>\n    \x3c!-- end: add/edit calendar --\x3e\n\n    <app-ui-modal-style-feedback [(isPopupOpen)]="isSave">\n      <ng-container textType="modal-img-detail">\n        <nx-icon name=\'check\' size=\'auto\'></nx-icon>\n      </ng-container>\n      <ng-container textType="modal-content-detail">{{language.notificationSaveFeedback | translate}}</ng-container>\n    </app-ui-modal-style-feedback>\n    \x3c!-- end: Appointment save --\x3e\n\n    \x3c!-- Delete Success --\x3e\n    <app-ui-modal-style-feedback [(isPopupOpen)]="isDelete">\n      <ng-container textType="modal-img-detail">\n        <nx-icon name=\'check\' size=\'auto\'></nx-icon>\n      </ng-container>\n      <ng-container textType="modal-content-detail">{{language.notificationDeleteFeedback | translate}}</ng-container>\n    </app-ui-modal-style-feedback>\n    \x3c!-- end of Delete Success --\x3e\n\n    <app-ui-modal-style-feedback [(isPopupOpen)]="isLoading" [hasAutoDisappear]="false">\n      <ng-container textType="modal-img-detail">\n        <app-ui-refresh-icon></app-ui-refresh-icon>\n      </ng-container>\n      <ng-container textType="modal-content-detail">{{language.loading | translate}}</ng-container>\n    </app-ui-modal-style-feedback>\n\n    \x3c!-- filter block --\x3e\n    <app-ui-modal-style-text1 class="wd-sm" [(isPopupOpen)]="isExpandFilter" [isHasBtmBlock]="false"\n      (close)="onToggleFilterModal($event)" class="filter-mobile">\n      <ng-container textType="modal-title-detail">{{language.calendarFilter |translate }}</ng-container>\n      <ng-container textType="modal-content-detail">\n        <ng-container *ngTemplateOutlet="filterContent"></ng-container>\n      </ng-container>\n      \x3c!-- end: popup-content --\x3e\n    </app-ui-modal-style-text1>\n    \x3c!-- end: Filter --\x3e\n  </div>\n  \x3c!-- end: global-main --\x3e\n</app-ui-main-full>',changeDetection:h.ChangeDetectionStrategy.OnPush,styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}:host{background-color:transparent}:host *{-webkit-tap-highlight-color:transparent}:host ::ng-deep .ui-page-content .ui-main-full-content{padding:0!important}:host .link-btn{cursor:pointer}:host .main-calendar{display:inline-block;width:100%;height:100%}:host .calendar-title-actionBtns{display:flex;justify-content:space-between;align-items:center;padding:25px 30px 0}:host .calendar-title-actionBtns:not(:last-child){margin-bottom:35px}:host .calendar-title-block{min-width:195px}:host .calendar-title-block .link-btn{display:flex}:host .calendar-title-block p{display:inline-block;margin:0;font-weight:700;line-height:1.33;letter-spacing:.2px;color:#414141}:host .calendar-title-block p:not(:last-child){margin-right:20px}:host .calendar-title-block p[hidden]{display:none}:host .calendar-switch-btn{max-width:280px;margin-right:40px}:host .calendar-action-btn .ui-list-block{display:flex;justify-content:flex-start;align-items:stretch;list-style-type:none}:host .calendar-action-btn .ui-list-block .list-item-block:not(:last-child){margin-right:20px}:host .calendar-action-btn .ui-list-block .calendar-btn{display:flex;min-width:40px;height:100%;cursor:pointer}:host .calendar-action-btn .ui-list-block .calendar-btn .text-block{padding-top:2px}:host .calendar-action-btn .ui-list-block .calendar-btn .img-block,:host .calendar-action-btn .ui-list-block .calendar-btn .text-block{flex:1;margin:auto 0}:host .calendar-action-btn .ui-list-block .img-block{display:inline-block;width:40px;height:40px}:host .calendar-action-btn .ui-list-block .img-block img{display:inline-block;width:100%}:host .calendar-action-btn .ui-list-block .text-block{display:flex}:host .calendar-action-btn .ui-list-block .text-block>p{margin:auto 0;flex:1;font-size:.875rem;font-weight:700;line-height:1.43;letter-spacing:.2px;color:#007ab3}:host .calendar-action-btn .ui-list-block .calendar-filter-btn ::ng-deep .info-content-block{margin-top:20px}:host .calendar-action-btn .ui-list-block .calendar-filter-btn ::ng-deep .info-content .info-info-content{padding:20px}:host .calendar-action-btn .ui-list-block .calendar-filter-btn ::ng-deep .info-content .control-btn:after{display:none}:host .filter-block-pc{display:inline-block;min-width:310px}:host .filter-info-block ::ng-deep .info-content-block{margin-right:-28px}:host ::ng-deep .calendar-container.style-popup-open .cal-month-view,:host ::ng-deep .calendar-container.style-popup-open .cal-time-events{overflow-y:hidden!important}:host ::ng-deep .calendar-container.style-popup-open .ui-calendar-year .app-ui-calendar-year{overflow-y:hidden!important}:host ::ng-deep .cal-month-view{background-color:#f5f5f5}:host .filter-pc ::ng-deep .info-info-content{padding:25px 20px;border-radius:5px}:host .filter-mobile::ng-deep{display:none}:host .calendar-filter-item:not(:last-child){margin-bottom:25px}:host .calendar-filter-item ::ng-deep .nx-checkbox .nx-checkbox__control{margin-top:0}:host .calendar-filter-item ::ng-deep .form-checkbox .check-text{line-height:1.4;letter-spacing:.2px}:host .no-scroll *,:host .no-scroll ::ng-deep *{overflow-y:hidden!important}:host .calendar-detail-content ::ng-deep .gas-layout-form .gas-row-block:first-child{margin-top:0}:host .calendar-detail-content ::ng-deep app-ui-info-text2 .info-unit-block .title-block{margin-bottom:0}:host .calendar-detail-content ::ng-deep app-ui-info-text2 .info-unit-block .text-block>p{color:#414141;font-weight:300}:host .calendar-edit-content ::ng-deep .modal-block{padding-left:0;padding-right:0}:host .calendar-edit-content ::ng-deep .modal-block .nx-modal__container .nx-modal__content{padding-right:0}:host .calendar-edit-content ::ng-deep .modal-block app-calendar-edit>[class*=gas-col-]:last-child{padding-right:0;padding-left:20px}:host .calendar-edit-content ::ng-deep .modal-block .modal-content-block.style-fixed{margin-bottom:40px}@media screen and (max-width:1023px){:host ::ng-deep .ui-page-content{background-color:#fff!important}:host ::ng-deep .ui-page-content .ui-main-full-content{min-height:auto!important;background-color:transparent!important;height:100%}:host ::ng-deep .ui-calendar-year{overflow:hidden;overflow-y:auto;margin-top:-5px}:host ::ng-deep .ui-calendar-month-m .cal-days .cal-day-cell:not(.cal-today) .event-date.event-day-active{background-color:transparent!important;color:#414141!important}:host ::ng-deep .ui-calendar-month-m .cal-days .cal-today .event-date{background-color:#003781!important;color:#fff!important}:host .calendar-title-block{position:relative;padding-left:10px}:host .calendar-title-block nx-icon::ng-deep{font-size:1.25rem;font-weight:700;color:#003781}:host .calendar-title-block nx-icon[hidden]::ng-deep{display:none}:host .calendar-title-block .img-block{display:inline-block;vertical-align:middle;width:16px}:host .calendar-title-block .img-block[hidden]{display:none}:host .calendar-title-block .img-block img{display:inline-block;width:6px;height:10px;position:absolute;top:calc(50% - 5px)}:host .calendar-title-block p{font-size:1.25rem}:host .calendar-title-block p:not(:last-child){margin-right:10px}:host .calendar-title-actionBtns{padding:5px 5px 0}:host .calendar-title-actionBtns:not(:last-child){margin-bottom:15px}:host .calendar-switch-btn{display:none}:host .calendar-action-btn .ui-list-block .list-item-block:not(:last-child){margin-right:10px}:host .filter-mobile::ng-deep{display:block}:host .filter-pc::ng-deep .info-info-content{display:none}:host .calendar-filter-item:not(:last-child){margin-bottom:35px}}@media screen and (max-width:374px){:host .calendar-title-block{min-width:auto}}"]}]}],t.ctorParameters=function(){return[{type:h.ChangeDetectorRef},{type:h.ElementRef},{type:j.SettingService},{type:j.TranslateService},{type:q},{type:j.ProfileCodeService},{type:K},{type:Z},{type:a.ModalManager},{type:j.DataSyncService}]},t.propDecorators={parentHeight:[{type:h.Input}],parentHeightChange:[{type:h.Output}],titleBtnsBlock:[{type:h.ViewChild,args:["titleBtnsBlock"]}],onResize:[{type:h.HostListener,args:["window:resize",["$event"]]}],nowShowBtn:[{type:h.ViewChild,args:[a.UiInformationBtnComponent]}],infoContent:[{type:h.ViewChild,args:[a.UiInformationContentComponent]}],filterInfo:[{type:h.ViewChild,args:["filterInfo"]}]},t}(),tt=function(){function t(t,e,n){this.dateUtils=t,this.showRule=n,this.language=new j.Language,this.onAddNote=new h.EventEmitter,this.onDisplayNote=new h.EventEmitter,this.onEditNote=new h.EventEmitter,this.onDeleteNote=new h.EventEmitter,this.contactListRefresh=new h.EventEmitter,this.elementRef=e}return Object.defineProperty(t.prototype,"contactList",{get:function(){return this._contactList},set:function(t){var e=this;console.log("customer-contact-list set contactList:",t),this._contactList=t.map(function(t){return Object.assign({},t,{NoteTimeDisplay:e.toNoteTime(new Date(t.NoteTime))})}),setTimeout(function(){e.closeSlidingItems()},200)},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){t.closeSlidingItems()},200)},t.prototype.closeSlidingItems=function(){return b(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return console.debug("closeSlidingItems"),null==(e=this.elementRef.nativeElement.querySelector("ion-item-sliding"))?[3,3]:(console.debug("item",e),[4,e.close()]);case 1:return t.sent(),[4,e.closeOpened()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.refreshContactNote=function(){var t=this;this.contactListRefresh.emit(),setTimeout(function(){t.closeSlidingItems()},200)},t.prototype.addNote=function(){this.onAddNote.emit()},t.prototype.displayNote=function(t){this.onDisplayNote.emit(Object.assign({Date:this.toNoteTime(new Date(t.NoteTime))},t))},t.prototype.editNote=function(t){this.onEditNote.emit(t)},t.prototype.deleteNote=function(t){this.onDeleteNote.emit(t)},t.prototype.trackByClientID=function(t,e){return e.ClientID},t.prototype.toNoteTime=function(t){console.log("toNoteTime:",t);var e=this.dateUtils.toDateString(t,"yyyy-MM-dd HH:mm");return this.showRule?this.showRule.convertDate(t)+e.slice(10):e},t.decorators=[{type:h.Component,args:[{selector:"app-customer-contact-list",template:'<ng-container *ngIf="contactList">\n    <div #slidingListBlock class="contact-list-block layout-detail-block style-has-right-space style-has-btm-space">\n        \x3c!-- Contact Note --\x3e\n        <app-ui-title-style1 [isShowOther]="true">\n            <ng-container textType="titleText">\n                {{language.contactNote |translate }}\n            </ng-container>\n            <ng-container textType="otherEle">\n                <app-ui-link [isUnderLine]="false" imgSrc="./assets/img/icon-add-blue-text.svg" [id]="\'customerAddNote\'" Action action="customerAddNote" (actionClick)="addNote()">\n                    <ng-container textType="linktext">{{language.customerAdd |translate }}</ng-container>\n                </app-ui-link>\n            </ng-container>\n        </app-ui-title-style1>\n        \x3c!-- end of Contact Note  --\x3e\n        \x3c!--contact note empty --\x3e\n        <ng-container *ngIf="contactList && contactList.length != 0 ; else noContactData">\n            <app-ui-item-sliding class="contact-list-item-block">\n                    <app-ui-item *ngFor="let customerContactNote of contactList;trackBy:trackByClientID;" (onItemClick)="displayNote(customerContactNote)">\n                    \n                    <div ui-item-content class="item" >\n                        <p class="title">{{customerContactNote.NoteTimeDisplay}}</p>\n                        <p class="desc">{{ customerContactNote.Note}}</p>\n                    </div>\n                \n                    \x3c!-- swipe right and show the btn --\x3e\n                    <app-ui-item-options side="end" class="option-block-end">\n                        <app-ui-item-option class="btn-option option-color-normal"  (onItemOptionClick)="editNote(customerContactNote)">\n                            <img src="assets/img/icon-list-pen-full.svg" alt="edit">\n                        </app-ui-item-option>\n                        <app-ui-item-option class="btn-option option-color-focus"  (onItemOptionClick)="deleteNote(customerContactNote)">\n                            <img src="assets/img/icon-trash-full.svg" alt="delete">\n                        </app-ui-item-option>\n                    </app-ui-item-options>\n                    </app-ui-item>\n            </app-ui-item-sliding>\n        </ng-container>\n        <ng-template #noContactData>\n            <div class="empty-whole-block">\n                <div class="status-empty contact-note-empty empty-block" Action action="customerAddNote" (actionClick)="addNote()">\n                    <div class="empty-show-block">\n                        <div class="empty-img">\n                        <img src="assets/img/empty-img-customer-note.svg">\n                        </div>\n                        <div class="text">\n                                {{language.noRecord |translate }}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </ng-template>\n        \x3c!-- end of contact note empty --\x3e\n    </div>\n</ng-container>\n\n\n',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.space-detail{padding-right:40px;display:block}@media (max-width:1023px){.space-detail{padding-right:40px}}.layout-detail-block{background-color:#f5f5f5;padding-left:40px}.layout-detail-block .space-detail:not(.layout-nodata):last-child{padding-bottom:100px}.layout-detail-block .layout-nodata{padding-bottom:0}@media (min-width:768px){.layout-detail-block.style-has-right-space{padding-right:40px}.layout-detail-block.style-has-right-space.skelton-layout{padding-right:0}}.layout-detail-block.style-has-top-space{padding-top:40px}@media (max-width:767px){.space-detail{padding-right:5px}.layout-detail-block{padding-left:5px}.layout-detail-block.style-has-right-space{padding-right:5px}.layout-detail-block.style-has-top-space{padding-top:30px}}.layout-detail-block.style-has-btm-space{padding-bottom:100px}.space-inner-lg{padding-left:50px;padding-right:50px}@media (max-width:767px){.space-inner-lg{padding-left:5px;padding-right:5px}}.empty-whole-block{padding-left:2px}.contact-note-empty{background-color:#fff;display:flex;align-items:center;justify-content:center;box-sizing:border-box;padding:30px;border-radius:5px;box-shadow:0 2px 4px 0 rgba(0,0,0,.19);overflow:visible}.contact-note-empty .empty-show-block{background-color:#fff;display:flex;align-items:center;justify-content:center;box-sizing:border-box;padding:30px;border-radius:5px}.contact-note-empty .empty-show-block .empty-img{display:inline-block;max-width:75px}.contact-note-empty .empty-show-block .empty-img img{max-width:100%}.contact-note-empty .empty-show-block .text{margin-left:50px;max-width:196px;width:100%;color:#414141;font-size:1.125rem;line-height:28px;font-weight:300;word-break:break-word;-webkit-hyphens:manual;-ms-hyphens:manual;hyphens:manual}@media (max-width:1023px){.contact-note-empty{padding:0}}@media (max-width:374px){.contact-note-empty .empty-show-block{padding:30px 10px}.contact-note-empty .empty-show-block .text{margin-left:22px}}@media (min-width:767px){.contact-list-block{padding-right:40px}}.contact-list-item-block{background-color:#f5f5f5}.contact-list-item-block .ui-item{padding:20px}.contact-list-item-block .item .title{font-size:.875rem;font-weight:700;color:#414141;position:relative;line-height:28px;margin-bottom:1px}.contact-list-item-block .item .title:before{content:'';display:inline-block;width:15px;height:1px;background-color:#007ab3;position:absolute}.contact-list-item-block .item .desc{/*! autoprefixer: off */-webkit-box-orient:vertical;font-size:1.125rem;color:#414141;font-weight:300;line-height:28px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2}.contact-list-item-block .option-color-normal{background-color:#ececec}.contact-list-item-block .option-color-normal ::ng-deep ion-item-option{background-color:#ececec}.contact-list-item-block .option-color-focus{background-color:#dc3149}.contact-list-item-block .option-color-focus ::ng-deep ion-item-option{background-color:#dc3149}.contact-list-item-block .btn-option ::ng-deep ion-item-option{padding:0 27px}.contact-list-item-block .option-block-end .btn-option{color:#fff;text-align:center}.contact-list-item-block .option-block-end .btn-option img{margin:0 auto;max-width:24px;width:100%}@media (min-width:1025px){.contact-list-item-block .option-block-end .btn-option img{max-width:2.4vw}}.contact-list-item-block ::ng-deep .list-block{background-color:#f5f5f5}.contact-list-item-block ::ng-deep .list-block app-ui-item:last-of-type .item-native{border-radius:0 0 5px 5px}.contact-list-item-block ::ng-deep ion-item .ui-item{margin:0;padding:21px 30px 21px 2px}.contact-list-item-block ::ng-deep ion-list{margin:0;padding-left:1px}.contact-list-item-block ::ng-deep .item-native{padding-left:0;border-radius:5px}.contact-list-item-block ::ng-deep .item-inner{padding-right:0}@media (max-width:767px){.contact-list-item-block .item .desc{-webkit-line-clamp:3}.contact-list-item-block ::ng-deep ion-item .ui-item{padding:21px 15px 21px 2px}}"]}]}],t.ctorParameters=function(){return[{type:j.DateUtils},{type:h.ElementRef,decorators:[{type:h.Inject,args:[h.ElementRef]}]},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[j.showRuleToken]}]}]},t.propDecorators={onAddNote:[{type:h.Output}],onDisplayNote:[{type:h.Output}],onEditNote:[{type:h.Output}],onDeleteNote:[{type:h.Output}],contactListRefresh:[{type:h.Output}],contactList:[{type:h.Input}]},t}(),et=function(u){function t(t,e,n,i,o,a,r,s,l){var c=u.call(this,i,e,r,a)||this;return c.dateUtils=t,c.profileCodeService=e,c.changeDetctor=n,c.metaService=i,c.customerUtils=o,c.showRule=s,c.customMetaController=l,c.onEditDetail=new h.EventEmitter,c.onCallPhone=new h.EventEmitter,c.onDeleteDetail=new h.EventEmitter,c.onAddAppointment=new h.EventEmitter,c.followChange=new h.EventEmitter,c.DisplayData=null,c.dash="- -",c.language=new j.Language,c.isEmptyAppointment=!1,c.isEmptyEdit=!1,c.isEmptyDel=!1,c.isEmptyDetailInfo=!1,c.isEmptyGroupDetailInfo=!1,c.isEmptyContactNote=!1,c.isCollapseBtnShow=!0,c.isCardExtendTemplateNull=!0,c.isCollapseOpen=!1,c}return y(t,u),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){var e=this;this._data=t,console.log("detail Set Data:",t),t&&t.ClientID?this.waitUntilMetaLoaded().then(function(){e.onDataUpdated()}):this._data=null},enumerable:!0,configurable:!0}),t.prototype.getMetaID=function(){return"customerDetail"},t.prototype.getMetaParams=function(){return null},Object.defineProperty(t.prototype,"rowMetaWithoutGroup",{get:function(){return this.metaConfig.Rows.filter(function(t){return t.map(function(t){return"Group"!==t.type}).reduce(function(t,e){return t&&e},!0)})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowMetaGroup",{get:function(){return this.metaConfig.Columns.filter(function(t){return"Group"===t.type})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"followStatus",{get:function(){return"Y"===this._data.IsFollow},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHasAgeRange",{get:function(){return this._data&&!!this._data.AgeRange},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHasContactFrequancy",{get:function(){return this._data&&!!this._data.ContactFrequancy},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){console.log("customerDetail ngOninit!"),u.prototype.ngOnInit.call(this)},t.prototype.onDataUpdated=function(){console.log("customerDetail onDataUpdated!",this._data),u.prototype.onDataUpdated.call(this),this.isEmptyDel="OPUS"==this._data.DataSource,this.convertEmptyValToDisplayText(this._data),this.checkInfoIsEmpty(),this.changeCollateButton(),this.DisplayData=Object.assign({},this._data),this.customMetaController&&this.customMetaController.onDataUpdated(this._data),this.changeDetctor.detectChanges(),console.log("after customerDetail onDataUpdated!",this.DisplayData)},t.prototype.changeCollateButton=function(){var e=this;console.log("changeCollateButton Meta:",this.metaConfig),this.isCollapseBtnShow=this.metaConfig.Columns.filter(function(t){return"Group"===t.type}).map(function(t){return e._data[t.id].length>12/t.grid.pc}).reduce(function(t,e){return t||e},!1),console.debug("isCollapseBtnShow",this.isCollapseBtnShow)},t.prototype.checkInfoIsEmpty=function(){var e=this;this.isEmptyDetailInfo=this.metaConfig.Columns.filter(function(t){return"Group"!==t.type}).map(function(t){return null===e._data[t.id]||e._data[t.id]===undefined||j.StringUtils.isEmpty(e._data[t.id])||e._data[t.id]===e.dash}).reduce(function(t,e){return t&&e},!0),this.isEmptyGroupDetailInfo=this.metaConfig.Columns.filter(function(t){return"Group"===t.type}).map(function(t){return 0===e._data[t.id].length}).reduce(function(t,e){return t&&e},!0),console.log("isEmptyDetailInfo:",this.isEmptyDetailInfo),console.log("isEmptyGroupDetailInfo:",this.isEmptyGroupDetailInfo)},t.prototype.convertEmptyValToDisplayText=function(e){var n=this;console.log("convertEmptyValToDisplayText: ",e),e.AgeRange=this.profileCodeService.convertCode2Text("Customer_Age",e.AgeRange),e.ContactFrequancy=this.profileCodeService.convertCode2Text("Customer_ContactFrequancy",e.ContactFrequancy),e.showName=this.convertNameToShow(e.FirstName,e.LastName),e.address.forEach(function(t){t.AddressDisplay=n.toFullAddress(Object.assign({},t))}),this.metaConfig.Columns.filter(function(t){return"Group"!==t.type}).forEach(function(t){"BirthdayDisplay"===t.id?e.BirthdayDisplay=j.StringUtils.isNotEmpty(e.Birthday)?n.toBirthdayStr():n.dash:e[t.id]=j.StringUtils.isEmpty(e[t.id])?n.dash:e[t.id]})},t.prototype.toBirthdayStr=function(){if(this._data.Birthday!==undefined)return this.showRule?this.showRule.convertDate(new Date(this._data.Birthday)):this.dateUtils.toDateString(new Date(this._data.Birthday),"yyyy-MM-dd")},t.prototype.toFullAddress=function(t){if(this.showRule)return this.showRule.convertAddress(t);var e=[];return j.StringUtils.isNotEmpty(t.Country)&&e.push(t.Country),j.StringUtils.isNotEmpty(t.City)&&e.push(t.City),j.StringUtils.isNotEmpty(t.Area)&&e.push(t.Area),j.StringUtils.isNotEmpty(t.Zipcode)&&e.push(t.Zipcode),j.StringUtils.isNotEmpty(t.Address)&&e.push(t.Address),e.join(", ")},t.prototype.edit=function(){this.onEditDetail.emit(this._data.ClientID)},t.prototype["delete"]=function(){this.onDeleteDetail.emit(this._data.ClientID)},t.prototype.callPhone=function(){this.onCallPhone.emit(this._data.ClientID)},t.prototype.addAppointment=function(){this.onAddAppointment.emit(this._data.ClientID)},t.prototype.trackByFn=function(t,e){return e.name},t.prototype.isFollowChange=function(t){console.debug("isFollowChange",t),this._data.IsFollow=t?"Y":"N",this.changeDetctor.detectChanges(),this.followChange.emit({isFollow:t,clientID:this._data.ClientID})},t.prototype.convertNameToShow=function(t,e){return this.customerUtils.convertNameToShow(t,e)},t.decorators=[{type:h.Component,args:[{selector:"app-customer-detail",template:'\x3c!-- has CustomerDetail data--\x3e\n<ng-container\n  *ngIf="DisplayData && data  && DisplayData.ClientID && isMetaLoaded(); else noCustomerData">\n  <div class="layout-detail-block style-has-top-space style-has-right-space">\n    \x3c!-- profile --\x3e\n    <div class="space-ui-element profile-block">\n      <div class="profile-img-block img-block" [ngClass]="DisplayData.DataSource == \'OPUS\' ? \'\': \' active\'">\n        \x3c!-- if true show active img (green) or show normal img --\x3e\n        <img class="normal-img" src="assets/img/img-cust-profile.svg">\n        <img class="active-img" src="assets/img/img-cust-profile-active.svg">\n      </div>\n      <div class="content-block">\n        <ng-container *ngIf="DisplayData.Possibility">\n          <app-ui-form-radio-tag class="wd-lg profile-tag" [checked]="true" [disabled]="true"\n            [ngClass]="DisplayData.Possibility">{{DisplayData.Possibility|translate}}</app-ui-form-radio-tag>\n        </ng-container>\n\n        <div class="name-block" [ngClass]="{\'noTagBlock\': !DisplayData.Possibility}">\n          {{DisplayData.showName}}\n        </div>\n        <div class="sm-text">\n          <span class="age" *ngIf="isHasAgeRange">\n            ({{DisplayData.AgeRange}})\n          </span>\n          <span class="detail-text" *ngIf="isHasContactFrequancy">\n            {{language.contactFrequency|translate }}\n            <span class="text-focus">{{DisplayData.ContactFrequancy}}</span>\n            {{language.timePerYear|translate }}\n          </span>\n        </div>\n      </div>\n      <div class="like-block">\n        <app-ui-btn-like-add [isLike]="followStatus" (onChange)="isFollowChange($event)">\n        </app-ui-btn-like-add>\n      </div>\n\n    </div>\n    \x3c!-- end of profile --\x3e\n\n    \x3c!-- link --\x3e\n    <ul class="space-ui-element ui-list-block">\n      <li class="list-item-block" [ngClass]="isEmptyAppointment? \' disable\': \'\'">\n        <button [id]="\'btn_customerAddAppointment\'" Action action=\'addAppointment\' (actionClick)="addAppointment()">\n          <div class="img-block">\n            <img class="img-disable" src="assets/img/icon-cust-appointment-disable.svg">\n            <img class="img-normal" src="assets/img/icon-cust-appointment.svg">\n          </div>\n          <div class="text-block">\n            <p>{{ language.customerAppointment | translate }}</p>\n          </div>\n        </button>\n      </li>\n      <li class="list-item-block" [ngClass]="DisplayData.tel.length == 0? \' disable\': \'\'">\n        <button [id]="\'btn_customerCallPhone\'" Action action="customerCallPhone" (actionClick)="callPhone()">\n          <div class="img-block">\n            <img class="img-disable" src="assets/img/icon-cust-contact-disable.svg">\n            <img class="img-normal" src="assets/img/icon-cust-contact.svg">\n          </div>\n          <div class="text-block">\n            <p>{{ language.customerContact | translate }}</p>\n          </div>\n        </button>\n      </li>\n      <li class="list-item-block" [ngClass]="isEmptyEdit? \' disable\': \'\'">\n        <button [id]="\'btn_customerEdit\'" Action action="customerEdit" (actionClick)="edit()">\n          <div class="img-block">\n            <img class="img-disable" src="assets/img/icon-cust-edit-disable.svg">\n            <img class="img-normal" src="assets/img/icon-cust-edit.svg">\n          </div>\n          <div class="text-block">\n            <p>{{ language.customerEdit | translate }}</p>\n          </div>\n        </button>\n      </li>\n      <li class="list-item-block" [ngClass]="isEmptyDel? \' disable\': \'\'">\n        <button [id]="\'btn_customerDelete\'" Action action="customerDelete" (actionClick)="delete()" [disabled]="DisplayData.DataSource == \'OPUS\'">\n          <div class="img-block">\n            <img class="img-disable" src=\'assets/img/icon-cust-del-disable.svg\'>\n            <img class="img-normal" src="assets/img/icon-cust-del.svg">\n          </div>\n          <div class="text-block">\n            <p>{{ language.customerDelete | translate }}</p>\n          </div>\n        </button>\n\n      </li>\n    </ul>\n    \x3c!-- end of link block --\x3e\n    \x3c!-- first card --\x3e\n\n\n\n    \x3c!-- Meta Group Detail --\x3e\n    <app-ui-collapse-text1 class="card1-all-block" [(isOpen)]="isCollapseOpen" [(isCollapseBtnShow)]="isCollapseBtnShow"\n      [translateEmpty]="language.empty | translate" [isDataEmpty]="isEmptyGroupDetailInfo">\n      <ng-container TextType=cardContent>\n        <app-ui-form-layout-advanced [isOnlyText]="true">\n          <ng-container *ngFor="let group of rowMetaGroup">\n            <app-ui-form-layout-row>\n              <ng-container *ngFor="let groupData of DisplayData[group.id]; index as i; first as isFirst">\n                <app-ui-form-layout-col *ngIf="(group.grid.pc*(i+1))<=12" [colPC]="group.grid.pc"\n                  [colNB]="group.grid.nb" [colPad]="group.grid.pad" [colMobile]="group.grid.mobile">\n                  <snd-ui-collapse-content-show>\n                    <app-ui-info-text1 *ngIf="isFirst" [imgSrc]="group.icon">\n                      <ng-container textType="title">\n                        {{DisplayData[group.id][i][group.groupColumns[0].id] | translate}}\n                      </ng-container>\n                      <ng-container textType="text" *ngFor="let col of group.groupColumns.slice(1);">\n                        {{DisplayData[group.id][i][col.id] | translate}}\n                      </ng-container>\n                    </app-ui-info-text1>\n                    <app-ui-info-text1 *ngIf="!isFirst">\n                      <ng-container textType="title">\n                        {{DisplayData[group.id][i][group.groupColumns[0].id] | translate}}\n                      </ng-container>\n                      <ng-container textType="text" *ngFor="let col of group.groupColumns.slice(1);">\n                        {{DisplayData[group.id][i][col.id] | translate}}\n                      </ng-container>\n                    </app-ui-info-text1>\n                  </snd-ui-collapse-content-show>\n                </app-ui-form-layout-col>\n              </ng-container>\n            </app-ui-form-layout-row>\n            <app-ui-form-layout-row>\n              <ng-container *ngFor="let groupData of DisplayData[group.id]; index as i; first as isFirst">\n                <app-ui-form-layout-col *ngIf="(group.grid.pc*(i+1))>12" [colPC]="group.grid.pc" [colNB]="group.grid.nb"\n                  [colPad]="group.grid.pad" [colMobile]="group.grid.mobile">\n                  <snd-ui-collapse-content-detail [(isOpen)]="isCollapseOpen">\n                    <app-ui-info-text1 *ngIf="isFirst" [imgSrc]="group.icon">\n                      <ng-container textType="title">\n                        {{DisplayData[group.id][i][group.groupColumns[0].id]}}\n                      </ng-container>\n                      <ng-container textType="text" *ngFor="let col of group.groupColumns.slice(1);">\n                        {{DisplayData[group.id][i][col.id]}}\n                      </ng-container>\n                    </app-ui-info-text1>\n                    <app-ui-info-text1 *ngIf="!isFirst">\n                      <ng-container textType="title">\n                        {{DisplayData[group.id][i][group.groupColumns[0].id]}}\n                      </ng-container>\n                      <ng-container textType="text" *ngFor="let col of group.groupColumns.slice(1);">\n                        {{DisplayData[group.id][i][col.id]}}\n                      </ng-container>\n                    </app-ui-info-text1>\n                  </snd-ui-collapse-content-detail>\n                </app-ui-form-layout-col>\n              </ng-container>\n            </app-ui-form-layout-row>\n          </ng-container>\n        </app-ui-form-layout-advanced>\n      </ng-container>\n    </app-ui-collapse-text1>\n    \x3c!-- end of Meta Group Detail --\x3e\n\n\n    \x3c!-- Meta Detail --\x3e\n    <app-ui-collapse-card1 [isHide]="isCardExtendTemplateNull" [isDataEmpty]="isEmptyDetailInfo"\n      [tagText]="[language.customerDetail | translate]"\n      [emptyText]="[language.noClick | translate, language.noInformation | translate]">\n      <ng-container textType="collapseContentOrigin">\n        <app-ui-form-layout-row *ngFor="let row of rowMetaWithoutGroup">\n          <app-ui-form-layout-col *ngFor="let col of row" [colPC]="col.grid.pc" [colNB]="col.grid.nb"\n            [colPad]="col.grid.pad" [colMobile]="col.grid.mobile">\n            <app-ui-info-text2>\n              <ng-container textType="title">{{col.name|translate }}</ng-container>\n              <ng-container textType="text">{{DisplayData[col.id]?DisplayData[col.id]:dash}}</ng-container>\n            </app-ui-info-text2>\n          </app-ui-form-layout-col>\n        </app-ui-form-layout-row>\n      </ng-container>\n    </app-ui-collapse-card1>\n    \x3c!-- end of Meta Detail --\x3e\n  </div>\n</ng-container>\n\n<ng-template #noCustomerData>\n  <div class="layout-detail-block style-has-top-space skelton-layout">\n    <div class="theme-loading" style="background-image:url(\'assets/img/loading-customer-main.svg\')">\n      \x3c!-- profile --\x3e\n      <div class="space-ui-element profile-block">\n        <div class="img-block">\n          <div class="skeleton-round "></div>\n        </div>\n        <div class="content-block">\n          <div class="tag-block">\n            <div class="skelton-text  "></div>\n          </div>\n          <div class="name-block">\n            <div class="skelton-text "></div>\n          </div>\n          <div class="sm-text">\n            <div class="skelton-text "></div>\n          </div>\n        </div>\n      </div>\n      \x3c!-- end of profile --\x3e\n      \x3c!-- link list --\x3e\n      <ul class="ui-list-block">\n        <li class="list-item-block" *ngFor=\'let number of [0,1,2,3]\'>\n          <div class="skelton-img-text">\n            <div class="skelton-square">\n              <div class="skeleton-round "></div>\n            </div>\n            <div class="skelton-text "></div>\n          </div>\n        </li>\n      </ul>\n      \x3c!-- end of link list --\x3e\n      \x3c!-- line --\x3e\n      <div class="skelton-line-block">\n        <div class="skelton-line "></div>\n      </div>\n      \x3c!-- end of line --\x3e\n\n      \x3c!-- list data --\x3e\n      <div class="card-text">\n        <div class="left-part">\n          <div class="data-group">\n\n            <div class="skelton-text   wd-short"></div>\n            <div class="skelton-text   wd-long"></div>\n            <div class="skelton-text   wd-short"></div>\n            <div class="skelton-text   wd-long"></div>\n            <div class="skelton-text   wd-long"></div>\n          </div>\n        </div>\n        <div class="right-part">\n          <div class="data-group">\n            <div class="skelton-text   wd-short"></div>\n            <div class="skelton-text   wd-long"></div>\n            <div class="skelton-text   wd-short"></div>\n            <div class="skelton-text   wd-long"></div>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- end of list data --\x3e\n\n      \x3c!-- line --\x3e\n      \x3c!-- <div class="skelton-line-block">\n        <div class="skelton-line "></div>\n      </div> --\x3e\n      \x3c!-- end of line --\x3e\n\n\n\n    </div>\n  </div>\n  \x3c!-- Customer data is empty --\x3e\n</ng-template>\n',styles:[".skelton-layout{margin:0}.skelton-row{display:flex}.skelton-row.align-side{justify-content:space-between}.align-right{margin:0 0 15px auto}.align-center{margin:15px auto}.skeleton-round{border-radius:50%;background-color:#ececec;max-width:100%;max-height:100%;width:100%;height:100%}.skelton-square{display:inline-block;width:30px;height:30px}.skelton-text{min-height:1rem;max-width:100%;width:100%;background-color:#ececec;display:block;margin-bottom:15px}.skelton-line{display:inline-block;max-width:100%;width:100%;background-color:#ececec;height:1px}.skelton-img-text .skelton-square{margin-bottom:10px}::ng-deep ion-skeleton-text{background-color:#ececec}::ng-deep ion-skeleton-text span{opacity:1;background-color:#ececec}.skelton-animate{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-name:placeHolderShimmer;animation-name:placeHolderShimmer;-webkit-animation-timing-function:linear;animation-timing-function:linear;background:rgba(194,194,194,.3);background:linear-gradient(to right,rgba(194,194,194,.3) 8%,rgba(194,194,194,.2) 18%,rgba(194,194,194,.3) 33%);background-size:800px 100px;position:relative}@-webkit-keyframes placeHolderShimmer{0%{background-position:-268px 0}100%{background-position:268px 0}}@keyframes placeHolderShimmer{0%{background-position:-268px 0}100%{background-position:268px 0}}.layout-detail-block.skelton-layout{margin:0 -40px 0 0}@media (max-width:767px){.layout-detail-block.skelton-layout{margin-right:-40px}.layout-detail-block.skelton-layout .profile-block .content-block{max-width:70%}.layout-detail-block.skelton-layout .theme-loading .ui-list-block .list-item-block{margin-right:0}}.layout-detail-block .skelton-line-block{padding-right:40px}.layout-detail-block .theme-loading{background-size:contain;background-position:bottom right;background-repeat:no-repeat;width:100%;min-height:100vh;padding-right:40px}.layout-detail-block .theme-loading .profile-block .img-block{display:inline-block;max-width:100%;width:63px;height:63px;padding-right:0;margin-right:20px}.layout-detail-block .theme-loading .profile-block .tag-block{max-width:15%}.layout-detail-block .theme-loading .profile-block .name-block{max-width:30%;padding-bottom:0}.layout-detail-block .theme-loading .profile-block .sm-text{max-width:55%}.layout-detail-block .theme-loading .profile-block ::ng-deep ion-skeleton-text{margin-bottom:10px}.layout-detail-block .theme-loading .ui-list-block{margin-bottom:20px}.layout-detail-block .theme-loading .ui-list-block .list-item-block{margin-right:5%}.layout-detail-block .theme-loading .ui-list-block .skelton-img-text .skelton-text{max-width:80%;margin:0 auto}.layout-detail-block .theme-loading .skelton-square{width:3rem;height:3rem}.layout-detail-block .theme-loading .card-text{display:flex}.layout-detail-block .theme-loading .card-text .left-part{width:40%;box-sizing:border-box;padding:2rem}.layout-detail-block .theme-loading .card-text .right-part{width:60%;box-sizing:border-box;padding:2rem}.layout-detail-block .theme-loading .card-text .wd-short{max-width:5rem}.layout-detail-block .theme-loading .card-text .wd-long{max-width:100%}@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.space-detail{padding-right:40px;display:block}@media (max-width:1023px){.space-detail{padding-right:40px}}.layout-detail-block{background-color:#f5f5f5;padding-left:40px}.layout-detail-block .space-detail:not(.layout-nodata):last-child{padding-bottom:100px}.layout-detail-block .layout-nodata{padding-bottom:0}@media (min-width:768px){.layout-detail-block.style-has-right-space{padding-right:40px}.layout-detail-block.style-has-right-space.skelton-layout{padding-right:0}}.layout-detail-block.style-has-top-space{padding-top:40px}@media (max-width:767px){.space-detail{padding-right:5px}.layout-detail-block{padding-left:5px}.layout-detail-block.style-has-right-space{padding-right:5px}.layout-detail-block.style-has-top-space{padding-top:30px}}.layout-detail-block.style-has-btm-space{padding-bottom:100px}.space-inner-lg{padding-left:50px;padding-right:50px}@media (max-width:767px){.space-inner-lg{padding-left:5px;padding-right:5px}}.profile-img-block img{border-radius:50%;display:inline-block}.profile-img-block .active-img,.profile-img-block.active .normal-img{display:none}.profile-img-block.active .active-img{display:block}.profile-block{display:flex;justify-content:flex-start;flex-wrap:wrap;width:100%;position:relative}.profile-block .profile-img-block{padding-right:15px}.profile-block .profile-img-block img{width:60px;height:60px}.profile-block .content-block{max-width:calc(100% - 40px - 10px - 60px - 15px);width:100%}.profile-block .content-block ::ng-deep .tag-block{margin-bottom:5px}.profile-block .content-block .name-block{font-size:1.25rem;font-weight:700;padding-bottom:5px;line-height:28px;white-space:normal;word-wrap:break-word}.profile-block .content-block .name-block.noTagBlock{padding-top:15px}.profile-block .sm-text{font-size:.875rem;line-height:28px;width:100%}.profile-block .sm-text .text-focus{color:#003781;font-weight:700;font-size:1.125rem;display:inline-block;padding:0 5px;vertical-align:middle}.profile-block .sm-text .detail-text{display:inline-flex;align-items:center;flex-wrap:wrap}.profile-block .age{display:inline-block;line-height:28px;min-height:28px;margin-right:5px}.profile-block .like-block{position:absolute;top:0;right:0}.profile-block .like-block ::ng-deep img{max-width:40px;width:100%}@media (max-width:768px){.profile-block{padding-left:15px;padding-right:6px;position:static}.profile-block .like-block{right:10px;top:10px}.profile-block .profile-img-block{padding-right:10px}.profile-block .profile-img-block img{width:45px;height:45px}.profile-block .content-block{max-width:calc(100% - 45px - 10px)}.profile-block .content-block .name-block{padding-right:50px}.profile-block .content-block .name-block.noTagBlock{padding-top:10px}}@media screen and (min-width:1025px){.profile-block .profile-img-block{width:calc(caculate-vw($wd-profile-img) + 15px)}.profile-block .profile-img-block img{width:6vw;height:6vw}.profile-block .content-block{max-width:calc(100% - 4vw - 10px - 6vw - 15px)}.profile-block .like-block ::ng-deep img{max-width:4vw}}.ui-list-block{display:flex;list-style-type:none;margin-right:-30px;justify-content:center;align-items:baseline}.ui-list-block button{border:none;background-color:transparent;padding:0}.ui-list-block .list-item-block{width:25%;max-width:5.625rem;text-align:center;margin-right:30px}.ui-list-block .list-item-block .img-block{max-width:40px;width:100%;margin:0 auto}.ui-list-block .list-item-block .img-block img{max-width:100%;width:100%}.ui-list-block .list-item-block.disable{pointer-events:none}.ui-list-block .list-item-block.disable .text-block{color:#414141}.ui-list-block .list-item-block .img-disable,.ui-list-block .list-item-block.disable .img-normal{display:none}.ui-list-block .list-item-block.disable .img-disable{display:inline-block;pointer-events:none}.ui-list-block .list-item-block .text-block p{color:#414141;line-height:normal;font-size:.875rem;margin:4px 0 0;padding:0 4px}@media (max-width:767px){.ui-list-block{flex-wrap:wrap;margin-right:0}.ui-list-block .list-item-block{max-width:100px;margin-right:0}}@media (max-width:374px){.ui-list-block .list-item-block .text-block p{font-size:.75rem;padding-right:10px}}@media screen and (min-width:1025px){.ui-list-block .list-item-block{max-width:9vw}.ui-list-block .list-item-block .img-block{max-width:4vw;width:4vw}}.card1-all-block::ng-deep .card-content-block{padding-top:20px}.card1-all-block::ng-deep .gas-row-block{margin-top:0}.card1-all-block::ng-deep .gas-row-block+.gas-row-block{margin-top:4px}@media (min-width:769px){.card1-all-block::ng-deep .gas-layout-form{box-sizing:border-box;padding-left:51px;padding-right:64px}.card1-all-block::ng-deep .gas-row-block{margin-top:0}}@media (max-width:767px){.card1-all-block::ng-deep .gas-layout-form{padding-left:15px}.card1-all-block::ng-deep .card-content-block app-ui-info-text1 .info-unit-block .text-block p{padding-left:10px}}"]}]}],t.ctorParameters=function(){return[{type:j.DateUtils},{type:j.ProfileCodeService},{type:h.ChangeDetectorRef},{type:j.MetaService},{type:Z},{type:j.InputExecutor},{type:j.DefaultMetaParser},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[j.showRuleToken]}]},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[S]}]}]},t.propDecorators={onEditDetail:[{type:h.Output}],onCallPhone:[{type:h.Output}],onDeleteDetail:[{type:h.Output}],onAddAppointment:[{type:h.Output}],followChange:[{type:h.Output}],data:[{type:h.Input}],detailPostTemp:[{type:h.ViewChildren,args:["detailPostTemp"]}]},t}(j.DisplayMetaComponent),nt=function(){function t(){this._customerState=it.DISPLAY,this._customerDetail={ClientID:""},this._customerList=[],this._customerCriteria=new W,this._stateBehaviorSubject=new f.BehaviorSubject(this._customerState),this._detailBehaviorSubject=new f.BehaviorSubject(this._customerDetail),this._listBehaviorSubject=new f.BehaviorSubject(this._customerList),this._criteriaBehaviorSubject=new f.BehaviorSubject(this._customerCriteria),this._detailIDSubject=new f.BehaviorSubject(this._customerDetail.ClientID)}return t.prototype.setState=function(t){this._customerState=t,this._stateBehaviorSubject.next(this._customerState)},t.prototype.getState=function(){return this._stateBehaviorSubject},t.prototype.setCurrentCustomerDetail=function(t){this._customerDetail=t,this._detailBehaviorSubject.next(this._customerDetail),this._detailIDSubject.next(this._customerDetail.ClientID)},t.prototype.getCurrentCustomerDetail=function(){return this._detailBehaviorSubject},t.prototype.setCustomerList=function(t){this._customerList=t,this._listBehaviorSubject.next(this._customerList)},t.prototype.getCustomerList=function(){return this._listBehaviorSubject},t.prototype.setCriteria=function(t){this._customerCriteria=t,this._criteriaBehaviorSubject.next(this._customerCriteria)},t.prototype.getCriteria=function(){return this._criteriaBehaviorSubject},t.prototype.getCustomerDetailID=function(){return this._detailIDSubject},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=h.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),it={IMPORT:"import",DISPLAY:"display",EDIT:"edit",ADD_SAVED:"add saved",EDIT_SAVED:"edit saved",FIRST:"first"},ot=function(){function t(){}return t.prototype.onDataUpdated=function(t){t.tel&&(t.notOPUSTel=t.tel.filter(function(t){return t.DataSource&&"OPUS"!==t.DataSource})),console.log("Default controller onDataUpdated:",t)},t.prototype.onValueChange=function(t,e,n,i,o,a){},t.prototype.onValidateAll=function(t,n){var i=this;return t.tel=t.tel.filter(function(t){return t.dataSource&&"OPUS"===t.dataSource}).concat(t.notOPUSTel),t.email&&0<t.email.length&&t.email.forEach(function(t,e){i.isEmailFormat(t.Email)?n.deleteError("Email"+e.toString()):n.setErrorMap("Email"+e.toString(),"Wrong_Email")}),n.isTrue()},t.prototype.btnClick=function(t,e,n){},t.prototype.isEmailFormat=function(t){return new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/).test(t)},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ngInjectableDef=h.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),at=function(g){function t(t,e,n,i,o,a,r,s,l,c,u,p,d){var m=g.call(this,p,r,s,l)||this;return m.customerUtils=t,m.changeDetector=e,m.elementRef=n,m.router=i,m.translateService=o,m.customerStoreService=u,m.metaService=p,m.addProgressPoint=d,m.sendContentHeight=new h.EventEmitter,m.customerDetailSubscribe=null,m.pageTitle="Add_Profile",m.today=new Date,m.language=new j.Language,m.disableAge=!1,m.isDisplaySavePopup=!1,m.isShow=!1,m.edit_type="add",m.customerID="",m._metaController=c||a,m}return y(t,g),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowConfig",{get:function(){return this.metaConfig.Rows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnConfig",{get:function(){return this.metaConfig.Columns},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"footerConfig",{get:function(){return this.metaConfig.Footer},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var e=this;this.customerDetailSubscribe=this.customerStoreService.getCustomerDetailID().subscribe(function(t){console.log("customerID:",t),e.customerID=t,g.prototype.ngOnInit.call(e),j.StringUtils.isEmpty(t)?e.edit_type="add":e.edit_type="edit"})},t.prototype.ngOnDestroy=function(){this.customerDetailSubscribe&&this.customerDetailSubscribe.unsubscribe()},t.prototype.btnClick=function(t,e){if(console.log("BTN CLICK!",t,e),"submit"===t&&this.validationResult.isTrue()){this.customerStoreService.setCurrentCustomerDetail(this._data);var n="add"==this.edit_type?it.ADD_SAVED:it.EDIT_SAVED;this.customerStoreService.setState(n),console.log("customer addProgressPoint",this.addProgressPoint),this.addProgressPoint&&"add"==this.edit_type&&this.addProgressPoint.addCustomerPoint(1),this.router.navigate("Customers")}this._metaController.btnClick(t,e,this._data)},t.prototype.getMetaID=function(){return"customerEdit"},t.prototype.getMetaParams=function(){return{id:this.customerID}},t.prototype.onValueChange=function(t,e,n,i){"Birthday"===t&&this.countAgeRange(e),this._metaController.onValueChange(t,e,n,i,this._data,this.validationResult)},t.prototype.onDataUpdated=function(){g.prototype.onDataUpdated.call(this),console.log("onDataUpdated!"),console.log("data:",this._data),console.log("stringify:",JSON.stringify(this._data)),"add"===this.edit_type?(this.pageTitle=this.translateService.translate(this.language.addProfile),this.disableAge=!1):"edit"===this.edit_type&&(this.pageTitle=this.convertNameToShow(this._data.FirstName,this._data.LastName),this.disableAge=j.StringUtils.isNotEmpty(this._data.Birthday)),this.isShow=!0,this._metaController.onDataUpdated(this._data)},t.prototype.onValidateAll=function(){var t=this,e=this.customerUtils.countCompleteness(this._data);this._data.Completeness=Math.round(100*e)/100,console.log("Calculate Completeness:",this._data.Completeness);var n=this._metaController.onValidateAll(this._data,this.validationResult)&&this.validationResult.isTrue();return n||setTimeout(function(){t.scrollToError()},200),n},t.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){t.contentHeight=t.content.nativeElement.offsetHeight,console.log("ele Height:",t.contentHeight)},600),this.sendContentHeight.emit(this.contentHeight)},t.prototype.countAgeRange=function(t){if(j.StringUtils.isEmpty(t))this._data.AgeRange=undefined,this.disableAge=!1;else{var e=this.customerUtils.countAge(t),n=this.customerUtils.countAgeRange(e);console.debug("ageRange",n),n!=undefined&&(this._data.AgeRange=n,this.disableAge=!0)}console.log("this.data in countAgeRange:",this._data),this.changeDetector.detectChanges()},t.prototype.scrollToError=function(){console.log("scrollToError");var t=this.elementRef.nativeElement.querySelector(".error-msg"),e=this.elementRef.nativeElement.querySelector(".form-scroll-content");if(console.log("scroll error:",e,"errorBlock",t),t&&e){var n=t.offsetTop;console.log("scrollToError errorBlock.offsetTop",t.offsetTop,"move",n),e.scrollTo({top:n,behavior:"smooth"})}},t.prototype.convertNameToShow=function(t,e){return this.customerUtils.convertNameToShow(t,e)},t.decorators=[{type:h.Component,args:[{selector:"app-customer-edit",template:'<app-ui-inner-page *ngIf="isShow" [title]="[pageTitle]" [contentHeight]="this.contentHeight">\n  <div main>\n    <div #inpageMain class="layout-block">\n      <div class="layout-style-single">\n        <div class="form-all page-cust-info" action="">\n          <div class="profile-img-block img-block" [ngClass]="data.DataSource == \'OPUS\' ? \'\': \' active\'">\n            <img class="normal-img" src="assets/img/img-customer-profile.svg">\n            <img class="active-img" src="assets/img/img-cust-profile-active.svg">\n          </div>\n          <app-ui-form-layout-advanced class="customer-edit-block">\n            <ng-container *ngFor="let rowList of rowConfig">\n              <app-ui-data-group>\n                <ng-container textType="dataContent">\n                  <app-ui-form-layout-row>\n                    <app-ui-form-layout-col *ngFor="let col of rowList" [colPC]="col.grid.pc" [colNB]="col.grid.nb"\n                      [colPad]="col.grid.pad" [colMobile]="col.grid.mobile"\n                      [isGroupCol]="col.type==\'Group\' ? true : false">\n                      <ng-container *ngIf="col.type==\'Input\'">\n                        <app-ui-form-input [inputTitle]="col.name |translate" [name]="col.name |translate"\n                          [isError]="validationResult.isError(col.id)" [(nxValue)]="data[col.id]" [isDisable]="col.id==\'LastName\' && data.DataSource==\'OPUS\'"\n                          (nxValueChange)="onChange(col.id,$event)">\n                        </app-ui-form-input>\n                        <app-ui-form-error-msg *ngIf="validationResult.getErrorMsg(col.id)">\n                          {{validationResult.getErrorMsg(col.id) |translate }}</app-ui-form-error-msg>\n                      </ng-container>\n                      <ng-container *ngIf="col.type==\'Select\'">\n                        <app-ui-form-select [selectTitle]="col.name |translate" [selectOption]="data[col.id+\'Option\']"\n                          [isDisable]="(col.id===\'AgeRange\'&&disableAge) || col.readonly || (col.id==\'Gender\' && data.DataSource==\'OPUS\' )" [(nxValue)]="data[col.id]"\n                          (nxValueChange)="onChange(col.id,$event)" [placeholder]="col.placeholder | translate"\n                          [isShowTitle]="col.showTitle" [isShowDefaultOption]="col.showDefaultOption">\n                        </app-ui-form-select>\n                        \n                        <app-ui-form-error-msg *ngIf="validationResult.getErrorMsg(col.id)">\n                          {{validationResult.getErrorMsg(col.id) |translate }}</app-ui-form-error-msg>\n                      </ng-container>\n                      <ng-container *ngIf="col.type==\'Radio\'">\n                        <app-ui-form-title-sm>{{col.name |translate}}</app-ui-form-title-sm>\n                        <div class="tag-block">\n                          <app-ui-form-radio-group [(nxValue)]="data[col.id]" (nxValueChange)="onChange(col.id,$event)">\n                            <app-ui-form-radio-tag *ngFor="let option of data[col.id+\'Option\']"\n                              [colorCode]="option.arguments.color" [checked]="data[col.id] === option.id "\n                              class="{{option.name}} wd-max" [value]="option.id">\n                              {{option.name}}</app-ui-form-radio-tag>\n                          </app-ui-form-radio-group>\n                        </div>\n                      </ng-container>\n                      <ng-container *ngIf="col.type==\'Date\'">\n                        <app-ui-form-date [title]="col.name |translate" [(nxValue)]="data[col.id]" [max]="col.name===\'Birthday\'? today :null" [isDisable]="col.name==\'Birthday\' && data.DataSource == \'OPUS\'"\n                          (nxValueChange)="onChange(col.id,$event)"></app-ui-form-date>\n                        <app-ui-form-error-msg *ngIf="validationResult.getErrorMsg(col.id) == \'date\'">\n                          {{validationResult.getErrorMsg(col.id) |translate }}</app-ui-form-error-msg>\n                      </ng-container>\n                      <ng-container *ngIf="col.type==\'Group\'">\n                        <app-ui-data-group class="form-group-block" [groupName]="col.name |translate" [isShowPreData]="true"\n                          [imgType]="col.icon && col.icon.length>0" [imgIconSrc]="col.icon">\n                          <ng-container textType="dataContent">\n                            <ng-container *ngIf="data[col.id].length != 0">\n                              <app-ui-form-layout-row *ngFor="let item of data[col.id]; index as i ; last as isLast">\n                                <ng-container *ngFor="let groupCol of col.groupColumns; last as groupLast">\n                                  <app-ui-form-layout-col [colPC]="groupCol.grid.pc" [colNB]="groupCol.grid.nb"\n                                    [colPad]="groupCol.grid.pad" [colMobile]="groupCol.grid.mobile"\n                                    [hasRemove]="col.canAdd && groupLast" (remove)="onGroupRemove(col.id,i)">\n                                    <ng-container *ngIf="groupCol.type==\'Select\'">\n                                      <app-ui-form-select [selectTitle]="groupCol.name |translate"\n                                        [selectOption]="data[groupCol.id+\'Option\']"\n                                        [(nxValue)]="data[col.id][i][groupCol.id]"\n                                        (nxValueChange)="onChange(groupCol.id,$event,col.id,i)" [placeholder]="groupCol.placeholder | translate"\n                                        [isShowTitle]="groupCol.showTitle"\n                                        [isShowDefaultOption]="groupCol.showDefaultOption">\n                                      </app-ui-form-select>\n                                      <app-ui-form-error-msg *ngIf="validationResult.getErrorMsg(groupCol.id+i)">\n                                        {{validationResult.getErrorMsg(groupCol.id+i) |translate }}\n                                      </app-ui-form-error-msg>\n                                    </ng-container>\n                                    <ng-container *ngIf="groupCol.type==\'Input\'">\n                                      <app-ui-form-input [inputTitle]="groupCol.name |translate"\n                                        [type]="groupCol.id===\'Tel\'?\'tel\':\'text\'" [name]="groupCol.name |translate"\n                                        [isError]="validationResult.isError(groupCol.id+i)" [maxLength]="groupCol.maxLength"\n                                        [(nxValue)]="data[col.id][i][groupCol.id]"\n                                        (nxValueChange)="onChange(groupCol.id,$event,col.id,i)">\n                                      </app-ui-form-input>\n                                      <app-ui-form-error-msg *ngIf="validationResult.getErrorMsg(groupCol.id+i)">\n                                        {{validationResult.getErrorMsg(groupCol.id+i) |translate }}\n                                      </app-ui-form-error-msg>\n                                    </ng-container>\n                                    <ng-container *ngIf="groupCol.type==\'Date\'">\n                                      <app-ui-form-date [title]="groupCol.name |translate"\n                                        [(nxValue)]="data[col.id][i][groupCol.id]"\n                                        (nxValueChange)="onChange(groupCol.id,$event,col.id,i)"></app-ui-form-date>\n                                      <app-ui-form-error-msg *ngIf="validationResult.getErrorMsg(groupCol.id+i)">\n                                        {{validationResult.getErrorMsg(groupCol.id+i) |translate }}\n                                      </app-ui-form-error-msg>\n                                    </ng-container>\n                                  </app-ui-form-layout-col>\n                                  <div *ngIf="!groupCol.inline" class="break-line"></div>\n                                </ng-container>\n                                <ng-container *ngIf="data[col.id].length<col.maxNumber && col.canAdd && isLast">\n                                  <app-ui-form-layout-col [colPC]="12" [colNB]="12" [colPad]="12" [colMobile]="8"\n                                    [translateText]="language.customerAdd | translate" [hasAdd]="true"\n                                    (add)="onGroupAdd(col.id)" [id]="col.id">\n                                  </app-ui-form-layout-col>\n                                </ng-container>\n                              </app-ui-form-layout-row>\n                            </ng-container>\n                            <app-ui-form-layout-row class="first-add-block"\n                              *ngIf="data[col.id].length === 0 && col.canAdd">\n                              <app-ui-form-layout-col [colPC]="12" [colNB]="12" [colPad]="12" [colMobile]="8"\n                                [translateText]="language.customerAdd | translate" [hasAdd]="true" (add)="onGroupAdd(col.id)" [id]="col.id">\n                              </app-ui-form-layout-col>\n                            </app-ui-form-layout-row>\n                          </ng-container>\n                        </app-ui-data-group>\n                      </ng-container>\n                    </app-ui-form-layout-col>\n                  </app-ui-form-layout-row>\n                </ng-container>\n              </app-ui-data-group>\n            </ng-container>\n          </app-ui-form-layout-advanced>\n        </div>\n      </div>\n\n      \x3c!-- btn --\x3e\n      <app-ui-btn-layout>\n        <ng-container *ngFor="let button of footerConfig">\n          <app-ui-btn *ngIf="button.type===\'submit\'||button.type===\'button\'" [name]="button.id"\n            [id]="button.id" Action [action]="\'customerEdit_\'+button.id" (actionClick)="onBtnClick(button.type,button.id)" [isDisable]="data[button.id+\'Btn\'].disable">\n            <ng-container TextType="cust">{{button.name |translate }}</ng-container>\n          </app-ui-btn>\n        </ng-container>\n      </app-ui-btn-layout>\n      \x3c!-- end of btn --\x3e\n\n\n\n    </div>\n\n  </div>\n</app-ui-inner-page>\n',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.profile-img-block img{border-radius:50%;display:inline-block;text-align:center;margin:0 auto;width:60px}.profile-img-block .active-img,.profile-img-block.active .normal-img{display:none}.profile-img-block.active .active-img{display:block}.layout-block{padding-top:10px;box-shadow:0 2px 4px 0 rgba(0,0,0,.19);background-color:#fff}.layout-block .layout-style-single{width:100%;margin:0 auto;text-align:left;max-width:418px}@media (min-width:1200px){.layout-block .layout-style-single{max-width:60%}}@media (max-width:767px){.layout-block .layout-style-single{box-sizing:border-box;padding-left:20px;padding-right:20px}.customer-edit-block ::ng-deep .first-add-block [class*=gas-col-]{margin-bottom:0}.customer-edit-block ::ng-deep .first-add-block.gas-row-block{top:-40px;margin-top:0;margin-bottom:15px;position:relative}.customer-edit-block ::ng-deep .first-add-block.gas-row-block .col-content.style-has-add{position:absolute;top:0;left:calc(1.25rem + 10px);max-width:150px}}@media (max-width:374px){.layout-block .layout-style-single{padding-left:10px;padding-right:10px}}.profile-img-block{text-align:center;padding-bottom:10px;padding-top:20px}@media screen and (min-width:1025px){.profile-img-block img{width:6vw}}.tag-block{display:flex}.break-line{display:block;width:100%}.page-cust-info ::ng-deep app-ui-form-radio-tag{width:30%}.page-cust-info ::ng-deep app-ui-form-radio-tag .tag-block .tag-content{font-weight:700}.page-cust-info ::ng-deep app-ui-form-radio-tag+app-ui-form-radio-tag{margin-left:5%}:host ::ng-deep app-ui-btn-layout{position:relative;bottom:-24px}:host ::ng-deep app-ui-btn-layout .btn-block{margin:0}.customer-edit-block ::ng-deep .form-group-block{margin-top:-15px}.customer-edit-block ::ng-deep .first-add-block .col-content.style-has-add{margin-top:0}.customer-edit-block ::ng-deep [class*=gas-col-].style-col-group{margin-bottom:0}"]}]}],t.ctorParameters=function(){return[{type:Z},{type:h.ChangeDetectorRef},{type:h.ElementRef},{type:j.AppRouter},{type:j.TranslateService},{type:ot},{type:j.ProfileCodeService},{type:j.DefaultMetaParser},{type:j.APIExecutor},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[I]}]},{type:nt},{type:j.MetaService},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[M]}]}]},t.propDecorators={sendContentHeight:[{type:h.Output}],content:[{type:h.ViewChild,args:["inpageMain"]}]},t}(j.FormMetaComponent),rt=function(r){function t(t,e,n,i,o){var a=r.call(this,t,e,n,i)||this;return a.metaService=t,a.customMetaController=o,a._criteria=new W,a.doneCriteria=new h.EventEmitter,a.language=new j.Language,a.unsubscribe$=new f.Subject,a}return y(t,r),Object.defineProperty(t.prototype,"criteria",{get:function(){return this._criteria},set:function(t){var e=this;console.log("set criteria:",t),console.log("PresetJson:",t.toMetaJSON()),this._data=this.convertCriteriaToObject(t),this.waitUntilMetaLoaded().then(function(){console.log("this.metaConfig:",e.metaConfig),e.onDataUpdated()})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnConfig",{get:function(){return this.metaConfig.Columns},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"footerConfig",{get:function(){return this.metaConfig.Footer},enumerable:!0,configurable:!0}),t.prototype.getMetaParams=function(){return null},t.prototype.ngOnInit=function(){var t=this;r.prototype.ngOnInit.call(this),this.clear&&this.clear.pipe(d.takeUntil(this.unsubscribe$)).subscribe(function(){t.clearCriteria()}),this.save&&this.save.pipe(d.takeUntil(this.unsubscribe$)).subscribe(function(){t.saveCriteria()})},t.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.btnClick=function(t,e){this.customMetaController&&this.customMetaController.btnClick(t,e,this._data)},t.prototype.onValidateAll=function(){return!this.customMetaController||this.customMetaController.onValidateAll(this._data,this.validationResult)},t.prototype.onValueChange=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=-1),this.customMetaController?this.customMetaController.onValueChange(t,e,n,i,this._data,this.validationResult):Array.isArray(this._data[t])?(-1<this._data[t].indexOf(e)?this._data[t]=this._data[t].filter(function(t){return t!==e}):this._data[t]=D(this._data[t],[e]),this._data.AsPreset=!1):this._data[t]=e,console.log("this.Data:",this._data)},t.prototype.getMetaID=function(){return"customerFilter"},t.prototype.onDataUpdated=function(){r.prototype.onDataUpdated.call(this),this.fillDefaultVal(),console.log("Filter Data Updated:",this._data),this.customMetaController&&this.customMetaController.onDataUpdated(this._data)},t.prototype.getCheckboxValue=function(t,e){return this._data[t]&&-1<this._data[t].indexOf(e)},t.prototype.fillDefaultVal=function(){this._data=Object.assign(this.getDefaultData(),this._data)},t.prototype.getDefaultData=function(){var t=this.metaConfig.Columns.map(function(t){return t.id}).reduce(function(t,e){return t[e]=[],t},{}),e=this.metaConfig.Footer.filter(function(t){return"Checkbox"===t.type}).map(function(t){return t.id}).reduce(function(t,e){return t[e]=!1,t},{});return Object.assign(t,e)},t.prototype.clearCriteria=function(){this._data=Object.assign(this._data,this.getDefaultData())},t.prototype.saveCriteria=function(){this.doneCriteria.emit(this.convertToCriteria())},t.prototype.convertCriteriaToObject=function(t){return Object.assign({},t.toMetaJSON())},t.prototype.convertToCriteria=function(){var e=this,n=new W;return this.metaConfig.Columns.map(function(t){return t.id}).forEach(function(t){0<e._data[t].length&&n.addCriteriaCols(t,e._data[t])}),this.metaConfig.Footer.map(function(t){return t.id}).forEach(function(t){n.setOption(t,e._data[t])}),n},t.decorators=[{type:h.Component,args:[{selector:"app-customer-filter",template:'\x3c!-- popu customer filter content --\x3e\n<div *ngIf="isMetaLoaded()" class="layout-cp-all ui-filter-block">\n  \x3c!-- chekboxes --\x3e\n  <div *ngFor="let col of columnConfig" class="data-filter-item">\n    \x3c!-- title --\x3e\n    <div class="filter-title-block">\n      <h3>{{col.name |translate }}</h3>\n    </div>\n    \x3c!-- end of title --\x3e\n    \x3c!-- checkbox --\x3e\n    <app-ui-collapse-group [translateMore]="language.moreOption | translate">\n      <ng-container textType="originContent">\n        <ng-container *ngFor="let option of data[col.id+\'Option\']; index as j">\n          <app-ui-form-checkbox2 [nxValue]="getCheckboxValue(col.id,option.id)"\n            (nxValueChange)="onChange(col.id,option.id)" [isDisable]="false">\n            <ng-container checkboxText="style1">{{option.name}}</ng-container>\n          </app-ui-form-checkbox2>\n        </ng-container>\n      </ng-container>\n    </app-ui-collapse-group>\n    \x3c!-- end of checkbox --\x3e\n  </div>\n\n  \x3c!-- end of chekboxes --\x3e\n  \x3c!-- setting block --\x3e\n  <div class="setting-block">\n    <ng-container *ngFor="let col of footerConfig">\n      <app-ui-form-checkbox *ngIf="col.type===\'Checkbox\'" [nxValue]="data[col.id]"\n        (nxValueChange)="onValueChange(col.id,$event)" [isDisable]="false">\n        <ng-container checkboxText="style2">{{col.name |translate }}</ng-container>\n      </app-ui-form-checkbox>\n    </ng-container>\n  </div>\n  \x3c!-- end of setting block --\x3e\n</div>\n\x3c!-- end of popup customer filter content --\x3e\n',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}:host{display:inline-block;width:100%;height:100%}.ui-filter-block{display:inline-block;width:100%;height:100%}.ui-filter-block .filter-title-block h3{font-size:1rem;font-weight:700;line-height:28px;padding-bottom:5px}.ui-filter-block .data-filter-item{margin-bottom:30px}.setting-block{display:block;width:100%;padding-bottom:30px}"]}]}],t.ctorParameters=function(){return[{type:j.MetaService},{type:j.ProfileCodeService},{type:j.DefaultMetaParser},{type:j.InputExecutor},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[E]}]}]},t.propDecorators={clear:[{type:h.Input}],save:[{type:h.Input}],open:[{type:h.Input}],criteria:[{type:h.Input}],doneCriteria:[{type:h.Output}]},t}(j.FormMetaComponent),st=function(){function t(t){this.showRule=t,this.importContractMap=new Map,this.importCustomer=new h.EventEmitter,this.language=new j.Language}return t.prototype.ngOnInit=function(){},t.prototype.doImport=function(){var n=new Array;this.importContractMap.forEach(function(t,e){t.getItems.forEach(function(t){console.debug(t),t.isCheck&&n.push(t)})}),this.importCustomer.emit(n)},t.prototype.toDisplayName=function(t,e){return this.showRule?this.showRule.convertName(t,e):e+" "+t},t.decorators=[{type:h.Component,args:[{selector:"app-customer-import",template:' \x3c!-- data --\x3e\n <ng-container *ngIf="importContractMap">\n   <ng-container *ngFor="let group of importContractMap | keyvalue">\n     <ng-container *ngIf="group.value.isShow">\n       <app-ui-list-data2>\n         <ng-container textType="title">{{group.key}}</ng-container>\n         \x3c!-- data --\x3e\n         <ng-container textType="data">\n           <ng-container *ngFor="let item of group.value.getItems">\n             <ng-container *ngIf="item.isShow">\n               <app-ui-form-checkbox3 [isDisable]="false" [(nxValue)]="item.isCheck" (onClick)="doImport()">\n                 <ng-container checkboxText="style3">{{toDisplayName(item.FirstName,item.LastName)}}</ng-container>\n               </app-ui-form-checkbox3>\n             </ng-container>\n           </ng-container>\n         </ng-container>\n         \x3c!-- end of data --\x3e\n       </app-ui-list-data2>\n     </ng-container>\n   </ng-container>\n </ng-container>\n \x3c!-- end of data --\x3e',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}"]}]}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[j.showRuleToken]}]}]},t.propDecorators={importContractMap:[{type:h.Input}],importCustomer:[{type:h.Output}]},t}(),lt=function(){function t(t,e){this.elementRef=t,this.customerUtils=e,this.loadingFinish=!0,this.refreshFinish=!0,this.customerClick=new h.EventEmitter,this.customerLoad=new h.EventEmitter,this.customerRefresh=new h.EventEmitter,this._customerList=[],this.language=new j.Language}return Object.defineProperty(t.prototype,"customerList",{get:function(){return this._customerList},set:function(t){this._customerList=t,this.loadingFinish=!0,this.refreshFinish=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filterType",{get:function(){return this._filterType},set:function(t){this._filterType=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onClickCustomerID",{get:function(){return this._onClickCustomerID},set:function(t){this._onClickCustomerID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDefaultData",{get:function(){return 0==this.customerList.length&&j.StringUtils.isNotEmpty(this.filterType)&&"NONE"==this.filterType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSearchNoData",{get:function(){return 0==this.customerList.length&&j.StringUtils.isNotEmpty(this.filterType)&&"SEARCH"==this.filterType},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){},t.prototype.trackByClientID=function(t,e){return e.clientID},t.prototype.closeSlidingItems=function(){return b(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return console.debug("list closeSlidingItems"),null==(e=this.elementRef.nativeElement.querySelector("ion-item-sliding"))?[3,3]:(console.debug("item",e),[4,e.close()]);case 1:return t.sent(),[4,e.closeOpened()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.onClickCustomer=function(e){var t=this;this._onClickCustomerID=e,setTimeout(function(){t.closeSlidingItems()},300);var n=this.customerList.filter(function(t){return t.clientID==e});this.customerClick.emit(n[0])},t.prototype.loadCustomer=function(t){var e=this;console.log("lazy load customer:",t),setTimeout(function(){e.customerLoad.emit()},800)},t.prototype.refreshCustomer=function(){var t=this;setTimeout(function(){t.customerRefresh.emit()},800)},t.prototype.convertNameToShow=function(t){return this.customerUtils.convertNameToShow(t.firstName,t.lastName)},t.decorators=[{type:h.Component,args:[{selector:"app-customer-list",template:'<div class="customer-list-block ui-list-data">\n    \x3c!-- CustomerList has data--\x3e\n    <app-ui-infinite-scroll [syncFunction]="[\'CUSTOMER\']" (loadingCallback)="loadCustomer($event)" (refreshCallback)="refreshCustomer()"\n        [(loadingFinish)]="loadingFinish" [(refreshFinish)]="refreshFinish" [lazyLoading]="true" [translateText]="language.loading | translate">\n        \n        <ul class="list-data-block stop-scroll-block">\n            <ng-container *ngIf="customerList && customerList.length != 0 ; else noCustomerData">\n    \n            <li *ngFor=" let customer of customerList; let i = index" Action [action]="\'customerListClickCustomer_\'+customer.clientID" (actionClick)="onClickCustomer(customer.clientID)"  class="list-item-block" [ngClass]= "[(customer.clientID == onClickCustomerID ? \' active\':\'\'), (customer.isHighlight ? \' highlight\':\'\')]">\n                <div class="title-profile-block">\n                    <div class="title-block">\n                        <div class="like-block">\n                            <app-ui-btn-like-add [isLike]="customer.isFollow"></app-ui-btn-like-add>\n                        </div>\n                        <div class="title-text">\n                            {{convertNameToShow(customer)}}\n                        </div>\n                        <app-ui-form-radio-tag [hidden]="!customer.tag" class="tag-item" [checked]="true" [disabled]="true" [ngClass]="customer.tag">{{customer.tag | translate}}</app-ui-form-radio-tag>\n                    </div>\n                    <div class="profile-block">\n                        <div class="img-profile-block">\n                            <ng-container *ngIf="customer.isOtherSource; then otherSource else appSource"></ng-container>\n\n                            \x3c!-- datasource from Opus--\x3e\n                            <ng-template #otherSource>\n                                <img src="assets/img/icon-customer-profile-sm.svg">\n                            </ng-template>\n\n                            \x3c!-- datasource from APP--\x3e\n                            <ng-template #appSource>\n                                <img src="assets/img/icon-customer-profile-sm-active.svg">\n                            </ng-template>\n                        </div>\n                    </div>\n                </div>\n                <div class="content-block">\n                    <app-ui-progress [value]="customer.complementPercent" [theme]="\'sub\'" [isShowValue]="true">{{language.customerInformation |translate }}</app-ui-progress>\n                </div>\n            </li>\n        </ng-container>\n        </ul>\n    </app-ui-infinite-scroll>\n\n    <ng-template #noCustomerData>\n        \x3c!-- Customer no data without search--\x3e\n        <ng-container *ngIf="isDefaultData ; else customerSearchNoData">\n            <div class="skelton-layout stop-scroll-block">\n                <div class="theme-loading">\n                    <div class="text-desc">\n                        <span class="text">{{language.click |translate }}\n                        <span class="icon-img"><img src="assets/img/icon-add-grey.svg"></span>\n                        <span class="icon-img"><img src="assets/img/icon-import-grey.svg"></span>\n                        {{language.noEdit |translate }}</span>\n                    </div>\n                    <div class="loading-img">\n                        <div class="skelton-data-block">\n                            <div class="skelton-text wd-short align-right "></div>\n                            <div class="skelton-text wd-long "></div>\n                            <div class="skelton-row align-side">\n                                <div class="skelton-text wd-md "></div>\n                                <div class="skelton-text wd-short "></div>\n                            </div>\n                            <div class="skelton-text wd-long "></div>\n                        </div>\n                        <img src="assets/img/loading-customer-list.svg">\n                    </div>\n                </div>\n            </div>\n        </ng-container>\n\n        \x3c!-- Customer no data after searching--\x3e\n        <ng-template #customerSearchNoData>\n            <ng-container *ngIf="showSearchNoData ;  else customerFilterNoData">\n                <div class="status-empty search-empty">\n                    <div class="empty-block">\n                        <div class="img-block">\n                            <img src="assets/img/empty-img-search.svg">\n                        </div>\n                        <div class="text-block">\n                            <p>{{language.noSearch |translate }}</p>\n                        </div>\n                    </div>\n                </div>\n            </ng-container>\n        </ng-template>\n\n        \x3c!-- Customer no data after filtering--\x3e\n        <ng-template #customerFilterNoData>\n                <div class="status-empty search-empty">\n                    <div class="empty-block">\n                        <div class="img-block">\n                            <img src="assets/img/icon-filter-no-data.svg">\n                        </div>\n                        <div class="text-block">\n                          <p>{{language.noFilter |translate }}</p>\n                        </div>\n                    </div>\n                  </div>\n        </ng-template>\n            \n    </ng-template>\n\n  </div>\n',styles:[".skelton-layout{margin:0}.skelton-row{display:flex}.skelton-row.align-side{justify-content:space-between}.align-right{margin:0 0 15px auto}.align-center{margin:15px auto}.skeleton-round{border-radius:50%;background-color:#ececec;max-width:100%;max-height:100%;width:100%;height:100%}.skelton-square{display:inline-block;width:30px;height:30px}.skelton-text{min-height:1rem;max-width:100%;width:100%;background-color:#ececec;display:block;margin-bottom:15px}.skelton-line{display:inline-block;max-width:100%;width:100%;background-color:#ececec;height:1px}.skelton-img-text .skelton-square{margin-bottom:10px}::ng-deep ion-skeleton-text{background-color:#ececec}::ng-deep ion-skeleton-text span{opacity:1;background-color:#ececec}.skelton-animate{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-name:placeHolderShimmer;animation-name:placeHolderShimmer;-webkit-animation-timing-function:linear;animation-timing-function:linear;background:rgba(194,194,194,.3);background:linear-gradient(to right,rgba(194,194,194,.3) 8%,rgba(194,194,194,.2) 18%,rgba(194,194,194,.3) 33%);background-size:800px 100px;position:relative}@-webkit-keyframes placeHolderShimmer{0%{background-position:-268px 0}100%{background-position:268px 0}}@keyframes placeHolderShimmer{0%{background-position:-268px 0}100%{background-position:268px 0}}.ui-list-data .skelton-layout{margin-top:30px}.ui-list-data .theme-loading{text-align:center}.ui-list-data .theme-loading .text-desc{padding-left:10%;padding-right:10%;text-align:center;display:inline-block;vertical-align:middle;margin-bottom:30px}.ui-list-data .theme-loading .text-desc .text{color:#414141;font-size:.875rem;line-height:28px;display:inline-block;vertical-align:middle}.ui-list-data .theme-loading .text-desc .text .icon-img{display:inline-block;vertical-align:middle;line-height:normal}.ui-list-data .theme-loading .loading-img{text-align:right;position:relative}.ui-list-data .theme-loading .loading-img .skelton-data-block{padding-left:10%;padding-right:10%;box-sizing:border-box;position:absolute;top:30px;width:100%}.ui-list-data .theme-loading .loading-img .skelton-text{margin-bottom:25px}.ui-list-data .theme-loading .loading-img .wd-short{max-width:30%}.ui-list-data .theme-loading .loading-img .wd-md{max-width:54%}.ui-list-data .theme-loading .loading-img .wd-long{max-width:70%}.ui-list-data .theme-loading .loading-img img{max-width:300px;width:100%}@media (max-width:1023px){.ui-list-data .theme-loading img{bottom:400px;top:auto}}@media (max-width:767px){.ui-list-data .theme-loading{height:100%;position:relative}.ui-list-data .theme-loading .text-desc{margin-bottom:30px}.ui-list-data .theme-loading .text-desc .text{max-width:185px;width:100%}.ui-list-data .theme-loading .loading-img{margin-top:0;height:100%;position:absolute;right:0;bottom:0;max-width:153px;width:100%}.ui-list-data .theme-loading .loading-img .wd-short{max-width:22%}.ui-list-data .theme-loading .loading-img .skelton-data-block{width:100%;max-width:253px;right:10px;top:60px;position:absolute}.ui-list-data .theme-loading .loading-img img{max-width:153px;margin-top:0;bottom:0;top:auto;position:absolute;right:0}}@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.status-empty.search-empty{padding-left:13%;padding-right:13%;box-sizing:border-box;text-align:center;display:flex;height:100%;min-height:calc(90vh - 59px - 56px - 24px);justify-content:center;align-items:center}.status-empty.search-empty .empty-block{text-align:center;margin:0 auto}.status-empty.search-empty .img-block{max-width:50px;width:100%;margin:0 auto}.status-empty.search-empty .text-block p{padding:0;font-size:1.125rem;line-height:28px}@media (max-width:767px){.status-empty.search-empty.search-empty{max-width:182px;width:100%;margin:0 auto;padding-left:0;padding-right:0}}.customer-list-block.ui-list-data{border-top:1px solid #c2c2c2;background-color:#fff}.customer-list-block.ui-list-data .title-sm-block{background-color:#ececec;display:inline-block;width:100%;padding:5px 15px 5px 6px}.customer-list-block.ui-list-data .title-sm-block p{padding:0;margin:0}.customer-list-block.ui-list-data .list-data-block{list-style-type:none;padding:0;border-bottom:1px solid #c2c2c2}.customer-list-block.ui-list-data .list-data-block .list-item-block{padding:12px 15px 12px 6px;box-sizing:border-box;position:relative}.customer-list-block.ui-list-data .list-data-block .list-item-block.highlight{background-color:#f5f5f5}@media (min-width:1024px){.customer-list-block.ui-list-data .list-data-block .list-item-block.active{background-color:#f1f9fa}}.customer-list-block.ui-list-data .list-data-block .list-item-block+.list-item-block{border-top:1px solid #c2c2c2}@media screen and (max-width:767px){.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block{display:flex;flex-wrap:nowrap;justify-content:space-between;align-items:center;width:100%;margin-bottom:5px}.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block .title-block .title-text{max-width:calc(100% - 27px)}}.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block .title-block{display:flex;justify-content:flex-start;align-items:center;margin-bottom:10px}.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block .title-block .title-text{font-size:.875rem;padding:0 3px;font-weight:700;display:inline-block;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block .profile-block{text-align:right}.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block .profile-block .img-profile-block img{vertical-align:middle}@media screen and (max-width:767px){.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block .title-block{margin-bottom:0;max-width:calc(100% - 14px)}.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block .profile-block{flex:0 0 14px}}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep .progress-whole-block .progress-value-block .progress-block{max-width:100%}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep app-ui-btn-like-add{pointer-events:none;display:inline-block;max-width:12px;max-height:12px;width:100%;vertical-align:middle}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep app-ui-btn-like-add .btn-like-add{display:inline-block;width:12px}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep app-ui-btn-like-add .btn-like-add img{max-width:100%;width:12px}@media screen and (min-width:1025px){.customer-list-block.ui-list-data .list-data-block .list-item-block .title-profile-block .profile-block .img-profile-block img{width:1.4vw}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep app-ui-btn-like-add{max-width:1.2vw;max-height:1.2vw}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep app-ui-btn-like-add .btn-like-add{width:1.2vw}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep app-ui-btn-like-add .btn-like-add img{width:1.2vw}}.customer-list-block.ui-list-data .list-data-block .list-item-block .content-block{padding-left:12px}.customer-list-block.ui-list-data .list-data-block ::ng-deep .tag-item .ul-tag-block{position:relative;top:2px}.customer-list-block.ui-list-data .list-data-block ::ng-deep .tag-item ::ng-deep .tag-block{height:14px;padding-top:0;padding-bottom:0}.customer-list-block.ui-list-data ::ng-deep .progress-whole-block{padding-bottom:0}.customer-list-block.ui-list-data ::ng-deep .progress-text{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}@media (min-width:769px){.customer-list-block.ui-list-data ::ng-deep .scroll-content{height:calc(100vh - (40px*2) - 140px)}}@media (max-width:767px){.customer-list-block.ui-list-data .tag-item{min-width:40px;padding-right:35px}.customer-list-block.ui-list-data .list-data-block .list-item-block{display:flex;flex-wrap:wrap}.customer-list-block.ui-list-data .list-data-block .list-item-block .title-block{justify-content:flex-start;max-width:100%;width:100%;padding-right:0;box-sizing:border-box}.customer-list-block.ui-list-data .list-data-block .list-item-block .profile-block{max-width:20px;width:100%}.customer-list-block.ui-list-data .list-data-block .list-item-block .profile-block .img-profile-block{max-width:100%;align-items:center}.customer-list-block.ui-list-data .list-data-block .list-item-block .content-block{width:100%}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep .progress-whole-block{display:flex;width:100%;justify-content:flex-end;padding-bottom:0!important}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep .progress-value-block{padding-left:10px}.customer-list-block.ui-list-data .list-data-block .list-item-block ::ng-deep .progress-value-block .progress-block{display:none}}:host ::ng-deep app-ui-infinite-scroll .infiniti-scroll{max-height:calc(100vh - 80px - 63px - 56px - 10px)}::ng-deep html:not(.font-size_sm) .customer-list-block.ui-list-data .list-data-block .tag-item .tag-block{height:15px}@media (max-width:768px){.customer-list-block.ui-list-data .list-data-block .tag-item{padding-right:0;margin-right:25px;width:52px}.customer-list-block.ui-list-data .skelton-layout{height:calc(100vh - 55px - 55px - 134px);overflow-y:auto}:host ::ng-deep app-ui-infinite-scroll{background-color:#fff}:host ::ng-deep app-ui-infinite-scroll .infiniti-scroll{max-height:calc(100vh - 55px - 55px - 134px);height:100%}@supports (top:constant(safe-area-inset-top)){:host ::ng-deep app-ui-infinite-scroll .infiniti-scroll{max-height:calc(100vh - constant(safe-area-inset-top) - constant(safe-area-inset-bottom) - 55px - 55px - 134px)}}@supports (top:env(safe-area-inset-top)){:host ::ng-deep app-ui-infinite-scroll .infiniti-scroll{max-height:calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 55px - 55px - 134px)}}}"]}]}],t.ctorParameters=function(){return[{type:h.ElementRef},{type:Z}]},t.propDecorators={customerClick:[{type:h.Output}],customerLoad:[{type:h.Output}],customerRefresh:[{type:h.Output}],customerList:[{type:h.Input}],filterType:[{type:h.Input}],onClickCustomerID:[{type:h.Input}]},t}(),ct=function(){function t(t){this._isShow=!0,this._items=new Array,this._groupName=t}return t.prototype.addItem=function(t){this._items.push(t)},Object.defineProperty(t.prototype,"getItems",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupName",{get:function(){return this._groupName},set:function(t){this._groupName=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isShow",{get:function(){return this._isShow},set:function(t){this._isShow=t},enumerable:!0,configurable:!0}),t}(),ut=function(){function t(t){this.customImportDisplay=t}return t.prototype.convert=function(t){return this.customImportDisplay?this.customImportDisplay.convert(t):(j.StringUtils.isEmpty(t.LastName)&&(t.LastName=t.FirstName,t.FirstName=""),t)},t.decorators=[{type:h.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[A]}]}]},t.ngInjectableDef=h.defineInjectable({factory:function(){return new t(h.inject(A,8))},token:t,providedIn:"root"}),t}(),pt=function(){function t(t,e,n,i,o,a,r,s,l,c,u,p,d,m,g,h){this.customerService=t,this.calendarService=e,this.translateService=n,this.deviceService=i,this.dateUtils=o,this.profileCodeService=a,this.customerUtils=r,this.router=s,this.customerStoreService=l,this.customerImportDisplay=c,this.notificationMgr=u,this.changeDetector=p,this.APP_CONFIG=d,this.showRule=m,this.customerShowRule=g,this.addProgressPoint=h,this.viewTypeIndex=2,this.viewDate=new Date,this.weekStartsOn=1,this.isShowDetailScroll=!0,this.isShow=!1,this.showCustomerList=!0,this.isExpandDetail=!1,this.isRefreshDetail=!1,this.isSaveClick=!1,this.language=new j.Language,this.isOpen=!1,this.classSearch="",this.isDisplayImportSavePopup=!1,this.isDisplaySavePopup=!1,this.isDisplayDelCustomerPopup=!1,this.isDisplayConfirmAlertPopup=!1,this.isDisplayInfoAlertPopup=!1,this.isDisplayUpdateRemind=!1,this.isDisplayDeleteRemind=!1,this.isPopupImport=!1,this.isPopupFilter=!1,this.isExpandEdit=!1,this.isPopupCallPhone=!1,this.isPopupNoteDetail=!1,this.isPopupEditNote=!1,this.isPopupDeleteNote=!1,this.isPopupConfirmDisable=!0,this.isDisplayDeletePopup=!1,this.isCalendarEditMetaDataDone=!1,this.alertOverTimeList=new Array,this.alertAutoDeleteCustomer=new Array,this.isLoadingFinishContent=!1,this.isRefreshFinishContent=!0,this.isLazyLoading=!0,this.customerContactDetail=null,this.customerContactList=[],this.contactListPageInfo=new j.PageInfo,this.viewDateCalendarEventList=[],this.customerList=new Array,this.customerListPageInfo=new j.PageInfo,this._filterCriteria=new W,this.filterType="NONE",this.optionMap=new Map,this.translateMap=new Map,this.dayTypesList=["Cross_Day","All_Day"],this.noSchedule="No_Schedule",this.activityTypeList=[],this.alertTypeList=[],this.importContractMap=new Map,this.mobileResultSize=0,this.importData=!1,this.importContactList=[],this.importSearchKeyword="",this.isLoadCriteria=!1,this.isClearCriteria=!1,this._onImportResult=!1,this.currentEditNote=null,this.isRefreshContactList=!1,this.loadContactList=!1,this.classBarMove="",this.customerDetail=null,this.emptyCustomer={ClientID:""},this.currentCustomer=this.emptyCustomer,this.confirmAction=null,this.customerState=it.FIRST,this.pre_criteria=new W,this.unsubscribe$=new f.Subject,this.clearSubject=new f.Subject,this.saveFilterSubject=new f.Subject,this.contactSaveSubject=new f.Subject}return Object.defineProperty(t.prototype,"customerClientID",{get:function(){return this.customerDetail&&this.customerDetail.ClientID?this.customerDetail.ClientID:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filterCriteria",{get:function(){return this._filterCriteria},set:function(t){this._filterCriteria=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"needConfirmPopup",{get:function(){var t=this.APP_CONFIG.ENV;return this.APP_CONFIG&&!!this.APP_CONFIG[t].CUSTOMER_ADD_ANNOUNCE},enumerable:!0,configurable:!0}),t.prototype.ngOnDestroy=function(){console.log("customer ngOnDestroy!"),this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.ngOnInit=function(){var e=this;console.log("customer ngOninit!"),this.contactListPageInfo.pageSize=5,this.activityTypeList=this.profileCodeService.getCodeArray("Calendar_Type"),this.alertTypeList=this.profileCodeService.getCodeArray("Calendar_RemindTime"),this.optionMap.set("Calendar_Type",this.activityTypeList),this.optionMap.set("Calendar_RemindTime",this.alertTypeList),this.dayTypesList.forEach(function(t){e.translateMap.set(t,e.translateService.translate(t))}),this.translateMap.set(this.noSchedule,this.translateService.translate(this.noSchedule)),this.customerStoreService.getCriteria().pipe(d.takeUntil(this.unsubscribe$)).subscribe(function(t){e.pre_criteria=t}),this.customerStoreService.getCurrentCustomerDetail().pipe(d.takeUntil(this.unsubscribe$)).subscribe(function(t){console.log("customer onsubscribe currentCustomerDetail:",t),e.currentCustomer=t}),this.customerStoreService.getCustomerList().pipe(d.takeUntil(this.unsubscribe$)).subscribe(function(t){e.pre_customerList=t}),this.customerStoreService.getState().pipe(d.takeUntil(this.unsubscribe$)).subscribe(function(o){return b(e,void 0,void 0,function(){var e,n,i=this;return C(this,function(t){switch(t.label){case 0:return console.log("main state: ",o),o!=it.EDIT_SAVED||this.customerState==it.EDIT_SAVED?[3,4]:(console.log("state == CUSTOMER_STATE.EDIT_SAVED"),console.log("currentCustomer: ",this.currentCustomer),this.isDisplaySavePopup=!0,this.customerList=this.pre_customerList,this.filterCriteria=this.pre_criteria,e=this.pre_criteria.hasCriteria(),n=!1,e?[4,this.customerService.checkInFilterCriteria(this.currentCustomer.ClientID,this.pre_criteria).toPromise()]:[3,2]);case 1:n=t.sent(),t.label=2;case 2:return this.customerList.forEach(function(t){t.clientID==i.currentCustomer.ClientID&&(t.firstName=i.currentCustomer.FirstName,t.lastName=i.currentCustomer.LastName,t.tag=i.currentCustomer.Possibility,t.complementPercent=i.currentCustomer.Completeness,e&&(t.isHighLight=!n))}),this.customerList=D(this.sortCustomerList(this.customerList)),e&&this.customerStoreService.setCustomerList(this.customerList),[4,this.onGetCustomerDetailByID(this.currentCustomer.ClientID)];case 3:return t.sent(),this.refreshContactNote(!1),[3,10];case 4:return o!=it.EDIT||this.customerState==it.EDIT||this.customerState!=it.FIRST?[3,7]:(this.customerList=this.pre_customerList,this.filterCriteria=this.pre_criteria,j.StringUtils.isEmpty(this.currentCustomer.ClientID)?[3,6]:[4,this.onGetCustomerDetailByID(this.currentCustomer.ClientID)]);case 5:t.sent(),t.label=6;case 6:return this.refreshCustomerList(!1),[3,10];case 7:return this.customerState!=it.FIRST||o!=it.DISPLAY?[3,9]:(console.log("this.customerState == CUSTOMER_STATE.FIRST && state == CUSTOMER_STATE.DISPLAY"),[4,this.loadPresetCriteria()]);case 8:return t.sent(),this.refreshCustomerList(!1),[3,10];case 9:o==it.ADD_SAVED?(console.log("state == CUSTOMER_STATE.ADD_SAVED",this.currentCustomer),this.isDisplaySavePopup=!0,this.filterCriteria=this.pre_criteria,this.refreshCustomerList(!1,this.currentCustomer.ClientID)):o==it.IMPORT&&this.importPopup(),t.label=10;case 10:return this.customerState!=o&&(this.customerState=o,this.customerStoreService.setState(it.DISPLAY)),[2]}})})}),this.customerStoreService.setState(it.DISPLAY),this.refreshContactNote(!1),this.notificationMgr.showCategoryMessage("Customer")},t.prototype.refreshCustomerList=function(o,a){return void 0===a&&(a=""),b(this,void 0,void 0,function(){var e,n,i;return C(this,function(t){switch(t.label){case 0:return console.debug("refreshCustomerList append",o,a),console.debug(this.filterCriteria),console.debug(this.customerListPageInfo),o||this.customerListPageInfo.resetPage(),[4,this.customerService.getCustomerList(this.filterCriteria,this.customerListPageInfo).pipe(d.take(1)).toPromise()];case 1:return e=t.sent(),console.log("data in criteria: ",e),this.customerList=o?D(this.customerList,e):D(e),this.filterCriteria.hasCriteria()?this.filterType=j.StringUtils.isNotEmpty(this.filterCriteria.keyword)?"SEARCH":"FILTER":this.filterType="NONE",console.log("refreshCustomerList filterType:",this.filterType),this.customerList=D(this.sortCustomerList(this.customerList)),this.customerStoreService.setCustomerList(this.customerList),0<this.customerList.length?(n=this.customerList.filter(function(t){return t.clientID===a}),i=0<n.length?a:this.customerList[0].clientID,[4,this.onGetCustomerDetailByID(i)]):[3,3];case 2:return t.sent(),this.refreshContactNote(!1),[3,4];case 3:this.customerDetail=this.emptyCustomer,this.customerStoreService.setCurrentCustomerDetail(this.customerDetail),t.label=4;case 4:return[2]}})})},t.prototype.refreshContactNote=function(n){return b(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return this.customerClientID?(n||this.contactListPageInfo.resetPage(),[4,this.customerService.getCustomerContactNote(this.customerDetail.ClientID,this.contactListPageInfo).toPromise()]):[3,2];case 1:e=t.sent(),this.customerContactList=n?this.customerContactList.concat(e):e,console.debug("refreshContactNote success isRefreshContactList status"),t.label=2;case 2:return[2]}})})},t.prototype.sortCustomerList=function(t){return this.customerShowRule?this.customerShowRule.sortCustomerList(t):t.map(function(t){return t.clone()}).sort(function(t,e){var n=j.StringUtils.isEmpty(t.lastName)?"":t.lastName,i=j.StringUtils.isEmpty(e.lastName)?"":e.lastName;return n.localeCompare(i)})},t.prototype.onGetCustomerContactListByID=function(t){var e=this;this.customerService.getCustomerContactNote(t,this.contactListPageInfo).subscribe(function(t){e.customerContactList=t})},t.prototype.onGetCustomerDetailByID=function(n){return b(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return console.log("onGetCustomerDetailByID clientID:",n),[4,this.customerService.getCustomerDetail(n).toPromise()];case 1:return e=t.sent(),console.log("onGetCustomerDetailByID data:",e),this.customerDetail=e,this.customerStoreService.setCurrentCustomerDetail(e),[2]}})})},t.prototype.toggleSearch=function(){this.isOpen=!this.isOpen,this.classSearch=this.isOpen?" active":"",this.isOpen||(this.filterCriteria.keyword="",this.customerStoreService.setCriteria(this.filterCriteria),this.refreshCustomerList(!1))},t.prototype.searchCustomerName=function(t){console.debug("searchCustomerName",t),this.filterCriteria.keyword=t,this.customerStoreService.setCriteria(this.filterCriteria),this.refreshCustomerList(!1)},t.prototype.trackByFn=function(t,e){return e.name},t.prototype.onChangeCustomer=function(e){return b(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return this.clickItem=e,[4,this.onGetCustomerDetailByID(e.clientID)];case 1:return t.sent(),this.refreshContactNote(!1),this.isShow=!0,[2]}})})},t.prototype.onCustomerLoad=function(){this.customerListPageInfo.nextPage(),this.refreshCustomerList(!0)},t.prototype.onCustomerRefresh=function(){this.refreshCustomerList(!1,this.customerClientID)},t.prototype.deleteCustomer=function(t){this.isDisplayDelCustomerPopup=!0},t.prototype.doDeleteCustomer=function(){return b(this,void 0,void 0,function(){var e,n,i=this;return C(this,function(t){switch(t.label){case 0:return e=this.customerDetail.ClientID,this.customerList=this.customerList.filter(function(t){return t.clientID!=i.customerDetail.ClientID}),0!==this.customerList.length?[3,1]:(this.customerDetail=this.emptyCustomer,this.customerStoreService.setCurrentCustomerDetail(this.customerDetail),[3,3]);case 1:return[4,this.onGetCustomerDetailByID(this.customerList[0].clientID)];case 2:t.sent(),this.refreshContactNote(!1),t.label=3;case 3:return[4,this.customerService.deleteCustomerProfile(e).toPromise()];case 4:return n=t.sent(),console.log("customerService.doDeleteCustomer()",n),n.status&&(this.customerStoreService.setCustomerList(this.customerList),this.isShow=!1,this.isDisplayDeletePopup=!0),[2]}})})},t.prototype.addAppointment=function(t){var e,n=this;e=new Date(m.getYear(this.viewDate),m.getMonth(this.viewDate),m.getDate(this.viewDate),m.getHours(new Date),m.getMinutes(new Date)),e=m.addMinutes(e,5-m.getMinutes(e)%5),e=m.addHours(e,1),this.calendarEventDetail=new U("","",t,"","",null,"N",e,m.addMinutes(e,15),"Y","8",null,"","",null);var i=new Date(m.getYear(this.viewDate),m.getMonth(this.viewDate),m.getDate(this.viewDate),0,0,0);this.calendarService.getCalendarEventList(i,m.subMinutes(m.addDays(this.viewDate,1),1),"").subscribe(function(t){n.viewDateCalendarEventList=t,n.onToggleAppointmentModal(!0)})},t.prototype.onClickAppointmentSave=function(){this.isSaveClick=!0},t.prototype.onToggleAppointmentModal=function(t){t||(this.isCalendarEditMetaDataDone=!1),this.isExpandEdit=t},t.prototype.onSaveCalendarEvent=function(t){var e=this,n=t.type,i=t.data;console.log("calendarEventDetail: ",i),"fail"!==n&&(this.isDisplaySavePopup=!0,this.onToggleAppointmentModal(!1),this.calendarService.getCalendarEventDetail(i.ClientID).subscribe(function(t){e.calendarEventDetail=t})),this.isSaveClick=!1},t.prototype.addCustomer=function(){this.customerStoreService.setCurrentCustomerDetail({}),this.customerStoreService.setState(it.EDIT),this.router.navigate("CustomerEdit")},t.prototype.editCustomer=function(t){var e=this;this.customerStoreService.setState(it.EDIT),this.customerService.getCustomerDetail(t).subscribe(function(t){console.log("editCustomer:",t),console.log("Stringify:",JSON.stringify(t)),e.customerStoreService.setCurrentCustomerDetail(t),setTimeout(function(){document.body.classList.remove("fixed-body-full-page")},200),e.router.navigate("CustomerEdit")})},t.prototype.followChange=function(n){var i=this;this.customerService.updateCustomerFollowStatus(n.clientID,n.isFollow).subscribe(function(t){i.filterCriteria&&i.customerService.checkInFilterCriteria(n.clientID,i.filterCriteria).subscribe(function(e){i.customerList.forEach(function(t){t.clientID==n.clientID&&(t.isHighLight=!e)})}),i.customerList.filter(function(t){return t.clientID==n.clientID}).forEach(function(t){t.isFollow=n.isFollow})})},t.prototype.addNote=function(){console.debug("addNote"),this.currentEditNote={ClientID:"",CustomerClientID:this.customerDetail.ClientID,NoteTime:Date.now(),DisplayDate:this.toNoteTime(new Date)},this.isPopupEditNote=!0},t.prototype.editNote=function(t){console.debug("editNote",t),this.currentEditNote=Object.assign({},t,{CustomerClientID:this.customerDetail.ClientID,NoteTime:Date.now(),DisplayDate:this.toNoteTime(new Date)}),console.log("this.currentEditNote:",this.currentEditNote),this.isPopupEditNote=!0},t.prototype.displayNote=function(t){console.debug("displayNote",t),this.customerContactDetail=t,this.customerContactDetail.Name=this.convertNameToShow(this.customerDetail.FirstName,this.customerDetail.LastName),this.isPopupNoteDetail=!0},t.prototype.deleteNote=function(t){console.debug("deleteNote",t),this.currentEditNote=t,this.isPopupDeleteNote=!0},t.prototype.doDeleteContact=function(){var e=this;this.customerService.deleteCustomerContact(this.currentEditNote.ClientID).subscribe(function(t){console.log("customerService.deleteNote()",t),t.status&&(e.customerContactList=e.customerContactList.filter(function(t){return t.ClientID!=e.currentEditNote.ClientID}),e.currentEditNote=null,e.isDisplayDeletePopup=!0)})},t.prototype.onSaveNote=function(t){this.contactSaveSubject.next()},t.prototype.onSaveNoteFinish=function(t){var e=this;this.isPopupEditNote=!1,this.isDisplaySavePopup=!0,this.isShowDetailScroll=!1,setTimeout(function(){e.isShowDetailScroll=!0,e.refreshContactNote(!1)},200)},t.prototype.doAction=function(t){console.log("doaction: ",t),this.needConfirmPopup?(this.isDisplayConfirmAlertPopup=!0,this.isPopupConfirmDisable=!0,this.confirmAction=t):"add"==t?this.addCustomer():"import"==t&&this["import"]()},t.prototype.confirmPopup=function(){this.isPopupConfirmDisable=!0,this.isDisplayConfirmAlertPopup=!1,this.changeDetector.detectChanges(),"add"===this.confirmAction?this.addCustomer():"import"==this.confirmAction&&this["import"](),this.confirmAction=null},t.prototype.detectScroll=function(t){console.log("in detect scroll===",t),t&&(this.isPopupConfirmDisable=!1)},t.prototype.importPopup=function(){return b(this,void 0,void 0,function(){var e,n,o=this;return C(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.deviceService.searchContactsByName("")];case 1:return e=t.sent(),console.debug("import result ",e),this.importContractMap.clear(),e.forEach(function(t){console.debug(t.LastName),t=o.customerImportDisplay.convert(t);var e=o.convertNameToShow(t.FirstName,t.LastName).trim();if(null!=e&&0<e.length){var n=e.substring(0,1);n=n.toLowerCase(),console.debug("firstWord ="+n);var i=o.importContractMap.get(n);i==undefined&&(i=new ct(n)),i.addItem(t),o.importContractMap.set(n,i)}}),console.debug("importContractMap",this.importContractMap),this.isPopupImport=!0,[3,3];case 2:return n=t.sent(),console.warn("catch error",n),this.notificationMgr.pushNotification(j.NotificationType.ContactPermissionError,null),"iOS"==this.deviceService.getDevicePlatform()&&this.deviceService.grantContactPermission(),[3,3];case 3:return[2]}})})},t.prototype["import"]=function(){this.customerStoreService.setState(it.IMPORT)},t.prototype.displayImportPopup=function(t){this.isPopupImport=t},t.prototype.refreshImport=function(t){this.importSearchKeyword=t;var i=this.importSearchKeyword.toLowerCase();this.importContractMap.forEach(function(n,t){n.isShow=!1,n.getItems.forEach(function(t){var e=t.LastName+t.FirstName;-1===(e=e.toLowerCase()).indexOf(i)?t.isShow=!1:(t.isShow=!0,n.isShow=!0)})})},t.prototype.onCloseImportPopup=function(){this.customerStoreService.setState(it.DISPLAY),this.importSearchKeyword=""},t.prototype.doImport=function(){var e=this;this.showCustomerList=!1,this.customerService.importContact(this.importContactList).subscribe(function(t){e.addProgressPoint&&0<e.importContactList.length&&e.addProgressPoint.addCustomerPoint(e.importContactList.length),e.customerStoreService.setState(it.DISPLAY),JSON.parse(JSON.stringify(t)).status&&(e.customerList=[],e.showCustomerList=!0,e.isPopupImport=!1,e.isDisplayImportSavePopup=!0,e.mobileResultSize=0,e.importSearchKeyword="",e.refreshCustomerList(!1))})},t.prototype.onImportCustomer=function(t){console.debug("importItems",t),this.importContactList=t,this.mobileResultSize=t.length},t.prototype.callCustomer=function(t){var e=this;console.debug("callCustomer = "+t),this.customerService.getCustomerContactTel(t).subscribe(function(t){e.callPhoneTelArray=t,0!=e.callPhoneTelArray.length&&(1==e.callPhoneTelArray.length?e.callPhone(e.callPhoneTelArray[0].tel):e.isPopupCallPhone=!0)})},t.prototype.cancelCallPhone=function(){this.isPopupCallPhone=!this.isPopupCallPhone},t.prototype.callPhone=function(t){var e=this;console.debug("callPhone",t),this.isPopupCallPhone&&(this.isPopupCallPhone=!this.isPopupCallPhone),window.open("tel:"+t,"_system"),setTimeout(function(t){e.addNote()},1e3)},t.prototype.filter=function(){this.isPopupFilter=!0},t.prototype.clearFilter=function(){this.clearSubject.next()},t.prototype.doFilter=function(){this.saveFilterSubject.next()},t.prototype.doneCriteria=function(t){console.debug("doneCriteria",t),this.filterCriteria=t,this.isPopupFilter=!1,this.customerStoreService.setCriteria(t),t.getOption("AsPreset")&&this.customerService.saveFilterCriteria(t).subscribe(function(t){console.debug("doneCriteria saveFilterCriteria",t)}),this.refreshCustomerList(!1)},t.prototype.loadPresetCriteria=function(){var o=this,a=new W;return this.customerService.getFilterCriteriaPreset().toPromise().then(function(t){if(console.debug("getfilterCriteriaPreset",t),t!=undefined){var e=0;for(var n in t){var i=t[n];console.debug("column",n,"arrays",i),a.addCriteriaCols(n,i),e++}0!=e?a.setOption("AsPreset",!0):a.setOption("AsPreset",!1),o.filterCriteria=a}})},t.prototype.cancelDelete=function(){console.log("cancelDelete")},t.prototype.refreshContent=function(){var t=this;setTimeout(function(){t.isRefreshFinishContent=!0},800)},t.prototype.loadContent=function(t){return b(this,void 0,void 0,function(){var e=this;return C(this,function(t){switch(t.label){case 0:return console.log("content loading this.customerList.length: ",this.customerList.length),0<this.customerList.length?(this.contactListPageInfo.nextPage(),[4,this.refreshContactNote(!0)]):[3,2];case 1:return t.sent(),this.isLoadingFinishContent=!0,[3,3];case 2:setTimeout(function(){e.isLoadingFinishContent=!0},0),t.label=3;case 3:return[2]}})})},t.prototype.isShowChange=function(t){this.isShow!==t&&(this.isShow=t)},t.prototype.convertNameToShow=function(t,e){return this.customerUtils.convertNameToShow(t,e)},t.prototype.toNoteTime=function(t){return this.showRule?this.showRule.convertDateAndTime(t):this.dateUtils.toDateString(t,"MM/dd/yyyy HH:mm")},t.prototype.onCalendarEditMetaDataDone=function(){this.isCalendarEditMetaDataDone=!0},t.prototype.filterCriteriaPopupChange=function(t){console.warn("filterCriteriaPopupChange event: ",t),this.isPopupFilter=t,this.isPopupFilter&&(this.filterCriteria=this.filterCriteria.clone())},t.decorators=[{type:h.Component,args:[{selector:"app-customers",template:'<app-ui-main-side-menu [title]="[language.customer | translate]" [isShow]="isShow"\n  (isShowChange)="isShowChange($event)">\n\n  <div class="side-menu-content customer-side" side-menu>\n    \x3c!-- Title Block --\x3e\n    <div class="title-main-block">\n      <app-ui-title-style1>\n        <ng-container textType="titleText">{{language.customerList |translate }}</ng-container>\n      </app-ui-title-style1>\n    </div>\n    \x3c!-- Action Block--\x3e\n    <div class="filter-all-block">\n      <ul class="filter-block" [ngClass]="classSearch ? \' ani-bar-move\': \'\'">\n        <li class="filter-item">\n          <button id="btn_customerShowAddConfirm" Action action="customerShowAddConfirm"\n            (actionClick)="doAction(\'add\')">\n            <img src="assets/img/icon-customer-list-add.svg" alt="">\n          </button>\n        </li>\n        <li class="filter-item">\n          \x3c!-- import --\x3e\n          <button id="btn_customerShowImportConfirm" Action action="customerShowImportConfirm"\n            (actionClick)="doAction(\'import\')">\n            <img src="assets/img/icon-customer-list-import.svg" alt="">\n          </button>\n          \x3c!-- end of import --\x3e\n        </li>\n        \x3c!-- filter item --\x3e\n        <li class="filter-item">\n          <button id="btn_customerFilter" Action action="customerFilter" (actionClick)="filter()">\n            <ng-container *ngIf="filterCriteria.getFilterMap().size != 0">\n              <span class="num-block">\n                <span class="num">{{filterCriteria.getFilterMap().size}}</span>\n              </span>\n            </ng-container>\n            <img src="assets/img/icon-customer-list-filter.svg" alt="">\n          </button>\n        </li>\n        \x3c!-- end of filter item --\x3e\n        <li class="filter-item search-animate-block" [ngClass]="classSearch">\n          <button id="btn_customerSearch" class="btn-search-open" Action action="customerSearch"\n            (actionClick)="toggleSearch()">\n            <img src="assets/img/icon-customer-list-search.svg" alt="">\n          </button>\n          <div class="search-input-block input-block" [ngClass]="this.isOpen ? \'open\' : \'closed\'">\n            <app-ui-form-input [nxValue]="filterCriteria.keyword" (nxValueChange)="searchCustomerName($event)"\n              [placeholder]="[language.searchPlaceholder | translate]"></app-ui-form-input>\n            <button id="btn_customerSearchCancel" class="btn-search-cancel" Action action="customerSearchCancel"\n              (actionClick)="toggleSearch()">\n              <nx-icon name=\'close-circle\' size=\'s\'></nx-icon>\n            </button>\n          </div>\n        </li>\n      </ul>\n    </div>\n\n    \x3c!-- Customer List Component --\x3e\n    <app-customer-list *ngIf="showCustomerList" [onClickCustomerID]="currentCustomer.ClientID"\n      (customerClick)="onChangeCustomer($event)" (customerLoad)="onCustomerLoad()"\n      (customerRefresh)="onCustomerRefresh()" [customerList]="customerList" [filterType]="filterType">\n    </app-customer-list>\n    \x3c!-- end of Customer List Component --\x3e\n\n  </div>\n\n  <div class="main-content stop-scroll-block" main>\n\n    <app-ui-infinite-scroll [syncFunction]="[\'CUSTOMER\']" *ngIf="isShowDetailScroll"\n      (loadingCallback)="loadContent($event)" (refreshCallback)="refreshContent()"\n      [(loadingFinish)]="isLoadingFinishContent" [(refreshFinish)]="isRefreshFinishContent"\n      [lazyLoading]="isLazyLoading">\n\n\n      \x3c!-- Customer Detail --\x3e\n      <app-customer-detail [data]="customerDetail" (followChange)="followChange($event)"\n        (onDeleteDetail)="deleteCustomer($event)" (onAddAppointment)="addAppointment($event)"\n        (onCallPhone)="callCustomer($event)" (onEditDetail)="editCustomer($event)"></app-customer-detail>\n      \x3c!-- end of Customer Detail --\x3e\n\n      \x3c!-- Customer Contact List --\x3e\n      <app-customer-contact-list *ngIf="customerDetail&&customerList.length" [contactList]="customerContactList"\n        (onAddNote)="addNote()" (onDisplayNote)="displayNote($event)" (onEditNote)="editNote($event)"\n        (onDeleteNote)="deleteNote($event)">\n      </app-customer-contact-list>\n      \x3c!-- end of Customer Contact List --\x3e\n\n    </app-ui-infinite-scroll>\n  </div>\n\n\n  \x3c!-- Popup --\x3e\n  <div global-main>\n    \x3c!-- side import --\x3e\n    <app-ui-modal-style-text1 [(isPopupOpen)]="isPopupImport" class="wd-md" [isContnetFull]="true"\n      (close)="onCloseImportPopup()">\n\n      <ng-container textType="modal-title-detail">{{language.importPhone |translate }}</ng-container>\n      <ng-container textType="modal-content-detail">\n        \x3c!-- still need space --\x3e\n        <div class="space-normal top-search-block">\n          \x3c!-- search block --\x3e\n          <app-ui-form-search [name]="\'search\'" [placeholder]="[language.searchPlaceholder | translate]"\n            [nxValue]="importSearchKeyword" (nxValueChange)="refreshImport($event)"></app-ui-form-search>\n          \x3c!-- end of search block --\x3e\n        </div>\n        \x3c!-- end of still need space --\x3e\n        <app-customer-import [importContractMap]="importContractMap" (importCustomer)="onImportCustomer($event)">\n        </app-customer-import>\n      </ng-container>\n      <ng-container textType="modal-btm-detail">\n        <div class="btm-set-block">\n          <span class="ps-text">\n            {{mobileResultSize}} {{language.people|translate}}\n          </span>\n          \x3c!-- btn --\x3e\n          <app-ui-btn-layout>\n            <app-ui-btn [id]="\'btn_customerContactImport\'" Action action="customerContactImport"\n              (actionClick)="doImport()" [btnHeight]="\'sm\'">\n              <ng-container TextType="cust">{{language.import|translate}}</ng-container>\n            </app-ui-btn>\n          </app-ui-btn-layout>\n          \x3c!-- end of btn --\x3e\n        </div>\n      </ng-container>\n    </app-ui-modal-style-text1>\n    \x3c!-- end of side import--\x3e\n\n    \x3c!-- side Filter--\x3e\n    <app-ui-modal-style-text1 class="wd-lg" [isPopupOpen]="isPopupFilter" (isPopupOpenChange)="filterCriteriaPopupChange($event)">\n      <ng-container textType="modal-title-detail">{{language.customerFilter |translate }}</ng-container>\n      <ng-container textType="modal-content-detail">\n        <app-customer-filter [criteria]="filterCriteria" (doneCriteria)="doneCriteria($event)" [clear]="clearSubject"\n          [save]="saveFilterSubject"></app-customer-filter>\n      </ng-container>\n\n      <ng-container textType="modal-btm-detail">\n        <app-ui-btn-layout>\n          <app-ui-btn [name]="\'btn-clear\'" [id]="\'btn_customerContactClearFilter\'" Action\n            action="customerContactClearFilter" (actionClick)="clearFilter()" [btnHeight]="\'sm\'" [btnStyle]="\'border\'">\n            <ng-container TextType="cust">{{language.customerClear |translate }}</ng-container>\n          </app-ui-btn>\n          <app-ui-btn [name]="\'btn-filter\'" [id]="\'btn_customerContactDoFilter\'" Action\n            action="customerContactClearFilter" (actionClick)="doFilter()" [btnHeight]="\'sm\'">\n            <ng-container TextType="cust">{{language.filter |translate }}</ng-container>\n          </app-ui-btn>\n        </app-ui-btn-layout>\n      </ng-container>\n    </app-ui-modal-style-text1>\n    \x3c!-- end of side Filter --\x3e\n\n    <div class="popup-appointment">\n      \x3c!-- appointment popup --\x3e\n      <app-ui-modal-style-text1 [isBackdropClose]="true" [(isPopupOpen)]="isExpandEdit"\n        [hidden]="!isCalendarEditMetaDataDone" class="wd-lg calendar-edit-content"\n        (close)="onToggleAppointmentModal(false)">\n        <ng-container textType="modal-title-detail">{{language.customerAppointment |translate }}</ng-container>\n        <ng-container textType="modal-content-detail">\n          \x3c!-- TODO:ADD CALENDAR EDIT --\x3e\n          <snd-calendar-edit *ngIf="isExpandEdit" [clientID]="calendarEventDetail?calendarEventDetail.clientID :\'\'"\n            [customerClientID]="customerClientID" [translateMap]="translateMap"\n            [todayCalendarEvent]="viewDateCalendarEventList" [isSaveClick]="isSaveClick" [viewDate]="viewDate"\n            (saveEvent)="onSaveCalendarEvent($event)" (isMetaDataDone)="onCalendarEditMetaDataDone()">\n          </snd-calendar-edit>\n        </ng-container>\n        <ng-container textType="modal-btm-detail">\n          <app-ui-btn-layout>\n            <app-ui-btn [btnWd]="\'md\'" [btnHeight]="\'sm\'" [id]="\'btn_customerAppointmentSave\'" Action\n              action="customerAppointmentSave" (actionClick)="onClickAppointmentSave()">\n              <ng-container TextType="cust">{{language.customerSave |translate }}</ng-container>\n            </app-ui-btn>\n          </app-ui-btn-layout>\n        </ng-container>\n      </app-ui-modal-style-text1>\n      \x3c!-- end of appointment popup --\x3e\n\n    </div>\n\n    \x3c!-- contact popup --\x3e\n    <app-ui-modal-style-img-base class="wd-sm" [isHasBtmBlock]="false" [isModalBtmHasSpace]="true" [typeBtn]="\'style3\'"\n      [(isPopupOpen)]="this.isPopupCallPhone">\n      <ng-container textType="modal-img-detail">\n        <nx-icon name=\'phone-o\' size=\'auto\' [fill]="false" [outline]=\'false\'></nx-icon>\n      </ng-container>\n      <ng-container textType="modal-title-detail">{{language.selectNumber |translate }}</ng-container>\n      <ng-container textType="modal-content-detail">\n        <ng-container *ngFor="let tel of callPhoneTelArray">\n          \x3c!-- tel 1  --\x3e\n          <app-ui-link-bg [textTitle]="tel.telType | translate" [text]="tel.tel" (linkBtnClick)="callPhone(tel.tel)">\n          </app-ui-link-bg>\n          \x3c!-- end of tel 1 --\x3e\n        </ng-container>\n      </ng-container>\n    </app-ui-modal-style-img-base>\n    \x3c!-- end of contact popup --\x3e\n\n    \x3c!-- note detail --\x3e\n    <ng-container *ngIf="customerContactDetail">\n      <app-ui-modal-style-text1 class="wd-md" [isHasBtmBlock]="false" [(isPopupOpen)]="isPopupNoteDetail">\n        <ng-container textType="modal-title-detail">{{language.contactNote |translate }}</ng-container>\n        <ng-container textType="modal-content-detail">\n          <div class="text-detail-block">\n            <div class="img-text-block-horizon">\n              <div class="img-block">\n                <img src="assets/img/img-cust-profile.svg">\n              </div>\n              <div class="text-block">\n                <app-customer-contact-detail [data]="customerContactDetail"></app-customer-contact-detail>\n              </div>\n            </div>\n\n          </div>\n\n        </ng-container>\n      </app-ui-modal-style-text1>\n    </ng-container>\n\n    \x3c!-- end of note detail --\x3e\n\n    \x3c!-- add/edit note --\x3e\n    <app-ui-modal-style-text1 class="wd-md" [isBackdropClose]="true" [(isPopupOpen)]="this.isPopupEditNote"\n      [isMobileBtmBtnFix]=false [isHasBtmBlock]=false>\n      <ng-container textType="modal-title-detail">{{language.contactNote |translate }}</ng-container>\n      <ng-container textType="modal-content-detail">\n        <app-customer-contact-edit [data]="currentEditNote" [saveSubject]="contactSaveSubject"\n          (save)="onSaveNoteFinish($event)"></app-customer-contact-edit>\n        \x3c!-- btn --\x3e\n        <app-ui-btn-layout>\n          <app-ui-btn [name]="\'btn-note-save\'" [id]="\'btn_customerNoteSave\'" Action action="customerNoteSave"\n            (actionClick)="onSaveNote($event)" [btnWd]="\'md\'" [btnHeight]="\'sm\'">\n            <ng-container TextType="cust">{{language.customerSave |translate }}</ng-container>\n          </app-ui-btn>\n        </app-ui-btn-layout>\n        \x3c!-- end of btn --\x3e\n      </ng-container>\n    </app-ui-modal-style-text1>\n    \x3c!-- end of add note --\x3e\n\n    \x3c!--  save--\x3e\n    <app-ui-modal-style-feedback [(isPopupOpen)]="isDisplaySavePopup">\n      <ng-container textType="modal-img-detail">\n        <nx-icon name=\'check\' size=\'auto\'></nx-icon>\n      </ng-container>\n      <ng-container textType="modal-content-detail">{{language.notificationSaveFeedback |translate }}</ng-container>\n    </app-ui-modal-style-feedback>\n    \x3c!-- end of save --\x3e\n\n    \x3c!-- import save--\x3e\n    <app-ui-modal-style-feedback [(isPopupOpen)]="isDisplayImportSavePopup">\n      <ng-container textType="modal-img-detail">\n        <nx-icon name=\'check\' size=\'auto\'></nx-icon>\n      </ng-container>\n      <ng-container textType="modal-content-detail">{{language.completed| translate }}</ng-container>\n    </app-ui-modal-style-feedback>\n    \x3c!-- end of save --\x3e\n\n    \x3c!-- Delete Success --\x3e\n    <app-ui-modal-style-feedback [(isPopupOpen)]="isDisplayDeletePopup">\n      <ng-container textType="modal-img-detail">\n        <nx-icon name=\'check\' size=\'auto\'></nx-icon>\n      </ng-container>\n      <ng-container textType="modal-content-detail">{{language.notificationDeleteFeedback | translate}}</ng-container>\n    </app-ui-modal-style-feedback>\n    \x3c!-- end of Delete Success --\x3e\n\n\n    \x3c!-- delete customer data --\x3e\n    <app-ui-modal-confirm [(isPopupOpen)]="isDisplayDelCustomerPopup" (onCancel)="cancelDelete()"\n      (onConfirm)="doDeleteCustomer()" [title]="[language.deleteDataTitle | translate]"\n      [message]="[language.deleteDataBody | translate]" [cancelBtnText]="[language.no | translate]"\n      [confirmBtnText]="[language.yes | translate]">\n    </app-ui-modal-confirm>\n    \x3c!-- end of delete customer data --\x3e\n\n    \x3c!-- delete customer contact data --\x3e\n    <app-ui-modal-confirm [(isPopupOpen)]="isPopupDeleteNote" (onCancel)="cancelDelete()"\n      (onConfirm)="doDeleteContact()" [title]="[language.delete | translate]"\n      [message]="[language.deleteDataBody | translate]" [cancelBtnText]="[language.no | translate]"\n      [confirmBtnText]="[language.yes | translate]">\n    </app-ui-modal-confirm>\n    \x3c!-- end of delete customer contact data --\x3e\n\n    \x3c!-- customer info alert --\x3e\n    <app-ui-modal-style-img-base [(isPopupOpen)]="isDisplayInfoAlertPopup">\n      <ng-container textType="modal-img-detail">\n        \x3c!-- <img src="assets/img/icon-cust-remind.svg"> --\x3e\n        <nx-icon name=\'product-people-connect\' size=\'auto\' [fill]="false" [outline]=\'false\'></nx-icon>\n      </ng-container>\n      <ng-container textType="modal-title-detail">{{language.protectionTitle |translate }}</ng-container>\n      <ng-container textType="modal-content-detail">\n        <app-ui-text-type [colorCode]="\'#f5f5f5\'">\n          <p class="desc-sm">\n            It will show the content Allianz provide. The dummy words are below:\n            After ten minutes with Ed Tettemer in the offices of the agency he founded with partner, Steve Red, you\n            begin to understand the agency’s passion for excellence. After an hour with Ed, you begin to understand the\n            intensity of his personal passion. You begin to understand it but I have a feeling that, even after days and\n            days of exposure to him, you probably wouldn’t get the whole picture.\n            <br />\n            “Passion,” the word, may seem descriptive of a complicated set of feelings and opinions. Oddly, in thinking\n            about Ed Tettemer’s passion for his agency and its clients, it seems rather simple. It’s just that he wants\n            everything to be excellent: excellent clients, excellent co-workers, excellent marketing solutions,\n            excellent creative executions, excellent everything.\n            <br />\n            “Where’d you go to college, Ed?” (A question most interviewers ask without expecting surprises in the\n            response.) “Never went to college. Dropped out of high school and never looked back. Got my college degree\n            at the Elkman agency and my graduate degree at Earle Palmer Brown.”\n            <br />\n            “Where’d you go to college, Ed?” (A question most interviewers ask without expecting surprises in the\n            response.) “Never went to\n            college. Dropped out of high school and never looked back. Got\n          </p>\n        </app-ui-text-type>\n      </ng-container>\n      \x3c!-- end modal-content-detail --\x3e\n      <ng-container textType="modal-btm-detail">\n        \x3c!-- btn --\x3e\n        <app-ui-btn-layout>\n          <app-ui-btn class="btn-single-block" [btnColor]="\'main2\'" [btnStyle]="\'full\'" [btnHeight]="\'sm\'"\n            [btnWd]="\'md\'" [id]="\'btn_customerInfoAlertPopup\'" Action action="customerInfoAlertPopup"\n            (actionClick)="isDisplayInfoAlertPopup = !isDisplayInfoAlertPopup">\n            <ng-container TextType="cust">{{language.customerConfirm |translate }}</ng-container>\n          </app-ui-btn>\n        </app-ui-btn-layout>\n        \x3c!-- end of btn --\x3e\n      </ng-container>\n      \x3c!-- end modal-btm-detail --\x3e\n    </app-ui-modal-style-img-base>\n    \x3c!-- end of customer info alert --\x3e\n\n    \x3c!-- customer confirm alert --\x3e\n    <app-ui-modal-style-img-base class="popup-agree" [(isPopupOpen)]="isDisplayConfirmAlertPopup"\n      (onScrollContentBtm)="detectScroll($event)" [isBackdropClose]="false">\n      <ng-container textType="modal-img-detail">\n        \x3c!-- <img src="assets/img/icon-cust-remind.svg"> --\x3e\n        <nx-icon name=\'product-people-connect\' size=\'auto\' [fill]="false" [outline]=\'false\'></nx-icon>\n      </ng-container>\n      <ng-container textType="modal-title-detail">{{language.protectionTitle |translate }}</ng-container>\n      <ng-container textType="modal-content-detail">\n        <app-ui-text-type #confirmAlert [colorCode]="\'#f5f5f5\'">\n          <p class="desc-sm">{{language.addProtection | translate}}</p>\n        </app-ui-text-type>\n      </ng-container>\n      \x3c!-- end modal-content-detail --\x3e\n      <ng-container textType="modal-btm-detail">\n        \x3c!-- btn --\x3e\n        <app-ui-btn-layout>\n          <app-ui-btn [isDisable]="isPopupConfirmDisable" [btnColor]="\'main2\'" [btnStyle]="\'full\'" [btnHeight]="\'sm\'"\n            [btnWd]="\'md\'" [id]="\'btn_customerConfirmPopup\'" Action action="customerConfirmPopup"\n            (actionClick)="confirmPopup()">\n            <ng-container TextType="cust">{{language.customerConfirm |translate }}</ng-container>\n          </app-ui-btn>\n        </app-ui-btn-layout>\n        \x3c!-- end of btn --\x3e\n      </ng-container>\n      \x3c!-- end modal-btm-detail --\x3e\n    </app-ui-modal-style-img-base>\n    \x3c!-- end of customer confirm alert --\x3e\n\n  </div>\n  \x3c!-- end of Popup --\x3e\n\n</app-ui-main-side-menu>',animations:[l.trigger("searchBlockAni",[l.state("*",l.style({width:"0",opacity:0})),l.state("open",l.style({width:"100%",opacity:1})),l.state("closed",l.style({width:"0",opacity:0})),l.transition("open => closed",l.animate("300ms ease-in")),l.transition("closed => open",l.animate("300ms ease-in"))])],styles:[".filter-block{display:flex;padding:0 20px;list-style-type:none;align-content:center;flex-wrap:wrap}.filter-block ::ng-deep .nx-formfield__wrapper{padding-bottom:0}.filter-block .filter-item{display:flex;align-items:center;max-width:40px;width:100%;margin-right:20px}.filter-block .filter-item:last-of-type{margin-right:0}.filter-block .filter-item>a,.filter-block .filter-item>button{display:inline-block;position:relative;width:100%;max-width:40px}.filter-block .filter-item a,.filter-block .filter-item button{background-color:transparent;border:none;padding:0}.filter-block .filter-item a:focus,.filter-block .filter-item button:focus{outline:0}.filter-block .filter-item a img,.filter-block .filter-item button img{width:40px;height:40px}.filter-block .filter-item .num-block{display:flex;width:20px;height:20px;background-color:#007ab3;border-radius:50%;justify-content:center;align-items:center;position:absolute;right:-5px;top:-5px}.filter-block .filter-item .num-block .num{color:#fff;font-weight:700;font-size:.75rem}.filter-block .search-animate-block{align-items:center}.filter-block .search-animate-block .search-input-block{display:inline-block;width:0;position:relative}.filter-block .search-animate-block ::ng-deep .nx-formfield__input{border-top:none;width:100%}.filter-block .search-animate-block ::ng-deep .btn-search-cancel{position:absolute;right:0;display:inline-block;width:44px;height:44px;top:-7px;text-align:right;opacity:0}.filter-block .search-animate-block ::ng-deep .btn-search-cancel nx-icon{font-size:16px;color:#c2c2c2;margin-right:10px}.filter-block .search-animate-block.active{max-width:calc(100vw - 30px);margin-left:0!important}.filter-block .search-animate-block.active .search-input-block{display:inline-block;width:100%}.filter-block .search-animate-block.active ::ng-deep .btn-search-cancel{display:inline-block;opacity:1}@media (min-width:769px){.filter-block .search-animate-block ::ng-deep .btn-search-cancel nx-icon{margin-right:5px}.filter-block .search-animate-block.active{max-width:210px}}.filter-all-block{position:relative;overflow:hidden;display:inline-block;width:100%;min-height:56px;margin-bottom:10px}.filter-block{transition:.2s;position:absolute;height:100%;left:0;width:1400px}.filter-block>.filter-item{transition:.2s}.filter-block.ani-bar-move{left:-187px}.filter-block.ani-bar-move .filter-item{opacity:0}.filter-block.ani-bar-move .filter-item.search-animate-block{opacity:1}@media (min-width:1024px){.filter-block .filter-item{margin-right:5px}.filter-block .filter-item:last-of-type{margin-right:0}.filter-block .filter-item button{max-width:30px}.filter-block .filter-item button img{width:30px;height:30px}.filter-block{width:500px}.filter-block.ani-bar-move{left:-137px}}@media screen and (min-width:1025px){.filter-block .filter-item{max-width:4vw}.filter-block .filter-item button{max-width:3vw}.filter-block .filter-item button img{width:3vw;height:3vw}.filter-block{width:50vw}.filter-block+.filter-block{margin-right:.5vw}.filter-block:last-of-type{margin-right:0}.filter-block.ani-bar-move{left:-13.7vw}.filter-block .search-animate-block.active{max-width:21vw}}@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.top-search-block{padding-top:20px;padding-left:20px;padding-right:20px}:host .popup-appointment ::ng-deep app-ui-modal-style-text1 .modal-block{padding-left:0;padding-right:0}:host .popup-appointment ::ng-deep app-ui-modal-style-text1 .modal-block .modal-content-block.style-fixed{margin-bottom:40px}:host .popup-appointment ::ng-deep app-ui-modal-style-text1 .modal-block .modal-content-block .btn-block{margin-top:40px}:host ::ng-deep app-ui-modal-style-text1 .modal-block .modal-content-block .btn-block{margin-top:40px}:host ::ng-deep app-customer-list,:host ::ng-deep app-ui-infinite-scroll{display:inline-block;width:100%;height:100%}:host ::ng-deep .ui-list-data{display:inline-block;width:100%}.customer-side.side-menu-content{color:#414141;max-height:100%;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;overflow:hidden;width:100%;max-width:100%}.customer-side.side-menu-content .title-main-block{padding-left:15px;padding-right:20px}@media (max-width:1023px){.customer-side.side-menu-content{display:flex;flex-direction:column;height:calc(100vh - 55px - 55px)}.customer-side.side-menu-content app-customer-list{display:flex}.customer-side.side-menu-content .ui-list-data{display:inline-block;height:100%}}.main-content{box-sizing:border-box;height:100vh;position:static}.main-content ::ng-deep .scroll-content{background-color:#f5f5f5;overflow-x:hidden}@media (max-width:768px){.main-content{position:relative;padding-top:44px}}@media (max-width:767px){@supports (top:constant(safe-area-inset-top)){.main-content ::ng-deep .infiniti-scroll{max-height:calc(100vh - 44px - constant(safe-area-inset-top) - constant(safe-area-inset-bottom))}}@supports (top:env(safe-area-inset-top)){.main-content ::ng-deep .infiniti-scroll{max-height:calc(100vh - 44px - env(safe-area-inset-top) - env(safe-area-inset-bottom))}}}"]}]}],t.ctorParameters=function(){return[{type:K},{type:q},{type:j.TranslateService},{type:j.DeviceService},{type:j.DateUtils},{type:j.ProfileCodeService},{type:Z},{type:j.AppRouter},{type:nt},{type:ut},{type:j.NotificationMgr},{type:h.ChangeDetectorRef},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[j.ConfigToken]}]},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[j.showRuleToken]}]},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[L]}]},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[M]}]}]},t.propDecorators={calendarEditComponent:[{type:h.ViewChild,args:[N]}]},t}(),dt=function(r){function t(t,e,n,i,o){var a=r.call(this,t,e,n,i)||this;return a.customMetaController=o,a}return y(t,r),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,console.log("set contact detail data:",t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnConfig",{get:function(){return this.metaConfig.Columns},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){r.prototype.ngOnInit.call(this)},t.prototype.getMetaID=function(){return"customerContactDetail"},t.prototype.getMetaParams=function(){return null},t.prototype.onDataUpdated=function(){r.prototype.onDataUpdated.call(this),this.customMetaController&&this.customMetaController.onDataUpdated(this._data)},t.decorators=[{type:h.Component,args:[{selector:"app-customer-contact-detail",template:'<ng-container *ngIf="isMetaLoaded()">\n  <ng-container *ngFor="let col of columnConfig">\n    <p *ngIf="col.id!=\'Name\'" class="desc-normal desc-line-lg">{{data[col.id]}}</p>\n    <p *ngIf="col.id==\'Name\'" class="desc">{{data[col.id]}}</p>\n  </ng-container>\n</ng-container>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:j.MetaService},{type:j.ProfileCodeService},{type:j.DefaultMetaParser},{type:j.InputExecutor},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[_]}]}]},t.propDecorators={data:[{type:h.Input}]},t}(j.DisplayMetaComponent),mt=function(r){function t(t,e,n,i,o){var a=r.call(this,t,e,n,i)||this;return a.customMetaController=o,a.customerClientID="",a.unsubscribe$=new f.Subject,a.save=new h.EventEmitter,a}return y(t,r),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){var e={};this.metaConfig&&(e=this.metaConfig.Columns.map(function(t){return t.id}).reduce(function(t,e){return t[e]="",t},{})),this._data=null!=t?Object.assign(e,t):e,console.log("set contact edit data:",this._data),this.customMetaController&&this.customMetaController.onDataUpdated(this._data),this.customerClientID=this._data.CustomerClientID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnConfig",{get:function(){return this.metaConfig.Columns},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;r.prototype.ngOnInit.call(this),this.saveSubject&&this.saveSubject.pipe(d.takeUntil(this.unsubscribe$)).subscribe(function(){t.onBtnClick("submit","save")})},t.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.getMetaParams=function(){return{CustomerClientID:this.customerClientID}},t.prototype.btnClick=function(t,e){"submit"===t&&this.save.emit(this._data),this.customMetaController&&this.customMetaController.btnClick(t,e,this._data)},t.prototype.getMetaID=function(){return"customerContactEdit"},t.prototype.onValidateAll=function(){if(this.validationResult.isTrue()){var t=!0;return this.customMetaController&&(t=t&&this.customMetaController.onValidateAll(this._data,this.validationResult)),t}return this.validationResult.isError("Note")&&alert("Note "+this.validationResult.getErrorMsg("Note")),!1},t.prototype.onValueChange=function(t,e,n,i){this.customMetaController&&this.customMetaController.onValueChange(t,e,n,i,this._data,this.validationResult)},t.decorators=[{type:h.Component,args:[{selector:"app-customer-contact-edit",template:'<ng-container *ngIf="data && isMetaLoaded()">\n  <ng-container *ngFor="let col of columnConfig">\n    <div class="date-block">\n      <div class="txt" *ngIf="col.type == \'Label\'">{{data[col.id]}}</div>\n    </div>\n    <div *ngIf="col.type == \'Textarea\'" class="textarea-block">\n      <snd-ui-form-textarea [placeholder]="col.placeholder | translate" [maxLength]="col.maxLength"\n        [(nxValue)]="data[col.id]" (nxValueChange)="onChange(col.id,$event)" [height]="\'180px\'" [id]="col.id"></snd-ui-form-textarea>\n    </div>\n  </ng-container>\n</ng-container>\n',styles:["@keyframes fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}.date-block{position:relative;margin-bottom:5px}.date-block .date-data{pointer-events:none;background-color:#fff;position:absolute;top:0;height:100%;font-size:.875rem;font-weight:700}.date-block .txt{font-size:.875rem;font-weight:700;line-height:2}"]}]}],t.ctorParameters=function(){return[{type:j.MetaService},{type:j.ProfileCodeService},{type:j.DefaultMetaParser},{type:j.InputExecutor},{type:undefined,decorators:[{type:h.Optional},{type:h.Inject,args:[T]}]}]},t.propDecorators={data:[{type:h.Input}],saveSubject:[{type:h.Input}],save:[{type:h.Output}]},t}(j.FormMetaComponent),gt=function(){function t(){}return t.decorators=[{type:h.NgModule,args:[{declarations:[X,N,F,R,pt,at,lt,et,tt,rt,st,dt,mt],imports:[i.NxIconModule,n.NxButtonModule,r.NxFormfieldModule,s.NxDatefieldModule,s.NxNativeDateModule,a.UIModule,j.CoreModule,o.CommonModule,e.FormsModule,n.NxDropdownModule,n.NxRadioModule,c.NxInputModule,n.NxMessageModule,u.NxProgressbarModule,n.NxModalModule,n.NxAccordionModule,p.NxGridModule,e.ReactiveFormsModule],providers:[o.DatePipe],exports:[N,X,F,pt,at]}]}],t}(),ht=function(){function t(){}return Object.defineProperty(t.prototype,"action",{get:function(){return this._action},set:function(t){this._action=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"option",{get:function(){return this._optionObj},set:function(t){this._optionObj=t},enumerable:!0,configurable:!0}),t}(),ft=function(){function t(t,e,n,i,o,a,r,s){this.clientID=t,this.addressType=e,this.country=n,this.city=i,this.area=o,this.zipcode=a,this.address=r,this.dataSource=s}return t.prototype.toFullAddress=function(){var t=[];return j.StringUtils.isNotEmpty(this.country)&&t.push(this.country),j.StringUtils.isNotEmpty(this.city)&&t.push(this.city),j.StringUtils.isNotEmpty(this.area)&&t.push(this.area),j.StringUtils.isNotEmpty(this.zipcode)&&t.push(this.zipcode),j.StringUtils.isNotEmpty(this.address)&&t.push(this.address),t.join(", ")},t.prototype.isEmpty=function(){return j.StringUtils.isEmpty(this.country)&&j.StringUtils.isEmpty(this.city)&&j.StringUtils.isEmpty(this.area)&&j.StringUtils.isEmpty(this.zipcode)&&j.StringUtils.isEmpty(this.address)},t}(),yt=function(){function t(t,e,n){this.clientID=t,this.date=e,this.noteMessage=n}return t.prototype.getClientID=function(){return this.clientID},t}(),bt=function(){function t(t,e,n,i){this.clientID=t,this.emailType=e,this.email=n,this.dataSource=i}return t.prototype.isEmpty=function(){return j.StringUtils.isEmpty(this.email)},t}(),Ct=function(){function t(){this._customerList=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this._customerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"customerList",{get:function(){return this._customerList},set:function(t){this._customerList=t},enumerable:!0,configurable:!0}),t.prototype.addCustomerItem=function(t){this._customerList.push(t)},t}(),vt=function Wt(t,e,n,i,o,a){this.lastName=t,this.firstName=e,this.phoneNumber=n,this.email=i,this.address=o,this.birthday=a},Dt=function Yt(t){this.mobileCustomerList=t},xt=function(){function t(t){this.daoFactory=t}return t.prototype.getAPIName=function(){return"addCustomerContactNote"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var a=this;return console.debug("addCustomerContactNote API Data:",this.Data),this.Data.Note?f.Observable.create(function(e){var t=a.daoFactory.getDefaultTable("TW_LH_SD_Customer_Contact"),n=a.daoFactory.getDefaultTable("TW_LH_SD_Customer_Contact_Extension"),i=a.daoFactory.getDefaultDao();if(t!=undefined&&i!=undefined){if(i=new j.ClientCustomDao(i),t.setValue("CustomerClientID",a.Data.CustomerClientID),t.setValue("Note",a.Data.Note),t.setValue("NoteTime",a.Data.NoteTime),(n=j.TableUtils.fillTableColumn(n,a.Data)).setValue("CustomerClientID",a.Data.CustomerClientID),a.Data.ClientID!=undefined&&""!=a.Data.ClientID)t.addRestriction(new j.EqualRestriction("ClientID",[a.Data.ClientID])),n.addRestriction(new j.EqualRestriction("ClientID",[a.Data.ClientID])),i.transactionUpdate(t),i.transactionUpdate(n);else{var o=V.v4();t.setValue("ClientID",o),n.setValue("ClientID",o),i.transactionInsert(t),i.transactionInsert(n)}i.runTransaction().subscribe(function(t){e.next(t),e.complete()})}else e.next(!1),e.complete()}):f.of(new j.SQLiteResponse({status:!0},[]))},t}(),kt=function(){function t(t){this.daoFactory=t}return t.prototype.setClientID=function(t){this._clientID=t},t.prototype.getAPIName=function(){return"getCustomerAutoDelete"},t.prototype.getMockPath=function(){return"./assets/mock/getCustomerAutoDelete.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultTable("TW_LH_SD_Message"),n=i.daoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),j.StringUtils.isNotEmpty(i._clientID)?t.addRestriction(new j.EqualRestriction("ClientID",[i._clientID])):t.addRestriction(new j.EqualRestriction("Status",["UnRead"])),t.addRestriction(new j.EqualRestriction("MessageCategory",["Customer"])),t.addRestriction(new j.EqualRestriction("MessageType",["AutoDelete"])),n.queryByTable(t).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),wt=function(){function t(t){this.daoFactory=t}return t.prototype.setClientID=function(t){this.customerClientID=t},t.prototype.setPageInfo=function(t){this.pageInfo=t},t.prototype.getAPIName=function(){return"getCustomerContactNote"},t.prototype.getMockPath=function(){return"./assets/mock/getCustomerContactNote.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultTable("TW_LH_SD_Customer_Contact"),n=i.daoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.EqualRestriction("CustomerClientID",[i.customerClientID])),t.addRestriction(new j.OrderByRestriction([{column:"NoteTime",order:"DESC"}])),t.addRestriction(new j.LimitRestriction([i.pageInfo.pageSize])),t.addRestriction(new j.OffsetRestriction([5*(i.pageInfo.page-1)])),console.debug(t),n.queryByTable(t).subscribe(function(t){console.debug("getCustomerContactNote:",t),e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),It=function(){function t(t){this.daoFactory=t}return Object.defineProperty(t.prototype,"clientID",{set:function(t){this._clientID=t},enumerable:!0,configurable:!0}),t.prototype.getAPIName=function(){return"deleteCustomer"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultTable("TW_LH_SD_Customer"),n=i.daoFactory.getDefaultDao();t!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.EqualRestriction("ClientID",[i._clientID])),n.deleteByTable(t).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),St=function(){function t(t){this.daoFactory=t}return t.prototype.setContactClientID=function(t){this.contactClientID=t},t.prototype.getAPIName=function(){return"deleteCustomerContactNote"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultTable("TW_LH_SD_Customer_Contact"),n=i.daoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.EqualRestriction("ClientID",[i.contactClientID])),n.deleteByTable(t).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),Tt=function(){function t(t){this.daoFactory=t,this._id=""}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t},enumerable:!0,configurable:!0}),t.prototype.getAPIName=function(){return"getCustomerDetail"},t.prototype.getMockPath=function(){return"./assets/mock/getCustomerDetail.json"},t.prototype.executeSQL=function(){var o=this;console.log("customer Detail:execute SQL");if(this._id&&0!=this._id.length){var t=this.daoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),e=this.daoFactory.getDefaultDao();if(t==undefined||e==undefined)return f.of(!1);var a=new j.ClientCustomDao(e);return t.addRestriction(new j.EqualRestriction("ClientID",[this._id])),f.from(a.queryByTable(t).toPromise().then(function(t){var n=t,i=n.Body[0].ClientID,e=o.daoFactory.getDefaultTable("TW_LH_SD_Customer_Tel");return e?((e=e).addRestriction(new j.EqualRestriction("CustomerClientID",[i])),a.queryByTable(e).toPromise().then(function(t){var e=t.Body;return n.Body[0].tel=e,{customer:n,clientID:i}})):{customer:n,clientID:i}}).then(function(t){var n=t.customer,i=t.clientID,e=o.daoFactory.getDefaultTable("TW_LH_SD_Customer_Email");return e?((e=e).addRestriction(new j.EqualRestriction("CustomerClientID",[i])),a.queryByTable(e).toPromise().then(function(t){var e=t.Body;return n.Body[0].email=e,{customer:n,clientID:i}})):{customer:n,clientID:i}}).then(function(t){var n=t.customer,e=t.clientID,i=o.daoFactory.getDefaultTable("TW_LH_SD_Customer_Address");return i?((i=i).addRestriction(new j.EqualRestriction("CustomerClientID",[e])),a.queryByTable(i).toPromise().then(function(t){var e=t.Body;return n.Body[0].address=e,n})):n}).then(function(t){return t.Body[0].BirthdayYear&&t.Body[0].BirthdayMonth&&t.Body[0].BirthdayDate?t.Body[0].Birthday=new Date(parseInt(t.Body[0].BirthdayYear),parseInt(t.Body[0].BirthdayMonth)-1,t.Body[0].BirthdayDate):t.Body[0].Birthday=null,console.log("CustomerDetailAPI convert BirthDay: ",t.Body[0].Birthday),t}))}var n=new j.SQLiteResponse({isSuccess:!0},[{ClientID:"",LastName:"",FirstName:"",Occupation:"",Company:"",BirthdayYear:"",BirthdayMonth:"",BirthdayDate:"",Birthday:null,AgeRange:null,Gender:null,Income:null,Source:null,Marriage:null,Children:null,Familiarity:null,RecentStatus:null,MANPA:null,ContactFrequancy:null,Possibility:null,IsFollow:"N",DataSource:"APP",tel:[],email:[],address:[]}]);return f.of(n)},t}(),_t=function(){function t(t){this.daoFactory=t}return t.prototype.setContactClientID=function(t){this.contactClientID=t},t.prototype.setNote=function(t){this.note=t},t.prototype.setNoteTime=function(t){this.noteTime=t},t.prototype.getAPIName=function(){return"editCustomerContactNote"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultTable("TW_LH_SD_Customer_Contact"),n=i.daoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.EqualRestriction("ClientID",[i.contactClientID])),t.setValue("Note",i.note),t.setValue("NoteTime",i.noteTime.getTime()),n.updateByTable(t).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),Et=function(){function t(t){this.daoFactory=t}return t.prototype.setClientID=function(t){this._clientID=t},t.prototype.getAPIName=function(){return"getCustomerOverTime"},t.prototype.getMockPath=function(){return"./assets/mock/getCustomerOverTime.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultTable("TW_LH_SD_Message"),n=i.daoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),j.StringUtils.isNotEmpty(i._clientID)?t.addRestriction(new j.EqualRestriction("ClientID",[i._clientID])):t.addRestriction(new j.EqualRestriction("Status",["UnRead"])),t.addRestriction(new j.EqualRestriction("MessageCategory",["Customer"])),t.addRestriction(new j.EqualRestriction("MessageType",["Overtime"])),n.queryByTable(t).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),Pt=function(){function t(t){this.daoFactory=t}return t.prototype.getAPIName=function(){return"getCustomerFilterPreset"},t.prototype.getMockPath=function(){return"./assets/mock/getCustomerFilterPreset.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultDao();if(t!=undefined){var n=i.daoFactory.getDefaultTable("TW_LH_SD_Personal_Setting");n?(t=new j.ClientCustomDao(t),(n=n).addRestriction(new j.EqualRestriction("SettingID",["CustomerFilterSetting"])),t.queryByTable(n).subscribe(function(t){console.debug(t),e.next(t),e.complete()})):(e.next(!1),e.complete())}else e.next(!1),e.complete()})},t}(),At=function(){function t(t,e){this.daoFactory=t,this.profileCodeService=e,this._pageInfo=new j.PageInfo}return Object.defineProperty(t.prototype,"clientID",{set:function(t){this._queryClientID=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"restrictions",{set:function(t){this._restrictions=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageInfo",{set:function(t){this._pageInfo=t},enumerable:!0,configurable:!0}),t.prototype.getAPIName=function(){return"getCustomerList"},t.prototype.getMockPath=function(){return"./assets/mock/getCustomerList.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var n=i.daoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),t=i.daoFactory.getDefaultDao();n!=undefined&&t!=undefined?(t=new j.ClientCustomDao(t),0<i._restrictions.length&&i._restrictions.forEach(function(t){n.addRestriction(t)}),n.addRestriction(new j.OrderByRestriction([{column:"LastName",order:"ASC"}])),0<i._pageInfo.pageSize&&(n.addRestriction(new j.LimitRestriction([i._pageInfo.pageSize])),n.addRestriction(new j.OffsetRestriction([10*(i._pageInfo.page-1)]))),j.StringUtils.isNotEmpty(i._queryClientID)&&n.addRestriction(new j.EqualRestriction("ClientID",[i._queryClientID])),t.queryByTable(n).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),Mt=function(){function t(t,e){this.daoFactory=t,this.customerUtils=e,this.Data=null}return t.prototype.setDetail=function(t){this.Data=t},Object.defineProperty(t.prototype,"customerDetail",{get:function(){return this.Data},enumerable:!0,configurable:!0}),t.prototype.getAPIName=function(){return"saveCustomerDetail"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var O=this;return f.Observable.create(function(e){var t,n,i,o,a,r,s,l=O.daoFactory.getDefaultDao();if(l!=undefined){s=new j.ClientCustomDao(l),console.log("base_dao:",l),console.log("dao:",s);var c=O.daoFactory.getDefaultTable("TW_LH_SD_Customer"),u=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Extension");if(c&&u){var p=O.customerDetail.Birthday;if(null!=p&&p!=undefined){c.setValue("BirthdayYear",p.getFullYear().toString());var d=(p.getMonth()+1).toString();d.length<2&&(d="0"+d.toString()),c.setValue("BirthdayMonth",d);var m=p.getDate().toString();m.length<2&&(m="0"+m.toString()),c.setValue("BirthdayDate",m)}else c.setValue("BirthdayYear",null),c.setValue("BirthdayMonth",null),c.setValue("BirthdayDate",null);if(c.setValue("AgeRange",O.customerDetail.AgeRange),c.setValue("ClientID",O.customerDetail.ClientID),c.setValue("LastName",O.customerDetail.LastName),c.setValue("FirstName",O.customerDetail.FirstName),c.setValue("Occupation",O.customerDetail.Occupation),c.setValue("Company",O.customerDetail.Company),c.setValue("Gender",O.customerDetail.Gender),c.setValue("Income",O.customerDetail.Income),c.setValue("Source",O.customerDetail.Source),c.setValue("Marriage",O.customerDetail.Marriage),c.setValue("Children",O.customerDetail.Children),c.setValue("Familiarity",O.customerDetail.Familiarity),c.setValue("ContactFrequancy",O.customerDetail.ContactFrequancy),c.setValue("Possibility",O.customerDetail.Possibility),c.setValue("IsFollow",O.customerDetail.IsFollow),u.setValue("ClientID",O.customerDetail.ClientID),console.log("save cusomer stringify:",JSON.stringify(O.customerDetail)),u=j.TableUtils.fillTableColumn(u,O.customerDetail),console.log("save cusomer extObj:",JSON.stringify(u)),O.customerUtils.setCustomerDefaultValue(c),O.customerDetail.AgeRange=c.getValue("AgeRange"),c.setValue("Completeness",O.customerDetail.Completeness),console.debug("insertCustomer",c),""==c.getValue("ClientID")){var g=V.v4();c.setValue("ClientID",g),u.setValue("ClientID",g),s.transactionInsert(c),s.transactionInsert(u)}else{var h=c.getValue("ClientID"),f=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Tel"),y=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Tel_Extension"),b=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Email"),C=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Email_Extension"),v=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Address"),D=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Address_Extension");c.addRestriction(new j.EqualRestriction("ClientID",[h])),u.addRestriction(new j.EqualRestriction("ClientID",[h])),f.addRestriction(new j.EqualRestriction("CustomerClientID",[h])),y.addRestriction(new j.EqualRestriction("CustomerClientID",[h])),b.addRestriction(new j.EqualRestriction("CustomerClientID",[h])),C.addRestriction(new j.EqualRestriction("CustomerClientID",[h])),v.addRestriction(new j.EqualRestriction("CustomerClientID",[h])),D.addRestriction(new j.EqualRestriction("CustomerClientID",[h])),s.transactionUpdate(c),s.transactionUpdate(u),l.transactionDelete(f),l.transactionDelete(y),l.transactionDelete(b),l.transactionDelete(C),l.transactionDelete(v),l.transactionDelete(D)}try{for(var x=B(O.customerDetail.tel),k=x.next();!k.done;k=x.next()){var w=k.value;f=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Tel"),y=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Tel_Extension");if(f&&w.Tel){""==w.TelType&&(w.TelType="TelHome");var I=V.v4();(f=f).setValue("ClientID",I),f.setValue("CustomerClientID",c.getValue("ClientID")),f.setValue("TelType",w.TelType),f.setValue("Tel",w.Tel),y.setValue("ClientID",I),y.setValue("CustomerClientID",c.getValue("ClientID")),y=j.TableUtils.fillTableColumn(y,w),s.transactionInsert(f),s.transactionInsert(y)}}}catch(M){t={error:M}}finally{try{k&&!k.done&&(n=x["return"])&&n.call(x)}finally{if(t)throw t.error}}try{for(var S=B(O.customerDetail.email),T=S.next();!T.done;T=S.next()){var _=T.value;b=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Email"),C=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Email_Extension");if(b&&_.Email){""==_.EmailType&&(_.EmailType="MailHome");I=V.v4();(b=b).setValue("ClientID",I),b.setValue("CustomerClientID",c.getValue("ClientID")),b.setValue("EmailType",_.EmailType),b.setValue("Email",_.Email),C.setValue("ClientID",I),C.setValue("CustomerClientID",c.getValue("ClientID")),C=j.TableUtils.fillTableColumn(C,_),s.transactionInsert(b),s.transactionInsert(C)}}}catch(L){i={error:L}}finally{try{T&&!T.done&&(o=S["return"])&&o.call(S)}finally{if(i)throw i.error}}try{for(var E=B(O.customerDetail.address),P=E.next();!P.done;P=E.next()){var A=P.value;v=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Address"),D=O.daoFactory.getDefaultTable("TW_LH_SD_Customer_Address_Extension");if(v&&!O._judgeIsAddressEmpty(A)){I=V.v4();v.setValue("ClientID",I),(v=v).setValue("CustomerClientID",c.getValue("ClientID")),v.setValue("AddressType",A.AddressType),v.setValue("Country",A.Country),v.setValue("City",A.City),v.setValue("Area",A.Area),v.setValue("Zipcode",A.Zipcode),v.setValue("Address",A.Address),D.setValue("ClientID",I),D.setValue("CustomerClientID",c.getValue("ClientID")),D=j.TableUtils.fillTableColumn(D,A),s.transactionInsert(v),s.transactionInsert(D)}}}catch(N){a={error:N}}finally{try{P&&!P.done&&(r=E["return"])&&r.call(E)}finally{if(a)throw a.error}}s.runTransaction().subscribe(function(t){e.next(t),e.complete()})}else e.next(!1),e.complete()}else e.next(!1),e.complete()})},t.prototype._judgeIsAddressEmpty=function(n){return["Country","City","Area","Zipcode","Address"].reduce(function(t,e){return t&&""==n[e]},!0)},t}(),Lt=function(){function t(t){this.daoFactory=t}return t.prototype.setFilterCriteria=function(t){this._criteria=t},t.prototype.getAPIName=function(){return"saveCustomerFilterPreset"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultDao();if(t!=undefined){var n=i.daoFactory.getDefaultTable("TW_LH_SD_Personal_Setting");n?(t=new j.ClientCustomDao(t),(n=n).addRestriction(new j.EqualRestriction("SettingID",["CustomerFilterSetting"])),n.setValue("SettingVal",JSON.stringify(i._criteria.toPresetJSON())),t.updateByTable(n).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())}else e.next(!1),e.complete()})},t}(),Nt=function(){function t(t){this.daoFactory=t}return t.prototype.setClientID=function(t){this.clientID=t},t.prototype.getAPIName=function(){return"getCustomerTel"},t.prototype.getMockPath=function(){return"./assets/mock/getCustomerTel.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultTable("TW_LH_SD_Customer_Tel"),n=i.daoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.EqualRestriction("CustomerClientID",[i.clientID])),n.queryByTable(t).subscribe(function(t){console.debug(t),e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),Ot=function(){function t(t){this.daoFactory=t}return t.prototype.setClient=function(t){this._clientID=t},t.prototype.setIsFollow=function(t){this._isFollow=t},t.prototype.getAPIName=function(){return"updateCustomerFollowStatus"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultDao();if(t!=undefined){var n=i.daoFactory.getDefaultTable("TW_LH_SD_Customer");n?(t=new j.ClientCustomDao(t),(n=n).addRestriction(new j.EqualRestriction("ClientID",[i._clientID])),n.setValue("IsFollow",i._isFollow?"Y":"N"),t.updateByTable(n).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())}else e.next(!1),e.complete()})},t}(),Ft=function(){function t(t,e){this.daoFactory=t,this.customerUtils=e}return t.prototype.setItems=function(t){this.items=t},t.prototype.getAPIName=function(){return"importContact"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var R=this;return f.Observable.create(function(e){var t,n,i,o,a,r,s=R.daoFactory.getDefaultDao();if(s!=undefined){s=new j.ClientCustomDao(s);try{for(var l=B(R.items),c=l.next();!c.done;c=l.next()){var u=c.value,p=R.daoFactory.getDefaultTable("TW_LH_SD_Customer"),d=R.daoFactory.getDefaultTable("TW_LH_SD_Customer_Extension"),m=V.v4();p.setValue("ClientID",m),p.setValue("LastName",u.LastName),p.setValue("FirstName",u.FirstName),p.setValue("IsFollow","N"),d.setValue("ClientID",m);var g=u.Birthday;null!=g&&(p.setValue("BirthdayYear",g.getFullYear),p.setValue("BirthdayMonth",g.getMonth),p.setValue("BirthdayDate",g.getDate)),R.customerUtils.setCustomerDefaultValue(p);var h=R.customerUtils.countCompleteness(u);p.setValue("Completeness",h),s.transactionInsert(p),s.transactionInsert(d);try{for(var f=B(u.tel),y=f.next();!y.done;y=f.next()){var b=y.value,C="TelHome";"work"==b.type?C="TelWork":"mobile"==b.type&&(C="TelMobile");var v=R.daoFactory.getDefaultTable("TW_LH_SD_Customer_Tel"),D=R.daoFactory.getDefaultTable("TW_LH_SD_Customer_Tel_Extension");if(v){var x=V.v4();(v=v).setValue("ClientID",x),v.setValue("CustomerClientID",p.getValue("ClientID")),v.setValue("TelType",C),v.setValue("Tel",b.number),v.setValue("DataSource","APP"),D.setValue("ClientID",x),D.setValue("CustomerClientID",p.getValue("ClientID")),s.transactionInsert(v),s.transactionInsert(D)}}}catch(N){i={error:N}}finally{try{y&&!y.done&&(o=f["return"])&&o.call(f)}finally{if(i)throw i.error}}var k=3;u.email.length<3&&(k=u.email.length);for(var w=0;w<k;w++){var I=u.email[w],S=R.daoFactory.getDefaultTable("TW_LH_SD_Customer_Email"),T=R.daoFactory.getDefaultTable("TW_LH_SD_Customer_Email_Extension");if(S){x=V.v4();(S=S).setValue("CustomerClientID",p.getValue("ClientID")),S.setValue("EmailType","MailHome"),S.setValue("Email",I),S.setValue("ClientID",x),S.setValue("DataSource","APP"),T.setValue("ClientID",x),T.setValue("CustomerClientID",p.getValue("ClientID")),s.transactionInsert(S),s.transactionInsert(T)}}try{for(var _=B(u.address),E=_.next();!E.done;E=_.next()){var P=E.value,A="AddressTypeHome";"work"==P.type&&(A="AddressTypeWork");var M=R.daoFactory.getDefaultTable("TW_LH_SD_Customer_Address"),L=R.daoFactory.getDefaultTable("TW_LH_SD_Customer_Address_Extension");if(M){x=V.v4();(M=M).setValue("CustomerClientID",p.getValue("ClientID")),M.setValue("ClientID",x),M.setValue("AddressType",A),M.setValue("Zipcode",P.code),M.setValue("Address",P.address),M.setValue("DataSource","APP"),L.setValue("CustomerClientID",p.getValue("ClientID")),L.setValue("ClientID",x),s.transactionInsert(M),s.transactionInsert(L)}}}catch(O){a={error:O}}finally{try{E&&!E.done&&(r=_["return"])&&r.call(_)}finally{if(a)throw a.error}}}}catch(F){t={error:F}}finally{try{c&&!c.done&&(n=l["return"])&&n.call(l)}finally{if(t)throw t.error}}s.runTransaction().subscribe(function(t){e.next(t),e.complete()})}else e.next(!1),e.complete()})},t}(),Rt=function(){function t(t){this._DaoFactory=t}return Object.defineProperty(t.prototype,"targetDate",{set:function(t){this._targetDate=m.setYear(t,2e3),this._subNDayTimeStamp=m.subDays(this._targetDate,this._subN).getTime(),this._addNDayTimeStamp=m.addDays(this._targetDate,this._addN).getTime(),m.getYear(this._targetDate)==m.getYear(this._subNDayTimeStamp)&&m.getYear(this._targetDate)==m.getYear(this._addNDayTimeStamp)?this.isRangeCrossYear=!1:(this._subNDayTimeStamp=m.setYear(this._subNDayTimeStamp,2e3).getTime(),this._addNDayTimeStamp=m.setYear(this._addNDayTimeStamp,2e3).getTime(),this.isRangeCrossYear=!0),console.warn(this._subN,"  subDate:  ",this._subNDayTimeStamp),console.warn(this._addN,"  addDate:  ",this._addNDayTimeStamp)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subN",{set:function(t){this._subN=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addN",{set:function(t){this._addN=t},enumerable:!0,configurable:!0}),t.prototype.getAPIName=function(){return"getCustomerBirthdayList"},t.prototype.getMockPath=function(){return"./assets/mock/getCustomerBirthday.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i._DaoFactory.getDefaultTable("TW_LH_SD_VW_Customer"),n=i._DaoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.OrderByRestriction([{column:"LastName",order:"ASC"}])),n.queryByTable(t).subscribe(function(t){console.warn("resp.Body in CustomerBirthdayListAPI: ",t),t.Body=t.Body.filter(function(t){return i._judgeCustomrtIsInRange(t)}),e.next(t),e.complete()})):(e.next(!1),e.complete())})},t.prototype._judgeCustomrtIsInRange=function(t){var e=new Date("2000/"+t.BirthdayMonth+"/"+t.BirthdayDate).getTime();return this.isRangeCrossYear?e>=this._subNDayTimeStamp||e<=this._addNDayTimeStamp:e>=this._subNDayTimeStamp&&e<=this._addNDayTimeStamp},t}(),Vt=function(){function t(t){this.daoFactory=t}return t.prototype.setMessageType=function(t){this._messageType=t},t.prototype.setMessageDataCategory=function(t){this._messageDataCategory=t},t.prototype.getAPIName=function(){return"updateDashboardToRead"},t.prototype.getMockPath=function(){return"./assets/mock/saveSuccess.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i.daoFactory.getDefaultDao();if(t!=undefined){var n=i.daoFactory.getDefaultTable("TW_LH_SD_Message");n?(t=new j.ClientCustomDao(t),(n=n).addRestriction(new j.EqualRestriction("MessageCategory",[i._messageDataCategory])),n.addRestriction(new j.EqualRestriction("MessageType",[i._messageType])),n.setValue("Status","Reading"),t.updateByTable(n).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())}else e.next(!1),e.complete()})},t}(),jt=function(){function t(t){this._DaoFactory=t}return t.prototype.setCalendarEvent=function(t){this._calendarEvent=t},t.prototype.getAPIName=function(){return"addCalendarEvent"},t.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i._DaoFactory.getDefaultTable("TW_LH_SD_Calendar"),n=i._DaoFactory.getDefaultDao();t!=undefined?(n=new j.ClientCustomDao(n),t.setValue("CustomerClientID",i._calendarEvent.customerClientID),t.setValue("Title",i._calendarEvent.title),t.setValue("Location",i._calendarEvent.location),t.setValue("CalendarType",i._calendarEvent.activity),1==i._calendarEvent.allDay?t.setValue("IsAllDay","Y"):t.setValue("IsAllDay","N"),t.setValue("StartTime",i._calendarEvent.start.getTime()),t.setValue("EndTime",i._calendarEvent.end.getTime()),1==i._calendarEvent.isAlert?t.setValue("IsAlert","Y"):t.setValue("IsAlert","N"),t.setValue("Alert1",i._calendarEvent.alert1),t.setValue("Alert2",i._calendarEvent.alert2),t.setValue("Alert3",null),t.setValue("Remark",i._calendarEvent.remark),n.insertByTable(t).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),Bt=function(){function t(t){this._DaoFactory=t}return Object.defineProperty(t.prototype,"clientID",{set:function(t){this._clientID=t},enumerable:!0,configurable:!0}),t.prototype.getAPIName=function(){return"deleteCalendarEvent"},t.prototype.getMockPath=function(){return"./assets/mock/deleteCalendarEvent.json"},t.prototype.executeSQL=function(){var o=this;return f.Observable.create(function(e){var t=o._DaoFactory.getDefaultTable("TW_LH_SD_Calendar"),n=o._DaoFactory.getDefaultTable("TW_LH_SD_Calendar_Extension"),i=o._DaoFactory.getDefaultDao();t!=undefined&&i!=undefined?(i=new j.ClientCustomDao(i),t.addRestriction(new j.EqualRestriction("ClientID",[o._clientID])),n.addRestriction(new j.EqualRestriction("ClientID",[o._clientID])),i.deleteByTable(t).toPromise().then(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),Ht=function(){function t(t){this._DaoFactory=t}return Object.defineProperty(t.prototype,"ClientID",{set:function(t){this._clientID=t},enumerable:!0,configurable:!0}),t.prototype.getAPIName=function(){return"getCalendarEventDetail"},t.prototype.getMockPath=function(){return"./assets/mock/getCalendarEventDetail.json"},t.prototype.executeSQL=function(){var o=this;return f.Observable.create(function(e){console.log("CalendarEventDetail ClientID:",o._clientID);if(o._clientID){var t=o._DaoFactory.getDefaultTable("TW_LH_SD_VW_Calendar"),n=o._DaoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.EqualRestriction("ClientID",[o._clientID])),n.queryByTable(t).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())}else{var i=new j.SQLiteResponse({isSuccess:!0},[{ClientID:null,CalendarID:null,CustomerClientID:null,Title:"",Location:"",CalendarType:null,IsAllDay:"N",StartTime:null,EndTime:null,IsAlert:"Y",Alert1:"8",Alert2:"",Alert3:null,Remark:"",DataSource:"APP"}]);e.next(i),e.complete()}})},t}(),Ut=function(){function t(t){this._DaoFactory=t}return Object.defineProperty(t.prototype,"startTime",{set:function(t){this._startTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endTime",{set:function(t){this._endTime=t},enumerable:!0,configurable:!0}),t.prototype.getAPIName=function(){return"getCalendarEventList"},t.prototype.getMockPath=function(){return"./assets/mock/getCalendarEventList.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i._DaoFactory.getDefaultTable("TW_LH_SD_VW_Calendar"),n=i._DaoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.GreaterOrEqualRestriction("EndTime",[i._startTime.getTime()])),t.addRestriction(new j.LessOrEqualRestriction("StartTime",[i._endTime.getTime()])),t.addRestriction(new j.OrderByRestriction([{column:"StartTime",order:"ASC"}])),n.queryByTable(t).subscribe(function(t){console.log(t),e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),qt=function(){function t(t){this._DaoFactory=t}return Object.defineProperty(t.prototype,"ClientID",{set:function(t){this._clientID=t},enumerable:!0,configurable:!0}),t.prototype.setCalendarEvent=function(t){this._calendarEvent=t},t.prototype.getAPIName=function(){return"updateCalendarEvent"},t.prototype.getMockPath=function(){return"./assets/mock/updateCalendarEvent.json"},t.prototype.executeSQL=function(){var i=this;return f.Observable.create(function(e){var t=i._DaoFactory.getDefaultTable("TW_LH_SD_Calendar"),n=i._DaoFactory.getDefaultDao();t!=undefined&&n!=undefined?(n=new j.ClientCustomDao(n),t.addRestriction(new j.EqualRestriction("ClientID",[i._clientID])),t.setValue("CalendarID",i._calendarEvent.calendarID),t.setValue("Title",i._calendarEvent.title),t.setValue("Location",i._calendarEvent.location),t.setValue("CustomerClientID",i._calendarEvent.customerClientID),t.setValue("CalendarType",i._calendarEvent.activity),1==i._calendarEvent.allDay?t.setValue("IsAllDay","Y"):t.setValue("IsAllDay","N"),t.setValue("StartTime",i._calendarEvent.start.getTime()),t.setValue("EndTime",i._calendarEvent.end.getTime()),1==i._calendarEvent.isAlert?t.setValue("IsAlert","Y"):t.setValue("IsAlert","N"),t.setValue("Alert1",i._calendarEvent.alert1),t.setValue("Alert2",i._calendarEvent.alert2),t.setValue("Alert3",i._calendarEvent.alert3),t.setValue("Remark",i._calendarEvent.remark),n.updateByTable(t).subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}(),zt=function(){function t(t){this._DaoFactory=t}return t.prototype.getAPIName=function(){return"saveCalendarEvent"},t.prototype.getMockPath=function(){return"./assets/mock/addCalendarEvent.json"},t.prototype.executeSQL=function(){var o=this;console.log("CalendarEventSaveAPI executeSQL:",this.Data);var t=[this.Data.Alert1,this.Data.Alert2];return"Y"===this.Data.IsAlert&&(t.sort(function(t,e){return parseInt(t)-parseInt(e)}),this.Data.Alert1=t[0],this.Data.Alert2=t[1]),f.Observable.create(function(e){var t=o._DaoFactory.getDefaultTable("TW_LH_SD_Calendar"),n=o._DaoFactory.getDefaultTable("TW_LH_SD_Calendar_Extension"),i=o._DaoFactory.getDefaultDao();t!=undefined?(i=new j.ClientCustomDao(i),o.Data.ClientID&&(t.setValue("ClientID",o.Data.ClientID),n.setValue("ClientID",o.Data.ClientID)),t.setValue("CustomerClientID",o.Data.CustomerClientID),t.setValue("Title",o.Data.Title),t.setValue("Location",o.Data.Location),t.setValue("CalendarType",o.Data.CalendarType),t.setValue("IsAllDay",o.Data.IsAllDay),t.setValue("StartTime",o.Data.StartDateTime.getTime()),t.setValue("EndTime",o.Data.EndDateTime.getTime()),t.setValue("IsAlert",o.Data.IsAlert),"Y"===o.Data.IsAlert?(t.setValue("Alert1",o.Data.Alert1),t.setValue("Alert2",o.Data.Alert2)):(t.setValue("Alert1",null),t.setValue("Alert2",null)),t.setValue("Alert3",null),t.setValue("Remark",o.Data.Remark),console.log("save calendarObj:",t),n=j.TableUtils.fillTableColumn(n,o.Data),"edit"===o.Data.EditType?(t.addRestriction(new j.EqualRestriction("ClientID",[o.Data.ClientID])),n.addRestriction(new j.EqualRestriction("ClientID",[o.Data.ClientID])),i.transactionUpdate(t),i.transactionUpdate(n)):(i.transactionInsert(t),i.transactionInsert(n)),i.runTransaction().subscribe(function(t){e.next(t),e.complete()})):(e.next(!1),e.complete())})},t}();t.IntegrationCalendarCustomerModule=gt,t.CustomersComponent=pt,t.CustomerContactListComponent=tt,t.CustomerDetailComponent=et,t.CustomerEditComponent=at,t.CustomerFilterComponent=rt,t.DefaultCustomerCriteriaSearch=Q,t.CustomerImportComponent=st,t.CustomerListComponent=lt,t.CustomerConfirmAction=ht,t.CustomerFilterCriteria=W,t.CustomerFilterPreset=z,t.CustomerImportGroup=ct,t.customerEditMetaControllerToken=I,t.customerDetailMetaControllerToken=S,t.customerContactEditMetaControllerToken=T,t.customerContactDetailMetaControllerToken=_,t.customerFilterMetaControllerToken=E,t.customerCriteriaSearchToken=P,t.customerImportDisplayToken=A,t.addProgressPointToken=M,t.customerShowRuleToken=L,t.CustomerAddress=ft,t.CustomerAlertItem=$,t.CustomerContactNote=yt,t.CustomerEmail=bt,t.CustomerItem=Y,t.CustomerList=Ct,t.CustomerTel=G,t.MobileCustomerItem=vt,t.MobileCustomerList=Dt,t.CustomerBirthday=J,t.CustomerService=K,t.CustomerStoreService=nt,t.CUSTOMER_STATE=it,t.CustomerUtils=Z,t.CustomerAddContactNoteAPI=xt,t.CustomerAutoDeleteAPI=kt,t.CustomerContactNoteAPI=wt,t.CustomerDeleteAPI=It,t.CustomerDeleteContactNoteAPI=St,t.CustomerDetailAPI=Tt,t.CustomerEditContactNoteAPI=_t,t.CustomerEditOvertimeAPI=Et,t.CustomerGetPresetAPI=Pt,t.CustomerListAPI=At,t.CustomerSaveDetailAPI=Mt,t.CustomerSavePresetAPI=Lt,t.CustomerTelAPI=Nt,t.CustomerUpdateFollowAPI=Ot,t.ImportContactAPI=Ft,t.CustomerBirthdayListAPI=Rt,t.DashboardUpdateToReadAPI=Vt,t.CalendarService=q,t.CalendarEventDetail=U,t.CalendarComponent=X,t.CalendarDetailComponent=F,t.CalendarEditComponent=N,t.DefaultCalendarEditMetaController=w,t.CalendarFilterComponent=R,t.CalendarEventAddAPI=jt,t.CalendarEventDeleteAPI=Bt,t.CalendarEventDetailAPI=Ht,t.CalendarEventListAPI=Ut,t.CalendarEventUpdateAPI=qt,t.CalendarEventSaveAPI=zt,t.calendarEditMetaControllerToken=x,t.calendarDetailMetaControllerToken=k,t.ɵu=O,t.ɵt=F,t.ɵr=w,t.ɵq=N,t.ɵv=R,t.ɵa=X,t.ɵb=q,t.ɵbh=dt,t.ɵbi=mt,t.ɵbe=tt,t.ɵbd=et,t.ɵbb=ot,t.ɵba=at,t.ɵm=Q,t.ɵbf=rt,t.ɵbg=st,t.ɵbc=lt,t.ɵy=ut,t.ɵw=pt,t.ɵk=M,t.ɵg=_,t.ɵf=T,t.ɵi=P,t.ɵe=S,t.ɵd=I,t.ɵh=E,t.ɵj=A,t.ɵl=L,t.ɵc=K,t.ɵx=nt,t.ɵo=Z,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=allianzSND-integration-calendar-customer.umd.min.js.map